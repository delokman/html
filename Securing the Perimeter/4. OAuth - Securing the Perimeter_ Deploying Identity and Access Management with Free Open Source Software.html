<!DOCTYPE html>
<!-- saved from url=(0111)https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml -->
<html class="js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom fa-events-icons-ready" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="6866040" data-user-uuid="39a88cd5-54f5-4d61-aec6-7884d06dfba1" data-username="vrad201" data-account-type="Trial" data-activated-trial-date="04/04/2020" data-archive="9781484226018" data-publishers="Apress" data-htmlfile-name="425975_1_En_4_Chapter.xhtml" data-epub-title="Securing the Perimeter: Deploying Identity and Access Management with Free Open Source Software" data-debug="0" data-testing="0" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Safari Books Online"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781484226018"><link rel="shortcut icon" href="https://www.oreilly.com/favicon.ico"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><script type="text/javascript" async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/cool-2.1.15.min.js"></script><script id="twitter-wjs" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/widgets.js"></script><script type="text/javascript" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/510f1a6865"></script><script src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/nr-1167.min.js"></script><script type="text/javascript" async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/ec.js"></script><script type="text/javascript" async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/2508.js"></script><script src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/443792972845831" async=""></script><script src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/1732687426968531" async=""></script><script async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/fbevents.js"></script><script type="text/javascript" async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f.txt"></script><script type="text/javascript" async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/analytics.js"></script><script type="text/javascript" async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/bat.js"></script><script type="text/javascript" async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f.txt"></script><script type="text/javascript" async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/insight.min.js"></script><script type="text/javascript" async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f.txt"></script><script crossorigin="anonymous" integrity="sha256-4ZnAISy2+rbOaVUOBtJrqxBTrJ5kctu9r4qBJBt0Oo0=" type="text/javascript" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/appcues.main.40a6b605d29a66b083aa6d74c07bb73eae19e31b.js" async=""></script><script async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/gtm.js"></script><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={licenseKey:"510f1a6865",applicationID:"172641827"};window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var i=n[t]={exports:{}};e[t][0].call(i.exports,function(n){var i=e[t][1][n];return r(i||n)},i,i.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<t.length;i++)r(t[i]);return r}({1:[function(e,n,t){function r(){}function i(e,n,t){return function(){return o(e,[u.now()].concat(f(arguments)),n?null:this,t),n?void 0:this}}var o=e("handle"),a=e(4),f=e(5),c=e("ee").get("tracer"),u=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",d=l+"ixn-";a(p,function(e,n){s[n]=i(l+n,!0,"api")}),s.addPageAction=i(l+"addPageAction",!0),s.setCurrentRouteName=i(l+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,i="function"==typeof n;return o(d+"tracer",[u.now(),e,t],r),function(){if(c.emit((i?"":"no-")+"fn-start",[u.now(),r,i],t),i)try{return n.apply(this,arguments)}catch(e){throw c.emit("fn-err",[arguments,this,e],t),e}finally{c.emit("fn-end",[u.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=i(d+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),o("err",[e,u.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){var t=e.getEntries();t.forEach(function(e){"first-paint"===e.name?c("timing",["fp",Math.floor(e.startTime)]):"first-contentful-paint"===e.name&&c("timing",["fcp",Math.floor(e.startTime)])})}function i(e,n){var t=e.getEntries();t.length>0&&c("lcp",[t[t.length-1]])}function o(e){if(e instanceof s&&!l){var n,t=Math.round(e.timeStamp);n=t>1e12?Date.now()-t:u.now()-t,l=!0,c("timing",["fi",t,{type:e.type,fid:n}])}}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var a,f,c=e("handle"),u=e("loader"),s=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){a=new PerformanceObserver(r),f=new PerformanceObserver(i);try{a.observe({entryTypes:["paint"]}),f.observe({entryTypes:["largest-contentful-paint"]})}catch(p){}}if("addEventListener"in document){var l=!1,d=["click","keydown","mousedown","pointerdown","touchstart"];d.forEach(function(e){document.addEventListener(e,o,!1)})}}},{}],3:[function(e,n,t){function r(e,n){if(!i)return!1;if(e!==i)return!1;if(!n)return!0;if(!o)return!1;for(var t=o.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var f=navigator.userAgent,c=f.match(a);c&&f.indexOf("Chrome")===-1&&f.indexOf("Chromium")===-1&&(i="Safari",o=c[1])}n.exports={agent:i,version:o,match:r}},{}],4:[function(e,n,t){function r(e,n){var t=[],r="",o=0;for(r in e)i.call(e,r)&&(t[o]=n(r,e[r]),o+=1);return t}var i=Object.prototype.hasOwnProperty;n.exports=r},{}],5:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,i=t-n||0,o=Array(i<0?0:i);++r<i;)o[r]=e[n+r];return o}n.exports=r},{}],6:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function i(e){function n(e){return e&&e instanceof r?e:e?c(e,f,o):o()}function t(t,r,i,o){if(!l.aborted||o){e&&e(t,r,i);for(var a=n(i),f=v(t),c=f.length,u=0;u<c;u++)f[u].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function d(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||i(t)}function w(e,n){u(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:d,addEventListener:d,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function o(){return new r}function a(){(s.api||s.feature)&&(l.aborted=!0,s=l.backlog={})}var f="nr@context",c=e("gos"),u=e(4),s={},p={},l=n.exports=i();l.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(i.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return e[n]=r,r}var i=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){i.buffer([e],r),i.emit(e,n,t)}var i=e("ee").get("handle");n.exports=r,r.ee=i},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,o,function(){return i++})}var i=1,o="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!x++){var e=E.info=NREUM.info,n=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();u(y,function(n,t){e[n]||(e[n]=t)}),c("mark",["onload",a()+E.offset],null,"api");var t=d.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function i(){"complete"===d.readyState&&o()}function o(){c("mark",["domContent",a()+E.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(f=Math.max((new Date).getTime(),f))-E.offset}var f=(new Date).getTime(),c=e("handle"),u=e(4),s=e("ee"),p=e(3),l=window,d=l.document,m="addEventListener",v="attachEvent",g=l.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:l.setImmediate,CT:clearTimeout,XHR:g,REQ:l.Request,EV:l.Event,PR:l.Promise,MO:l.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1167.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),E=n.exports={offset:f,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),e(2),d[m]?(d[m]("DOMContentLoaded",o,!1),l[m]("load",r,!1)):(d[v]("onreadystatechange",i),l[v]("onload",r)),c("mark",["firstbyte",f],null,"api");var x=0,O=e(6)},{}],"wrap-function":[function(e,n,t){function r(e){return!(e&&e instanceof Function&&e.apply&&!e[a])}var i=e("ee"),o=e(5),a="nr@original",f=Object.prototype.hasOwnProperty,c=!1;n.exports=function(e,n){function t(e,n,t,i){function nrWrapper(){var r,a,f,c;try{a=this,r=o(arguments),f="function"==typeof t?t(r,a):t||{}}catch(u){l([u,"",[r,a,i],f])}s(n+"start",[r,a,i],f);try{return c=e.apply(a,r)}catch(p){throw s(n+"err",[r,a,p],f),p}finally{s(n+"end",[r,a,c],f)}}return r(e)?e:(n||(n=""),nrWrapper[a]=e,p(e,nrWrapper),nrWrapper)}function u(e,n,i,o){i||(i="");var a,f,c,u="-"===i.charAt(0);for(c=0;c<n.length;c++)f=n[c],a=e[f],r(a)||(e[f]=t(a,u?f+i:i,o,f))}function s(t,r,i){if(!c||n){var o=c;c=!0;try{e.emit(t,r,i,n)}catch(a){l([a,t,r,i])}c=o}}function p(e,n){if(Object.defineProperty&&Object.keys)try{var t=Object.keys(e);return t.forEach(function(t){Object.defineProperty(n,t,{get:function(){return e[t]},set:function(n){return e[t]=n,n}})}),n}catch(r){l([r])}for(var i in e)f.call(e,i)&&(n[i]=e[i]);return n}function l(n){try{e.emit("internal-error",n)}catch(t){}}return e||(e=i),t.inPlace=u,t.flag=a,t}},{}]},{},["loader"]);</script><link rel="shortcut icon" href="https://learning.oreilly.com/favicon.ico" type="image/x-icon"><link href="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/css" rel="stylesheet" type="text/css"><title>4.&nbsp;OAuth - Securing the Perimeter: Deploying Identity and Access Management with Free Open Source Software</title><link rel="stylesheet" href="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/output.8054605313ed.css" type="text/css"><link rel="stylesheet" type="text/css" href="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/annotator.e3b0c44298fc.css"><link rel="stylesheet" href="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/font-awesome.min.css"><style type="text/css" title="ibis-book">
    #sbo-rt-content a{text-decoration:none}#sbo-rt-content a:link,#sbo-rt-content a:active{color:#0176C3}#sbo-rt-content a:visited{color:#5f5f5f}#sbo-rt-content div{font-family:"Cambria","Minion Pro","Times New Roman","Times",serif;}#sbo-rt-content img{border:0;vertical-align:middle}#sbo-rt-content video{display:block;margin-top:1em;max-width:100%;text-indent:0;width:100%}#sbo-rt-content p{margin:0}#sbo-rt-content .Heading,#sbo-rt-content .SubHeading,#sbo-rt-content .ContextInformation,#sbo-rt-content .MainTitleSection,#sbo-rt-content .PartTitle,#sbo-rt-content .SeriesTitle,#sbo-rt-content .SeriesSubTitle,#sbo-rt-content .SubSeriesTitle,#sbo-rt-content .SubSeriesSubTitle,#sbo-rt-content .BookTitle,#sbo-rt-content .BookSubTitle,#sbo-rt-content .ForewordTitle,#sbo-rt-content .PrefaceTitle,#sbo-rt-content .BookAcknowledgmentsTitle,#sbo-rt-content .BookNotesTitle{text-align:left !important}#sbo-rt-content .Heading,#sbo-rt-content .SubHeading{display:block;font-weight:bold}#sbo-rt-content .ArticleContextInformation{border-bottom:1px solid;margin-bottom:.8em;padding-bottom:.3em}#sbo-rt-content .ArticleContextInformation .ContextInformation{display:block;font-size:80%}#sbo-rt-content .ArticleContextInformation .JournalTitle:after,#sbo-rt-content .ArticleContextInformation .JournalSubTitle:after{content:", "}#sbo-rt-content .ArticleCopyright{display:inline}#sbo-rt-content .ArticleCopyright .CopyrightComment,#sbo-rt-content .ArticleContextInformation .ArticleDOI{display:block}#sbo-rt-content .ChapterContextInformation{border-bottom:1px solid;margin-bottom:.8em;padding-bottom:.3em}#sbo-rt-content .ChapterContextInformation .ContextInformation{display:block;font-size:80%}#sbo-rt-content .ChapterCopyright .CopyrightComment{display:block}#sbo-rt-content .ChapterContextInformation .BookEdition:before{content:", "}#sbo-rt-content .ChapterContextInformation .ContextInformationAuthorEditorNames:after{content:", "}#sbo-rt-content .ChapterContextInformation .BookTitle{font-style:italic}#sbo-rt-content .ChapterContextInformation .SeriesTitle:before{content:", "}#sbo-rt-content .ChapterContextInformation .SeriesSubTitle:before{content:": "}#sbo-rt-content .ChapterContextInformation .ContextInformationVolumeNumber:before{content:" "}#sbo-rt-content .ChapterContextInformation .ChapterDOI{display:block}#sbo-rt-content .Categories{color:#666;margin-bottom:1em;margin-top:1em}#sbo-rt-content .ArticleCategory,#sbo-rt-content .ChapterCategory{font-size:1.2rem}#sbo-rt-content .ArticleSubCategory,#sbo-rt-content .ChapterSubCategory{font-size:1rem}#sbo-rt-content .MainTitleSection{font-weight:bold;margin-bottom:1.2em;margin-top:1.2em}#sbo-rt-content .ArticleSuperTitle{font-size:1.2rem}#sbo-rt-content .MainTitleSection .ArticleTitle,#sbo-rt-content .ForeignLanguageHeader .ArticleTitle,#sbo-rt-content .MainTitleSection .ChapterTitle,#sbo-rt-content .ForeignLanguageHeader .ChapterTitle{font-size:1.73rem;margin:0}#sbo-rt-content .ArticleSubTitle,#sbo-rt-content .ChapterSubTitle{font-size:1.2rem;padding-top:.2em}#sbo-rt-content div>.AuthorGroup .AuthorNames,#sbo-rt-content .BookBackmatter>.AuthorGroup .AuthorNames{font-size:100%;margin-bottom:1em;margin-top:1em;text-align:left !important}#sbo-rt-content .BookBackmatter>.AuthorGroup .AuthorNames{font-weight:bold}#sbo-rt-content .AuthorNames sup{font-size:70%}#sbo-rt-content .Prefix:after{content:" "}#sbo-rt-content .Suffix:before{content:" "}#sbo-rt-content .Degrees:before{content:", "}#sbo-rt-content .NativeName:before,#sbo-rt-content .Role:before{content:" ("}#sbo-rt-content .NativeName:after,#sbo-rt-content .Role:after{content:")"}#sbo-rt-content .AffiliationNumber{float:left;padding-right:.5em}#sbo-rt-content .AffiliationText{margin-left:2em}#sbo-rt-content .AffiliationHint{font-style:italic}#sbo-rt-content .AuthorNames .DeceasedSymbol:before{content:"†";padding-left:3px}#sbo-rt-content .AuthorNames .EqualContributionSymbol:before{content:"*";padding-left:3px}#sbo-rt-content .InstitutionMembers:before{content:" ("}#sbo-rt-content .InstitutionMembers:after{content:")"}#sbo-rt-content .AffiliationLegend .DeceasedSymbol:before{content:"†";display:inline-block;width:14px}#sbo-rt-content .AffiliationLegend .EqualContributionSymbol:before{content:"*";display:inline-block;width:14px}#sbo-rt-content .ClearBoth{clear:both;font-size:0;line-height:0 !important}#sbo-rt-content .Contact,#sbo-rt-content .AffiliationLegend{margin-bottom:1em;margin-top:1em}#sbo-rt-content .ContactIcon{background-image:url(envelope.png);background-repeat:no-repeat;background-size:contain;width:.8rem}#sbo-rt-content .AuthorNames .ContactIcon{display:inline-block}#sbo-rt-content .Contact .ContactIcon{float:left;margin-top:4px;margin-right:4px}#sbo-rt-content .ContactAuthorLine{padding-left:20px;font-weight:bold}#sbo-rt-content .ContactAdditionalLine{padding-left:20px}#sbo-rt-content .ContactType{font-weight:bold}#sbo-rt-content .ArticleHistory{margin-bottom:1em;margin-top:1em}#sbo-rt-content .HistoryLabel{font-weight:bold}#sbo-rt-content .History+.History{padding-left:.5em}#sbo-rt-content .ArticleOrChapterToc{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .ArticleOrChapterToc .HeadingNumber{font-weight:bold;padding-right:.3em}#sbo-rt-content .Abstract{margin-top:1em}#sbo-rt-content .Abstract>.Heading{font-size:1em;margin:0}#sbo-rt-content .AbstractSection{margin-top:.3em}#sbo-rt-content .Heading+.AbstractSection{margin-top:0}#sbo-rt-content .AbstractSection>.Heading{font-size:1em;font-style:italic;font-weight:normal;margin:0}#sbo-rt-content .KeywordGroup{margin-top:1em}#sbo-rt-content .KeywordGroup .Heading{display:inline;font-size:1em;margin:0;padding-right:.5em}#sbo-rt-content .Keyword+.Keyword:before{content:" – "}#sbo-rt-content .ArticleExternalID{margin-top:1em}#sbo-rt-content .ArticleExternalIDLabel{font-weight:bold}#sbo-rt-content .ForeignLanguageHeader{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .ForeignLanguageTitleSection{font-weight:bold;margin-bottom:1.2em;margin-top:1rem}#sbo-rt-content .AbbreviationGroup{margin-top:1em}#sbo-rt-content .ForeignLanguageHeader+.AbbreviationGroup{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .AbbreviationGroup>.Heading{font-size:1em;margin:0}#sbo-rt-content .AbbreviationGroup .DefinitionList{margin-top:0;margin-bottom:0;padding-right:.1em;padding-top:.1em;padding-bottom:.1em}#sbo-rt-content .AbbreviationGroupSection>.Heading{font-size:1em;margin:0;padding-top:.2em}#sbo-rt-content .ArticleNote{margin-top:1em}#sbo-rt-content .ArticleNote>.Heading{font-size:1em;margin:0}#sbo-rt-content .ArticleNoteMotto{font-style:italic;margin-left:1.5em;margin-right:1.5em;text-align:right}#sbo-rt-content .Biography{display:block;margin-top:.8em;padding-bottom:0;width:100%}#sbo-rt-content .Loc .AuthorGroup .Biography{margin-top:0}#sbo-rt-content .Biography .FormalPara,#sbo-rt-content .Biography .BiographyFigure{display:block;margin-top:0;margin-bottom:0}#sbo-rt-content .Biography .BiographyFigure{float:right;margin-left:6px}#sbo-rt-content .Biography .Figure{border-bottom:none;margin-top:.5em;margin-bottom:0}#sbo-rt-content .Fulltext>.Para:first-of-type>.BlockQuote:first-child{margin-top:0}#sbo-rt-content .BlockQuote{margin:1em 1.5em}#sbo-rt-content .BlockQuote>.Heading{font-size:1em;margin-top:1em;margin-bottom:0;text-indent:0}#sbo-rt-content .BlockQuote>.Para{text-indent:0}#sbo-rt-content .Heading+.Para>.BlockQuote:first-child{margin-top:0}#sbo-rt-content .Caption,#sbo-rt-content .TableFooter{display:block;text-align:left}#sbo-rt-content .TableFooter .SimplePara+.SimplePara{text-indent:0}#sbo-rt-content .Caption{margin-top:.5em}#sbo-rt-content .CaptionContent{font-size:90%}#sbo-rt-content .TableFooter{margin-top:1em}#sbo-rt-content .Table .Caption{margin-top:.5em}#sbo-rt-content .Figure .Caption,#sbo-rt-content video+.Caption{margin-bottom:1em}#sbo-rt-content .Table .Caption{margin-bottom:.5em}#sbo-rt-content .CaptionNumber{font-style:italic;font-weight:bold;padding-right:.6em}#sbo-rt-content .CaptionContent>span.Heading{display:inline}#sbo-rt-content .CaptionContent>span.SimplePara{display:block}#sbo-rt-content .CaptionContent>.SimplePara:first-child,#sbo-rt-content .CaptionContent>.CaptionNumber+.SimplePara,#sbo-rt-content .CaptionContent>a+.SimplePara{display:inline;margin-top:0}#sbo-rt-content .Credit>.SimplePara{text-indent:1.5em}#sbo-rt-content .DefinitionList{margin-top:1em;margin-bottom:1em;padding:.1em}#sbo-rt-content .DefinitionList>.Heading{font-size:1rem;margin:0;text-indent:0}#sbo-rt-content dl{margin:0}#sbo-rt-content .DefinitionList:after{content:"";clear:both;display:table}#sbo-rt-content .Term{clear:both;float:left;font-style:italic;padding-right:1em;text-indent:0;vertical-align:top}#sbo-rt-content .Description{padding-bottom:.3em;margin-left:0}#sbo-rt-content .Description .Para:first-child{text-indent:0}#sbo-rt-content .Heading+.Para>div.DefinitionList:first-child{margin-top:0}#sbo-rt-content .EmphasisTypeBold{font-weight:bold}#sbo-rt-content .EmphasisTypeItalic{font-style:italic}#sbo-rt-content .EmphasisTypeUnderline{text-decoration:underline}#sbo-rt-content .EmphasisTypeDoubleUnderline{border-bottom-style:double}#sbo-rt-content .EmphasisTypeSmallCaps{font-variant:small-caps}#sbo-rt-content .EmphasisTypeBoldItalic{font-weight:bold;font-style:italic}#sbo-rt-content .EmphasisTypeBoldUnderline{font-weight:bold;text-decoration:underline}#sbo-rt-content .EmphasisTypeBoldDoubleUnderline{font-weight:bold;border-bottom-style:double}#sbo-rt-content .EmphasisTypeBoldSmallCaps{font-weight:bold;font-variant:small-caps}#sbo-rt-content .EmphasisTypeItalicUnderline{font-style:italic;text-decoration:underline}#sbo-rt-content .EmphasisTypeItalicDoubleUnderline{font-style:italic;border-bottom-style:double}#sbo-rt-content .EmphasisTypeItalicSmallCaps{font-style:italic;font-variant:small-caps}#sbo-rt-content .EmphasisTypeBoldItalicUnderline{font-weight:bold;font-style:italic;text-decoration:underline}#sbo-rt-content .EmphasisTypeBoldItalicDoubleUnderline{font-weight:bold;font-style:italic;border-bottom-style:double}#sbo-rt-content .EmphasisTypeBoldItalicSmallCaps{font-weight:bold;font-style:italic;font-variant:small-caps}#sbo-rt-content .EmphasisTypeUnderlineSmallCaps{text-decoration:underline;font-variant:small-caps}#sbo-rt-content .EmphasisTypeDoubleUnderlineSmallCaps{border-bottom-style:double;font-variant:small-caps}#sbo-rt-content .EmphasisFontCategoryNonProportional{font-family:"Courier New",Courier,monospace}#sbo-rt-content :not(.ParaTypeProgramcode)>.EmphasisFontCategoryNonProportional{font-size:95%}#sbo-rt-content .EmphasisFontCategorySansSerif{font-family:"Arial","Helvetica",sans-serif;font-size:75%}#sbo-rt-content .EmphasisTypeStrikethrough{text-decoration:line-through}#sbo-rt-content .Equation{display:block;text-indent:0;vertical-align:middle}#sbo-rt-content .NumberedEquation{display:table;width:100%}#sbo-rt-content .NumberedEquation .EquationWrapper{display:table-row}#sbo-rt-content .NumberedEquation .EquationContent{display:table-cell}#sbo-rt-content .EquationContent{margin-top:.5em;margin-bottom:0;width:100%;text-align:center;text-indent:0;vertical-align:middle}#sbo-rt-content .EquationContent div{margin-top:.5em}#sbo-rt-content .EquationContent .MediaObject{margin-left:auto;margin-right:auto}#sbo-rt-content .EquationContent img{background:white;max-width:100%}#sbo-rt-content .EquationNumber{display:table-cell;margin-bottom:.4em;text-align:right;vertical-align:middle}#sbo-rt-content .EquationSourceXml{white-space:nowrap}#sbo-rt-content .InlineEquation img{background:white;vertical-align:text-top}#sbo-rt-content .Figure{margin-top:1em;margin-bottom:1em;margin-left:0;margin-right:0;text-align:center;text-indent:0}#sbo-rt-content .Figure img{height:auto;margin:0;max-width:100%;padding:2px}#sbo-rt-content .MediaObject{display:block;text-align:center}#sbo-rt-content .MediaObject:last-child{margin-bottom:1em}#sbo-rt-content .EquationContent>.MediaObject:last-child{margin-bottom:0}#sbo-rt-content .MediaObject+.MediaObject{margin-top:1em}#sbo-rt-content .FootnoteSection{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .FootnoteSection>.Heading{font-size:1.44rem;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Footnote{clear:both;font-size:90%;text-align:left}#sbo-rt-content .FootnoteNumber{float:left;padding-right:.5em}#sbo-rt-content .FootnoteParas>div{margin-left:1em;margin-top:.3em}#sbo-rt-content .FormalPara{margin-top:1em;margin-bottom:1em}#sbo-rt-content .FormalPara .Heading{font-size:1em;margin:0}#sbo-rt-content .FormalParaRenderingStyle1>.Heading{display:inline;padding-right:1em}#sbo-rt-content .FormalParaRenderingStyle2>.Heading{display:inline;font-style:italic;font-weight:normal;padding-right:1em}#sbo-rt-content .FormalParaRenderingStyle3>.Heading{padding-right:1em}#sbo-rt-content .FormalParaRenderingStyle1>p:first-of-type,#sbo-rt-content .FormalParaRenderingStyle2>p:first-of-type{display:inline}#sbo-rt-content .Heading+.FormalPara{margin-top:0}#sbo-rt-content .FormalPara .AuthorNames{font-style:italic;font-weight:normal !important}#sbo-rt-content .HeadingNumber{padding-right:.3em}#sbo-rt-content .RenderAsSection1>.Heading{font-size:1.44rem;margin-top:.5em;margin-bottom:.1em}#sbo-rt-content .RenderAsSection2>.Heading{font-size:1.2rem;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section2>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection3>.Heading{font-size:1.2rem;font-style:italic;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section3>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection4>.Heading{font-size:100%;font-style:italic;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section4>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection5>.Heading{font-size:100%;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section5>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection6>.Heading{font-size:100%;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section6>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection7>.Heading{font-size:100%;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section7>.Heading:first-child{margin-top:0}#sbo-rt-content .Literal{font-family:"Courier New",Courier,monospace}#sbo-rt-content .OrderedList{margin-top:.5em;margin-bottom:.5em;text-indent:0;display:table}#sbo-rt-content .OrderedList>ol{margin:0;padding:0}#sbo-rt-content .OrderedList .Heading{font-size:1em;font-style:italic;font-weight:normal;margin-top:0;margin-bottom:0;display:table-caption}#sbo-rt-content .OrderedList .Heading+.ListItem{margin-top:0}#sbo-rt-content .Heading+.Para>div.OrderedList:first-child,#sbo-rt-content .Heading+.Para>div.OrderedList:first-child>.Heading{margin-top:0}#sbo-rt-content .ListItem{margin-top:.5em;display:table-row}#sbo-rt-content .ItemNumber{padding-right:.5em;display:table-cell;vertical-align:top}#sbo-rt-content .ItemContent{display:table-cell}#sbo-rt-content .Fulltext>.Para:first-of-type{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .Fulltext>.Para~.Para:first-of-type{border-top:none;margin-top:0;padding-top:0}#sbo-rt-content .Para+.Para{margin-top:0;text-indent:1.5em}#sbo-rt-content .ParaTextBreak{margin-top:1em !important;text-indent:0 !important}#sbo-rt-content .ParaTypeExample{border-left:4px solid;padding-left:.5em;margin-top:1em !important;margin-bottom:1em}#sbo-rt-content .ParaTypeEyeCatcher,#sbo-rt-content .ParaTypeTip{border-left:4px solid;padding-left:.5em;margin-top:1em !important;margin-bottom:.5em}#sbo-rt-content .ParaTypeImportant{background:#bbb;border:2px solid;padding:.5em;margin-top:.8em !important;margin-bottom:.8em}#sbo-rt-content .ParaTypeImportant img{background-color:transparent}#sbo-rt-content .ParaTypeGeneticSequence,#sbo-rt-content .ParaTypeLiteral,#sbo-rt-content .ParaTypeProgramcode{font-family:"Courier New",Courier,monospace;font-size:95%}#sbo-rt-content .ParaTypeProgramcode{text-indent:0 !important;word-wrap:break-word}#sbo-rt-content .Para:not(.ParaTypeProgramcode)+.ParaTypeProgramcode{margin-top:.5em}#sbo-rt-content .ParaTypeProgramcode+.Para:not(.ParaTypeProgramcode){margin-top:.5em}#sbo-rt-content .ParaTypeLegalText{font-weight:bold;margin-left:1em;text-align:left}#sbo-rt-content .ParaTypeOverview,#sbo-rt-content .ParaTypeAnswers,#sbo-rt-content .ParaTypeQuestions,#sbo-rt-content .ParaTypeDefinition,#sbo-rt-content .ParaTypeProcedure,#sbo-rt-content .ParaTypeRecipe{border:2px solid;margin-top:.8em !important;margin-bottom:.8em;padding:.5em}#sbo-rt-content .ParaTypeSource{font-style:italic}#sbo-rt-content .ParaTypeTrailer,#sbo-rt-content .ParaTypeLearningGoals{font-weight:bold;padding-left:.5em;padding-right:.5em}#sbo-rt-content .ParaTypeWarning{font-weight:bold}#sbo-rt-content .ParaTypeExample,#sbo-rt-content .ParaTypeEyeCatcher,#sbo-rt-content .ParaTypeImportant,#sbo-rt-content .ParaTypeLegalText,#sbo-rt-content .ParaTypeOverview,#sbo-rt-content .ParaTypeTip,#sbo-rt-content .ParaTypeAnswers,#sbo-rt-content .ParaTypeQuestions,#sbo-rt-content .ParaTypeDefinition,#sbo-rt-content .ParaTypeProcedure,#sbo-rt-content .ParaTypeRecipe{text-indent:0 !important}#sbo-rt-content .Para+.ParaOneEmphasisChild{margin-top:1em;text-indent:0 !important}#sbo-rt-content .ParaOneEmphasisChild+.Para{text-indent:0 !important}#sbo-rt-content .PartNumber{display:block;font-size:1.73rem}#sbo-rt-content .PartTitle{display:block;font-size:1.73rem}#sbo-rt-content .SubPartTitle{display:block;font-size:1.44rem}#sbo-rt-content .ProgramCode{margin-top:1em;margin-bottom:1em}#sbo-rt-content .ProgramCode .FixedLine{font-family:"Courier New",Courier,monospace;font-size:95%;word-wrap:break-word}#sbo-rt-content .LineGroup+.LineGroup{margin-top:1em}#sbo-rt-content .Heading+.Para>.Quiz>.Heading{margin-top:0;}#sbo-rt-content .Quiz .Heading{font-size:1rem;margin-top:1em;margin-bottom:0;text-indent:0}#sbo-rt-content .QuizTask{display:table;margin-top:.5em;margin-bottom:.5em;width:100%;text-indent:0}#sbo-rt-content .QuizTask+.QuizTask{margin-top:1.5em}#sbo-rt-content .QuizItem{padding:.1em}#sbo-rt-content .QuizItemTypeSolution{border:2px solid #aaa;margin-top:.5em;padding:10px}#sbo-rt-content .QuizTask>input{display:none}#sbo-rt-content .QuizItem>label{color:#0176C3}#sbo-rt-content .QuizTask>input~.QuizItem>label+div{display:none}#sbo-rt-content .QuizTask>input:checked~.QuizItem>label+div{display:table-cell}#sbo-rt-content .QuizTask>input~.QuizItem>label:after{content:"  »"}#sbo-rt-content .QuizTask>input:checked~.QuizItem>label:after{content:"  «"}#sbo-rt-content .QuizTask>input~.QuizItemTypeCorrectAnswer{background-color:transparent;transition:background .4s}#sbo-rt-content .QuizTask>input:checked~.QuizItemTypeCorrectAnswer{background-color:#EAF2DB;transition:background .4s}#sbo-rt-content .ReviewTitle{font-weight:bold;margin-top:1em;text-indent:0}#sbo-rt-content .Review .AuthorName+.AuthorName:before{content:", "}#sbo-rt-content .Review .ISBN,#sbo-rt-content .ReviewDataUnstructured{text-indent:0}#sbo-rt-content .Review .Para:first-of-type{margin-top:1em;text-indent:0}#sbo-rt-content .BookBackmatter>.Appendix:first-child>div:first-child{border-top:none !important;margin-top:0 !important;padding-top:0 !important}#sbo-rt-content .BookAcknowledgmentsBody>.RenderAsSection1:first-child,#sbo-rt-content .BookNotesBody>.RenderAsSection1:first-child,#sbo-rt-content .ForewordBody>.RenderAsSection1:first-child,#sbo-rt-content .PrefaceBody>.RenderAsSection1:first-child,#sbo-rt-content .BookBackmatter>.Appendix:first-child>.RenderAsSection1:first-child{border-top:none;margin-top:0}#sbo-rt-content .BookAcknowledgmentsBody>.RenderAsSection1:first-child>.Heading,#sbo-rt-content .ForewordBody>.RenderAsSection1:first-child>.Heading,#sbo-rt-content .PrefaceBody>.RenderAsSection1:first-child>.Heading{margin-top:0}#sbo-rt-content .Section1 .AuthorNames,#sbo-rt-content .Section2 .AuthorNames,#sbo-rt-content .Section3 .AuthorNames{font-weight:bold;margin-top:.3em;margin-bottom:.5em}#sbo-rt-content .Section1 .AuthorNames sup,#sbo-rt-content .Section2 .AuthorNames sup,#sbo-rt-content .Section3 .AuthorNames sup{font-size:70%}#sbo-rt-content .Section1 .Affiliations,#sbo-rt-content .Section2 .Affiliations,#sbo-rt-content .Section3 .Affiliations{margin-bottom:.5em}#sbo-rt-content .SectionTypeBackgroundInformation,#sbo-rt-content .SectionTypeExcurse{font-size:90%}#sbo-rt-content .SectionTypeBox,#sbo-rt-content .SectionTypeOverview,#sbo-rt-content .SectionTypeQuestionnaire{background-color:#BBB;margin-top:1em !important;padding:.5em}#sbo-rt-content .SectionTypeCaseStudy,#sbo-rt-content .SectionTypeExample,#sbo-rt-content .SectionTypeTip{border-left:4px solid;margin-top:1em !important;padding-top:0;padding-left:.5em;padding-right:.5em;padding-bottom:.5em}#sbo-rt-content .SectionTypeTrailer,#sbo-rt-content .SectionTypeLearningGoals{font-weight:bold;text-align:left}#sbo-rt-content .SectionTypeLegalText{font-weight:bold;margin-left:1em;text-align:left;text-indent:0 !important}#sbo-rt-content .SectionTypeProcedure,#sbo-rt-content .SectionTypeRecipe{border:2px solid;margin-top:.8em !important;margin-bottom:.8em;padding:.5em}#sbo-rt-content .SectionTypeWarning{font-weight:bold}#sbo-rt-content .RenderAsSection1{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .SectionTypeBox+.RenderAsSection1,#sbo-rt-content .SectionTypeOverview+.RenderAsSection1,#sbo-rt-content .SectionTypeQuestionnaire+.RenderAsSection1{border-top:0;}#sbo-rt-content .SectionTypeBox>.Heading,#sbo-rt-content .SectionTypeOverview>.Heading,#sbo-rt-content .SectionTypeQuestionnaire>.Heading,#sbo-rt-content .SectionTypeProcedure>.Heading,#sbo-rt-content .SectionTypeRecipe>.Heading{margin-top:0}#sbo-rt-content .InternalRefSidebarLexicon{background-image:url(sidebar.gif);background-repeat:no-repeat;font-weight:bold;padding-left:20px}#sbo-rt-content .SidebarDialog{border:1px solid;margin-left:1.5em;margin-top:.4em;margin-bottom:.2em;padding:.2em;text-indent:0}#sbo-rt-content .SidebarNumber{font-weight:bold;padding-right:.5em}#sbo-rt-content .SimplePara+.SimplePara{margin-top:0;text-indent:1.5em}#sbo-rt-content .Stack{display:inline-table;vertical-align:top}#sbo-rt-content .Stack sub{display:table-row}#sbo-rt-content .Stack sup{display:table-header-group}#sbo-rt-content table{border-collapse:collapse;font-size:80%;max-width:100%;text-indent:0}#sbo-rt-content table .SimplePara+.SimplePara{text-indent:0}#sbo-rt-content table,#sbo-rt-content tr,#sbo-rt-content td{border-color:#bbb !important}#sbo-rt-content th{border-color:#999 !important}#sbo-rt-content thead{background:#bbb;color:#000 !important}#sbo-rt-content .Table{margin-bottom:1em;text-indent:0}#sbo-rt-content .Caption .Table{margin-bottom:0}#sbo-rt-content .Table img{height:auto;margin:0;max-width:100%}#sbo-rt-content th div{text-align:left}#sbo-rt-content td div,#sbo-rt-content td p,#sbo-rt-content th div,#sbo-rt-content th p{padding:.2em}#sbo-rt-content .Para+.Table,#sbo-rt-content .Para>.Table{margin-top:1em}#sbo-rt-content .SimplePara>.Table{margin-top:.5em}#sbo-rt-content thead,#sbo-rt-content tdiv{vertical-align:top}#sbo-rt-content tbody+tbody tr:first-child td{padding-top:1em}#sbo-rt-content .ExternalTable{background-color:#F8F8F8;border-top:1px solid;border-bottom:1px solid;margin-top:1em;margin-bottom:1em;padding-top:0;padding-bottom:0}#sbo-rt-content .ExternalTable .Table{padding-bottom:.3em}#sbo-rt-content .UnorderedList>.Heading{font-size:1em;font-style:italic;font-weight:normal;margin-top:0;margin-bottom:0}#sbo-rt-content .Heading+.Para>div.UnorderedList:first-child>.Heading{margin-top:0}#sbo-rt-content .UnorderedList li .Para:first-child{text-indent:0}#sbo-rt-content .Heading+ul{margin-top:0}#sbo-rt-content ul{margin-top:.5em;margin-bottom:.5em}#sbo-rt-content ul.UnorderedListMarkBullet{list-style-type:disc;padding-left:1em}#sbo-rt-content ul.UnorderedListMarkBullet div{margin-bottom:.3em}#sbo-rt-content ul.UnorderedListMarkBullet .Equation div{margin-bottom:0}#sbo-rt-content ul.UnorderedListMarkNone{list-style-type:none;padding-left:1em}#sbo-rt-content ul.UnorderedListMarkNone div{margin-bottom:.3em}#sbo-rt-content ul.UnorderedListMarkNone .Equation div{margin-bottom:0}#sbo-rt-content ul.UnorderedListMarkDash{list-style:none;padding-left:1.1em;text-indent:-.8em}#sbo-rt-content ul.UnorderedListMarkDash>li>*:first-child{display:inline}#sbo-rt-content ul.UnorderedListMarkDash div{text-indent:0;margin-top:.3em;margin-bottom:.3em}#sbo-rt-content ul.UnorderedListMarkDash>li:before{content:"– "}#sbo-rt-content .Verse{margin-top:1em;margin-bottom:1em}#sbo-rt-content .Verse .Heading{font-size:1rem;margin-top:1em;margin-bottom:1em;text-indent:0}#sbo-rt-content .Acknowledgments,#sbo-rt-content .AuthorContribution,#sbo-rt-content .Ethics{margin-top:1em}#sbo-rt-content .Acknowledgments>.Heading,#sbo-rt-content .AuthorContribution>.Heading,#sbo-rt-content .FundingInformation>.Heading,#sbo-rt-content .DataAvailability>.Heading,#sbo-rt-content .Ethics>.Heading{font-size:1.2rem;margin-bottom:0}#sbo-rt-content .License{font-size:.9rem !important;margin-top:1em;margin-bottom:1em}#sbo-rt-content .License>a:first-child img{float:left;height:1.9rem;padding-right:.5em;padding-bottom:0;padding-top:.2em}#sbo-rt-content .Glossary{border-top:1px solid #bbb;margin-top:1em;margin-bottom:1em;padding-top:.3em}#sbo-rt-content .Glossary .Headings{margin-top:.8em;margin-bottom:.8em}#sbo-rt-content .Glossary>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Glossary>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .GlossarySection .Headings{margin-top:.8em;margin-bottom:.4em}#sbo-rt-content .GlossarySection>.Headings>.Heading{font-size:1.2rem;margin:0}#sbo-rt-content .GlossarySection>.Headings>.SubHeading{font-size:100%}#sbo-rt-content .GlossaryTerm{float:left;font-style:italic;padding-right:.5em}#sbo-rt-content .GlossarySeeLabel,#sbo-rt-content .GlossarySeeAlsoLabel{font-style:italic;padding-right:.3em}#sbo-rt-content .GlossaryDef{display:inline;margin-top:.3em}#sbo-rt-content .GlossaryDef>.SimplePara,#sbo-rt-content .GlossaryDef>.GlossarySee,#sbo-rt-content .GlossaryDef>.GlossarySeeAlso{display:block}#sbo-rt-content .GlossaryDef>:first-child{display:inline;margin-top:0;margin-left:0}#sbo-rt-content .GlossaryDef .SimplePara+.GlossarySee,#sbo-rt-content .GlossaryDef .SimplePara+.GlossarySeeAlso{text-indent:0}#sbo-rt-content .GlossaryTerm{display:inline}#sbo-rt-content .GlossaryTerm+.GlossarySee,#sbo-rt-content .GlossaryTerm+.GlossarySeeAlso{display:inline}#sbo-rt-content .InternalRefGlossaryEntry{border-bottom:thin dotted;cursor:help}#sbo-rt-content .InternalRefGlossaryEntry:hover{border-bottom:none}#sbo-rt-content .InternalRefGlossaryEntry a:link,#sbo-rt-content .InternalRefGlossaryEntry a:active,#sbo-rt-content .InternalRefGlossaryEntry a:visited{color:inherit}#sbo-rt-content .InternalRefGlossaryEntry .InlineGlossaryDefinition{background:#fff;display:none;margin:0 3em 0 2em;padding:3px 3px 3px 6px;border-style:solid;border-color:#49546F;border-width:2px;border-radius:5px;box-shadow:5px 5px 5px #888}#sbo-rt-content .InternalRefGlossaryEntry:hover .InlineGlossaryDefinition{display:block;z-index:6}#sbo-rt-content .TocAppendix{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .BookContextInformation+.Appendix>.TocAppendix:first-child{border-top:none;padding-top:0}#sbo-rt-content .TocAppendix .Headings{margin-bottom:.5em}#sbo-rt-content .TocAppendix>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .TocAppendix>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .TocEntry,#sbo-rt-content .TocPart,#sbo-rt-content .TocBack{margin-top:.5em;text-align:left !important}#sbo-rt-content .TocItem{font-weight:bold}#sbo-rt-content .TocPageNumber{display:none}#sbo-rt-content .TocAuthors{padding-left:1.5em}#sbo-rt-content .TocSection1,#sbo-rt-content .TocSection2,#sbo-rt-content .TocSection3,#sbo-rt-content .TocSection4,#sbo-rt-content .TocSection5,#sbo-rt-content .TocSection6,#sbo-rt-content .TocSection7{padding-left:1.5em}#sbo-rt-content .Index{border-top:1px solid #bbb;margin-top:1em;padding-top:.3em;margin-bottom:.8em}#sbo-rt-content .BookBackmatter>.Index:first-child{border-top:none;margin-top:0}#sbo-rt-content .Index .Headings{margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .BookBackmatter>.Index:first-child>.Headings{margin-top:0}#sbo-rt-content .Index>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Index>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .IndexDiv .Headings{margin-top:.5em;margin-bottom:.1em}#sbo-rt-content .IndexDiv>.Headings>.Heading{font-size:1.2rem;margin:0}#sbo-rt-content .IndexDiv>.Headings>.SubHeading{font-size:100%;font-style:italic}#sbo-rt-content .IndexEntrySeeLabel{font-style:italic;margin-left:1em;padding-right:.3em}#sbo-rt-content .SecondaryIE{margin-left:1em}#sbo-rt-content .TertiaryIE{margin-left:2em}#sbo-rt-content .ChangeHistory{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .ChangeHistory>.Heading{font-size:1.44rem;margin-top:.8em;margin-bottom:.3em}#sbo-rt-content .ChangeDate{font-weight:bold;padding-right:1em}#sbo-rt-content .ChangeDetails{display:inline}#sbo-rt-content .ChangeDetails>p:first-of-type{display:inline}#sbo-rt-content .Bibliography{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .BookBackmatter>.Bibliography:first-child{border-top:none}#sbo-rt-content .Bibliography>.Heading{font-size:1.44rem;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .BibliographyWrapper{display:table;margin:0;padding:0}#sbo-rt-content .Bibliography>.BibliographyWrapper{padding-top:1em}#sbo-rt-content .Bibliography>.Heading+.BibliographyWrapper{padding-top:0}#sbo-rt-content .BibSection>.Heading{font-size:1.2rem;margin-top:.8em;margin-bottom:.2em}#sbo-rt-content .BibliographyWrapper>.BibSection:first-child>.Heading:first-child{margin-top:.3em}#sbo-rt-content .Citation{display:table-row;font-size:90%}#sbo-rt-content .CitationNumber{display:table-cell}#sbo-rt-content .CitationNumber+.CitationContent{padding-left:.5em;text-align:left}#sbo-rt-content .CitationContent{padding-top:1em;display:table-cell}#sbo-rt-content .BibliographyWrapper>.Citation:first-child>.CitationContent{padding-top:0}#sbo-rt-content .Occurrences{display:block}#sbo-rt-content .Occurrence{margin-right:0}#sbo-rt-content .Occurrence:before{content:"["}#sbo-rt-content .Occurrence:after{content:"]"}#sbo-rt-content .Citation .ArticleTitle:before,#sbo-rt-content .Citation .ChapterTitle:before{content:" “";}#sbo-rt-content .Citation .ArticleTitle,#sbo-rt-content .Citation .ChapterTitle{display:inline}#sbo-rt-content .Citation .ArticleTitle:after{content:"”\ ";}#sbo-rt-content .Citation .ChapterTitle:after{content:"”\ In: ";}#sbo-rt-content .Citation .Year:before{content:" ("}#sbo-rt-content .Citation .Year:after{content:") "}#sbo-rt-content .Citation .JournalTitle:after{content:" "}#sbo-rt-content .Citation .VolumeID:after{content:":"}#sbo-rt-content .BibChapter .FirstPage:before,#sbo-rt-content .BibBook .FirstPage:before{content:", pp "}#sbo-rt-content .Citation .FirstPage+.LastPage:before{content:"–";}#sbo-rt-content .Citation .BookTitle:after,#sbo-rt-content .Citation .BibEditorName:after,#sbo-rt-content .Citation .EditionNumber:after,#sbo-rt-content .Citation .PublisherName:after{content:", "}#sbo-rt-content .BibComments{display:block}#sbo-rt-content .CoverFigure img{margin:0 auto 6px;width:100%;max-width:480px;height:auto}#sbo-rt-content .SeriesTitlePage{padding-bottom:1.5em;padding-top:1em}#sbo-rt-content .SeriesTitlePage .VolumeNumber{font-size:1.44rem}#sbo-rt-content .SeriesTitlePage span.SeriesTitle{display:block;font-size:1.73rem;font-weight:bold;margin-top:.5em}#sbo-rt-content .SeriesTitlePage .SeriesSubTitle{display:block;font-size:1.44rem;font-weight:bold}#sbo-rt-content .SeriesTitlePage .SubSeriesTitle{display:block;font-size:1.44rem;font-weight:bold;margin-top:.5em}#sbo-rt-content .SeriesTitlePage .SubSeriesSubTitle{display:block;font-size:1.2rem;font-weight:bold}#sbo-rt-content .SeriesTitlePage .CollaboratorDesignation{display:block;font-weight:bold;padding-top:3em}#sbo-rt-content .SeriesTitlePage .Collaborators{display:block}#sbo-rt-content .SeriesTitlePage .AffiliationText{font-style:italic;margin-left:0}#sbo-rt-content .SeriesTitlePage .Affiliation+.CollaboratorName{display:inline-block;margin-top:1em}#sbo-rt-content .SeriesInformationText{padding-top:3em}#sbo-rt-content .BookTitlePage{padding-top:1em}#sbo-rt-content .BookTitlePageAfterSeriesTitlePage{border-top:1px solid #bbb;page-break-before:always}#sbo-rt-content .BookContextInformation+.BookTitlePage{border-top:none;padding-top:0}#sbo-rt-content .BookTitlePage .BookEditors,#sbo-rt-content .BookTitlePage .BookAuthors,#sbo-rt-content .BookTitlePage .BookEditorInChiefGroup,#sbo-rt-content .BookTitlePage .BookSectionEditorGroup{text-align:left !important}#sbo-rt-content .BookTitlePage .BookEditorInChiefGroup,#sbo-rt-content .BookTitlePage .BookSectionEditorGroup{margin-top:1em}#sbo-rt-content .BookTitlePage .BookEditorGroup .CollaboratorDesignation,#sbo-rt-content .BookTitlePage .BookEditorInChiefGroup .CollaboratorDesignation,#sbo-rt-content .BookTitlePage .BookSectionEditorGroup .CollaboratorDesignation{font-style:italic}#sbo-rt-content .BookTitlePage .BookTitle{display:block;font-size:1.73rem;font-weight:bold;margin-top:1em}#sbo-rt-content .BookTitlePage .BookSubTitle{display:block;font-size:1.44rem;font-weight:bold;margin-bottom:.5em}#sbo-rt-content .BookTitlePage .BookEdition{display:block;font-size:1rem;font-weight:normal;margin-top:.5em}#sbo-rt-content .BookTitlePage .CollaboratorLine{padding-top:.5em}#sbo-rt-content .BookFeatureText{margin-top:.5em}#sbo-rt-content .BookTitlePage .PublisherLogo .Figure,#sbo-rt-content .BookTitlePage .PublisherImprintName{font-size:1.2rem;margin-top:4em;margin-bottom:1.5em;text-align:left}#sbo-rt-content .CopyrightPage{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .CopyrightPage .CollaboratorDesignation{display:block;font-style:italic;padding-bottom:.5em}#sbo-rt-content .CopyrightPageOriginators{padding-bottom:4em}#sbo-rt-content .CopyrightPage div+.CollaboratorDesignation{padding-top:2em}#sbo-rt-content .CopyrightPage .EditorGroup+.AuthorGroup{padding-top:2em}#sbo-rt-content .CopyrightPage .Author+.Author,#sbo-rt-content .CopyrightPage .Author+.InstitutionalAuthor,#sbo-rt-content .CopyrightPage .InstitutionalAuthor+.Author,#sbo-rt-content .CopyrightPage .InstitutionalAuthor+.InstitutionalAuthor,#sbo-rt-content .CopyrightPage .Editor+.Editor,#sbo-rt-content .CopyrightPage .Editor+.InstitutionalEditor,#sbo-rt-content .CopyrightPage .InstitutionalEditor+.Editor,#sbo-rt-content .CopyrightPage .InstitutionalEditor+.InstitutionalEditor,#sbo-rt-content .CopyrightPage .Collaborator+.Collaborator{padding-top:1em}#sbo-rt-content .CopyrightPage .Affiliation{margin-top:0}#sbo-rt-content .CopyrightPage .AffiliationText{margin-left:0}#sbo-rt-content .CopyrightPage .CollaboratorLine{padding-top:1em}#sbo-rt-content .CopyrightPage .CollaboratorLineTranslatedBy{padding-top:2em}#sbo-rt-content .CopyrightPage .CollaboratorLine .CollaboratorDesignation{display:inline;font-style:normal}#sbo-rt-content .BookFrontmatter .CopyrightPage .ArticleNoteESMHint{border:none;padding-bottom:0;page-break-before:auto}#sbo-rt-content .CopyrightPageISBNs,#sbo-rt-content .CopyrightPageISSNs,#sbo-rt-content .SpringerLocationsLine,#sbo-rt-content .CatalogingInformation,#sbo-rt-content .MathematicsSubjectClassification,#sbo-rt-content .CopyrightLine,#sbo-rt-content .CopyrightPage .CopyrightComment,#sbo-rt-content .BookCopublishingInformation .SimplePara,#sbo-rt-content .CopyrightStandardText,#sbo-rt-content .TrademarkQualifierText,#sbo-rt-content .ProductLiability,#sbo-rt-content .LegalNotice,#sbo-rt-content .CoverDesigner,#sbo-rt-content .BookCoverFigureText,#sbo-rt-content .PaperInfo,#sbo-rt-content .SpringerReferenceLine{margin-top:1em}#sbo-rt-content .CopyrightComment+.CopyrightLine{margin-top:.5em}#sbo-rt-content .SeriesTitle+.CopyrightPageISBNs,#sbo-rt-content .SubSeriesTitle+.CopyrightPageISBNs{margin-top:0}#sbo-rt-content .CopyrightPage .SeriesTitle{display:block;margin-top:1em}#sbo-rt-content .SeriesTitle+.CopyrightPageISSNs,#sbo-rt-content .CopyrightPageISSNs+.SeriesTitle,#sbo-rt-content .CopyrightPageISSNs+.SubSeriesTitle{margin-top:0}#sbo-rt-content .CopyrightPagePrintISSN,#sbo-rt-content .CopyrightPagePrintISBN{display:inline-block;min-width:12em}#sbo-rt-content .SpringerReferenceLine .SimplePara+.SimplePara,#sbo-rt-content .BookCoverFigureText .SimplePara+.SimplePara,#sbo-rt-content .BookCopublishingInformation .SimplePara+.SimplePara{text-indent:0}#sbo-rt-content .CopyrightPagePrintISSN+.CopyrightPageElectronicISSN{padding-left:1.5em}#sbo-rt-content .CopyrightPagePrintISBN+.CopyrightPageElectronicISBN{padding-left:1.5em}#sbo-rt-content .CopyrightComment .SimplePara+.SimplePara{padding-top:.5em;text-indent:0}#sbo-rt-content .MathematicsSubjectClassificationCode+.MathematicsSubjectClassificationCode:before{content:", "}#sbo-rt-content .Endorsement{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Frontispiece{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Dedication{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Foreword{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PartFrontmatter h1:first-child+.Foreword{border-top:none;padding-top:0;page-break-before:auto}#sbo-rt-content .ForewordTitle{font-size:1.44rem;font-weight:bold;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .Foreword .AuthorName{margin-top:.2em}#sbo-rt-content .Foreword .AuthorName,#sbo-rt-content .ForewordLocations,#sbo-rt-content .ForewordDate{font-weight:bold;text-align:right}#sbo-rt-content .ForewordLocation+.ForewordLocation:before{content:", "}#sbo-rt-content .Foreword .RenderAsSection1>.Heading{font-size:1.2rem}#sbo-rt-content .Foreword .RenderAsSection2>.Heading,#sbo-rt-content .Foreword .RenderAsSection3>.Heading{font-size:100%}#sbo-rt-content .Preface{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PrefaceTitle{font-size:1.44rem;font-weight:bold;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .Preface .AuthorName{margin-top:.2em}#sbo-rt-content .Preface .AuthorName,#sbo-rt-content .PrefaceLocations,#sbo-rt-content .PrefaceDate{font-weight:bold;text-align:right}#sbo-rt-content .PrefaceLocation+.PrefaceLocation:before{content:", "}#sbo-rt-content .Preface .RenderAsSection1>.Heading{font-size:1.2rem}#sbo-rt-content .Preface .RenderAsSection2>.Heading,#sbo-rt-content .Preface .RenderAsSection3>.Heading{font-size:100%}#sbo-rt-content .BookFrontmatterArticleNote{border-top:1px solid #bbb;margin-top:0;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PartFrontmatter .ArticleNote{padding-bottom:1em}#sbo-rt-content .PartFrontmatter h1:first-child+.ArticleNote{border-top:none;page-break-before:auto}#sbo-rt-content .BookFrontmatter .ArticleNote .Heading,#sbo-rt-content .PartFrontmatter .ArticleNote .Heading{font-size:1.44rem;font-style:normal;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookAcknowledgments{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .BookAcknowledgmentsTitle{font-size:1.44rem;font-weight:bold;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookAcknowledgments .AuthorName{font-weight:bold;margin-top:1em}#sbo-rt-content .BookAcknowledgments .RenderAsSection1>.Heading{font-size:1.2rem}#sbo-rt-content .BookAcknowledgments .RenderAsSection2>.Heading,#sbo-rt-content .BookAcknowledgments .RenderAsSection3>.Heading{font-size:100%}#sbo-rt-content .BookNotes{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .BookNotesTitle{font-size:1.44rem;font-weight:bold;margin-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookNotes .AuthorName{font-weight:bold}#sbo-rt-content .BookFrontmatterAbbreviationGroup{border-top:1px solid #bbb;margin-top:0;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PartFrontmatter .AbbreviationGroup{padding-bottom:1em;margin-top:1em}#sbo-rt-content .BookFrontmatter .AbbreviationGroup .Heading,#sbo-rt-content .PartFrontmatter .AbbreviationGroup .Heading{font-size:1.44rem;font-weight:bold;padding-top:1em;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookFrontmatter .AbbreviationGroupSection>.Heading,#sbo-rt-content .PartFrontmatter .AbbreviationGroupSection>.Heading{font-size:1.2rem;padding-top:1em;padding-bottom:0}#sbo-rt-content .BookFrontmatter .AbbreviationGroupSection+.AbbreviationGroupSection>.Heading,#sbo-rt-content .PartFrontmatter .AbbreviationGroupSection+.AbbreviationGroupSection>.Heading{padding-top:.5em}#sbo-rt-content .Toc{border-top:1px solid #bbb;margin-top:0;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Toc .Headings{margin-bottom:.5em}#sbo-rt-content .Toc>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Toc>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .Loh{border-top:1px solid #bbb;padding-bottom:1em;padding-top:1em;page-break-before:always}#sbo-rt-content .Loh .Headings{margin-bottom:.1em}#sbo-rt-content .Loh>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Loh>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .LohPageNumber{display:none}#sbo-rt-content .LocWithHeading,#sbo-rt-content .LocWithoutHeading>.LocBody>.LocDiv{border-top:1px solid #bbb;padding-bottom:1em;padding-top:1em;page-break-before:always}#sbo-rt-content .Loc .Headings{margin-bottom:.1em}#sbo-rt-content .LocWithHeading>.Headings>.Heading,#sbo-rt-content .LocWithoutHeading>.LocBody>.LocDiv>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .LocWithHeading>.Headings>.SubHeading,#sbo-rt-content .LocWithoutHeading>.LocBody>.LocDiv>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .LocWithHeading .LocDiv{margin-top:1em}#sbo-rt-content .LocWithHeading .LocDiv .Heading{font-size:1.2rem;margin-bottom:.1em}#sbo-rt-content .LocWithHeading .LocDiv .SubHeading{font-size:100%;font-style:italic;font-weight:normal}#sbo-rt-content .LocDiv .FormalPara .Heading{font-size:100%}#sbo-rt-content .Loc .AuthorGroup+.AuthorGroup,#sbo-rt-content .Loc .AuthorGroup+.EditorGroup,#sbo-rt-content .Loc .EditorGroup+.AuthorGroup,#sbo-rt-content .Loc .EditorGroup+.EditorGroup{margin-top:1em}#sbo-rt-content .Loc .Author,#sbo-rt-content .Loc .Editor,#sbo-rt-content .Loc .InstitutionalAuthor,#sbo-rt-content .Loc .InstitutionalEditor{font-weight:bold}#sbo-rt-content .Loc .AffiliationText{margin-left:0}#sbo-rt-content .Loc .Email+.Email:before{content:", "}#sbo-rt-content .Loc .Emails,#sbo-rt-content .Loc .URLs{display:inline}#sbo-rt-content .Loc .Emails+.URLs:before{content:", "}#sbo-rt-content .Loc .URL+.URL:before{content:", "}#sbo-rt-content .BookFrontmatterFootnoteSection{border-top:1px solid #bbb;margin-top:0;page-break-before:always}#sbo-rt-content .PartFrontmatter .FootnoteSection{border-top:none;margin-top:0}#sbo-rt-content .Colophon{border-top:1px solid #bbb;margin-top:1em;padding-top:.8em;font-style:italic}#sbo-rt-content .ConferenceInfo{border-top:1px solid #bbb;margin-top:1em;padding-top:.8em}#sbo-rt-content .ConfEventAbbreviation,#sbo-rt-content .ConfNumber+.ConfSeriesName,#sbo-rt-content .ConfEventAbbreviation+.Year,#sbo-rt-content .ConfEventDateStart,#sbo-rt-content .ConfEventDateEnd{display:inline}#sbo-rt-content .ConfEventAbbreviation:after{content:" "}#sbo-rt-content .ConfEventLocation .City:after{content:", "}#sbo-rt-content .ConfEventDateEnd:before{content:"–"}#sbo-rt-content .ConfEventDateStart .Year:after,#sbo-rt-content .ConfEventDateStart .Month:after,#sbo-rt-content .ConfEventDateEnd .Year:after,#sbo-rt-content .ConfEventDateEnd .Month:after{content:"/"}#sbo-rt-content .ConfEventDate .Month:after{content:"/"}
    </style><script> // <![CDATA[
    var g = {
      position_cache: {
        
          "chapter": "/api/v1/book/9781484226018/chapter/html/425975_1_En_4_Chapter.xhtml",
          "book_id": "9781484226018",
          "chapter_uri": "html/425975_1_En_4_Chapter.xhtml",
          "position": 0,
          "user_uuid": "39a88cd5-54f5-4d61-aec6-7884d06dfba1",
          "next_chapter_uri": "/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_5_Chapter.xhtml"
        
      },
      title: "Securing the Perimeter: Deploying Identity and Access Management with Free Open Source Software",
      author_list: "Michael Schwartz, Maciej Machulak",
      format: "book",
      source: "application/epub+zip",
      is_system_book: true,
      is_public: false,
      loaded_from_server: true,
      allow_scripts: false,
      has_mathml: false
    };
    // ]]></script><script src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/modernizr.8e35451ddb64.js"></script><script>
    
      

      
        
          window.PUBLIC_ANNOTATIONS = true;
        
      

      window.MOBILE_PUBLIC_ANNOTATIONS = false;

    

    
      window.PRIVACY_CONTROL_OVERRIDE = false;
    

      window.PRIVACY_CONTROL_SWITCH = true;

      window.PUBLISHER_PAGES = true;

      window.SBO = {
        "constants": {
          "SITB_ENDPOINT": "/api/v2/sitb/",
          "SEARCH_SELECT_ENDPOINT": "https://learning.oreilly.com/api/v2/search/select/",
          "ENABLE_ONLINE_TRAINING": true
        }
      };
  </script><link rel="canonical" href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml"><meta name="description" content="© Michael Schwartz, Maciej Machulak 2018 Michael Schwartz and Maciej MachulakSecuring the Perimeterhttps://doi.org/10.1007/978-1-4842-2601-8_4 4. OAuth Michael Schwartz1  and Maciej Machulak2 (1)Austin, TX, USA (2)London, UK   OAuth 2.0 (or simply ...!--end&gt;!--begin&gt; "><meta property="og:title" content="4. OAuth"><meta itemprop="isPartOf" content="/library/view/securing-the-perimeter/9781484226018/"><meta itemprop="name" content="4. OAuth"><meta property="og:url" itemprop="url" content="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781484226018/"><meta property="og:description" itemprop="description" content="© Michael Schwartz, Maciej Machulak 2018 Michael Schwartz and Maciej MachulakSecuring the Perimeterhttps://doi.org/10.1007/978-1-4842-2601-8_4 4. OAuth Michael Schwartz1  and Maciej Machulak2 (1)Austin, TX, USA (2)London, UK   OAuth 2.0 (or simply ...!--end&gt;!--begin&gt; "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="Apress"><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781484226018"><meta property="og:book:author" itemprop="author" content="Michael Schwartz"><meta property="og:book:author" itemprop="author" content="Maciej Machulak"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@safari"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &lt;%= font_size %&gt; !important; }"></style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &lt;%= font_family %&gt; !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: &lt;%= column_width %&gt;% !important; margin: 0 auto !important; }"></style><noscript><meta http-equiv="refresh" content="0; url=/library/no-js/" /></noscript><script>
    var dataLayer = window.dataLayer || [];

    
      window.medalliaVsgUserIdentifier = '39a88cd5-54f5-4d61-aec6-7884d06dfba1';
      dataLayer.push({userIdentifier: '39a88cd5-54f5-4d61-aec6-7884d06dfba1'});
      dataLayer.push({loggedIn: 'yes'});

      
        window.medalliaVsgAccountIdentifier = 'c1ff3208-121f-489a-a3cd-0b219a28ba6e';
        

        window.medalliaVsgIsIndividual = true;
        
          
          dataLayer.push({learningAccountType: 'free trial'});
          
        

        
      
    

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4V6Z');
    (function () {
      var VERSION = 'V1.1';
      var AUTHOR = 'Awwad';
      if (!window.GtmHelper)
        window.GtmHelper = function () {
          var instance = this;
          var loc = document.location;
          this.version = VERSION;
          this.author = AUTHOR;
          this.readCookie = function (name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
              var c = ca[i];
              while (c.charAt(0) == ' ') c = c.substring(1, c.length);
              if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
          };
          this.createCookie = function (name, value, days, cookieDomain) {
            var domain = "";
            var expires = "";

            if (days) {
              var date = new Date();
              date.setTime(date.getTime() + Math.ceil(days * 24 * 60 * 60 * 1000));
              var expires = " expires=" + date.toGMTString() + ";";
            }

            if (typeof (cookieDomain) != 'undefined')
              domain = " domain=" + cookieDomain + "; ";

            document.cookie = name + "=" + value + ";" + expires + domain + "path=/";
          };

          this.isDuplicated = function (currentTransactionId) {
            // the previous transaction id:
            var previousTransIdValue = this.readCookie("previousTransId");

            if (currentTransactionId === previousTransIdValue) {
              return true; // Duplication
            } else {
              return false;
            }
          };
        }
    })()
  </script><script defer="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/vendor.667e7ada497a.js"></script><script defer="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/reader.d25c5547507a.js"></script><iframe src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource.html"></iframe><iframe src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource(2).html"></iframe><iframe src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource(3).html"></iframe><link rel="stylesheet" type="text/css" href="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/container.40a6b605d29a66b083aa6d74c07bb73eae19e31b.css"><iframe src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource(4).html"></iframe><script async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/MathJax.js"></script><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 100019;
}
.annotator-filter {
  z-index: 100009;
}</style><link href="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/840a321d95.css" media="all" rel="stylesheet"><script src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f(1).txt"></script><script src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f(2).txt"></script><script src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f(3).txt"></script><style type="text/css" id="kampyleStyle">.noOutline{outline: none !important;}.wcagOutline:focus{outline: 1px dashed #595959 !important;outline-offset: 2px !important;transition: none !important;}</style></head>


<body class="reading sidenav nav-collapsed scalefonts subscribe-panel library">

    
  <noscript> 
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
            height="0" width="0"
            style="display:none;visibility:hidden">
    </iframe>
  </noscript>



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        

  


<a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li><a href="https://learning.oreilly.com/home/" class="l0 nav-icn"><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.738 14H9.254v-3.676a.617.617 0 0 0-.621-.613H7.39a.617.617 0 0 0-.62.613V14H4.284a.617.617 0 0 1-.622-.613V10.22c0-.327.132-.64.367-.87l3.547-3.493a.627.627 0 0 1 .875 0l3.54 3.499c.234.229.366.54.367.864v3.167a.617.617 0 0 1-.62.613zM7.57 2.181a.625.625 0 0 1 .882 0l5.77 5.692-.93.92-5.28-5.209-5.28 5.208-.932-.919 5.77-5.692z"></path></svg><span>Home</span></a></li><li class="search"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="l1 nav-icn "><!--?xml version="1.0" encoding="UTF-8"?--><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M8,8 C6.34321755,8 5.00013,6.65691245 5.00013,5.00013 C5.00013,3.34334755 6.34321755,2.00026001 8,2.00026001 C9.65678245,2.00026001 10.99987,3.34334755 10.99987,5.00013 C10.99987,6.65691245 9.65678245,8 8,8 Z M2.33024571,11.3523547 L2.33774538,11.3523547 C3.7622187,9.70968996 5.82947484,8.76608166 8.00374984,8.76608166 C10.1780248,8.76608166 12.245281,9.70968996 13.6697543,11.3523547 C13.8892083,11.6177474 14.0062813,11.9530021 13.99974,12.2973138 L13.99974,13.99974 L2.00026001,13.99974 L2.00026001,12.2973138 C1.99371867,11.9530021 2.11079172,11.6177474 2.33024571,11.3523547 Z" id="path-1"></path></svg><span>Your O'Reilly</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/profile/" class="l2 nav-icn"><span>Profile</span></a></li><li><a href="https://learning.oreilly.com/history/" class="l2 nav-icn"><span>History</span></a></li><li><a href="https://learning.oreilly.com/playlists/" class="l2 nav-icn"><span>Playlists</span></a></li><li><a href="https://learning.oreilly.com/u/39a88cd5-54f5-4d61-aec6-7884d06dfba1/" class="l2 nav-icn"><span>Highlights</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.564 2.263l2.172 2.174c.17.168.264.397.264.636V11a.6.6 0 0 1-.6.6h-.6V6.2h-6V2.6a.6.6 0 0 1 .6-.6h3.527c.239 0 .468.095.637.263zM2.6 14a.6.6 0 0 1-.6-.6V6.8a.6.6 0 0 1 .6-.6h1.903a1.2 1.2 0 0 1 .849.352L6.2 7.4H11a.6.6 0 0 1 .6.6v5.4a.6.6 0 0 1-.6.6H2.6zM11 5h1.8L11 3.2V5z"></path></svg><span>Featured</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/resource-centers/" class="l2 nav-icn"><span>Resource Centers</span></a></li><li><a href="https://learning.oreilly.com/search/?query=&amp;extended_publisher_data=true&amp;highlight=true&amp;include_assessments=false&amp;include_case_studies=true&amp;include_courses=true&amp;include_orioles=true&amp;include_playlists=true&amp;include_collections=true&amp;include_notebooks=true&amp;is_academic_institution_account=false&amp;source=user&amp;formats=collection&amp;sort=date_added&amp;facet_json=true&amp;page=0&amp;collection_type=expert" class="l2 nav-icn"><span>Expert Playlists</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="l1 nav-icn "><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.6467109,4.35328907 L14.7964612,7.51003884 C15.0678463,7.78304342 15.0678463,8.22395603 14.7964612,8.49696061 L11.6467109,11.6467109 L10.6597892,10.6597892 L13.3055794,8 L10.6597892,5.34021084 L11.6467109,4.35328907 Z M4.35328907,11.6467109 L1.20353875,8.48996116 C0.932153749,8.21695658 0.932153749,7.77604397 1.20353875,7.50303939 L4.35328907,4.35328907 L5.34021084,5.34021084 L2.69442057,8 L5.34021084,10.6597892 L4.35328907,11.6467109 Z M5.84417089,11.4997226 L8.67194674,4.50027742 L10.1838269,4.50027742 L7.35605105,11.4997226 L5.84417089,11.4997226 Z" id="Mask"></path></svg><span>Practice</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/scenarios/" class="l2 nav-icn"><span>Katacoda Scenarios</span></a></li><li><a href="https://learning.oreilly.com/interactive/#notebooks" class="l2 nav-icn"><span>Jupyter Notebooks</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="l1 nav-icn "><!--?xml version="1.0" encoding="UTF-8"?--><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M10.0440191,12.1582649 C10.177209,12.3351976 10.2476998,12.552011 10.2434767,12.7742985 L10.2434767,13.9482829 L1.96869684,13.9482829 L1.96869684,12.7742985 C1.96418597,12.536863 2.04491894,12.3056731 2.19625329,12.1226596 L2.20142503,12.1226596 C3.18373453,10.9898864 4.60930376,10.339179 6.10867266,10.339179 C7.30793519,10.339179 8.45998426,10.7554703 9.37576632,11.5017585 L14.3434936,11.5017585 L14.3434936,3.65650645 L1.65650645,3.65650645 L1.65650645,11.5017585 L2.06682298,11.5017585 L1.82063306,12.1582649 L1.32825322,12.1582649 C1.14771395,12.1582649 1,12.010551 1,11.8300117 L1,3.32825322 C1,3.14771395 1.14771395,3 1.32825322,3 L14.6717468,3 C14.852286,3 15,3.14771395 15,3.32825322 L15,11.8300117 C15,12.010551 14.852286,12.1582649 14.6717468,12.1582649 L10.0440191,12.1582649 Z M12.5483683,7.16419284 C12.6159362,7.20929881 12.6563112,7.2853432 12.6558247,7.36658194 C12.6553382,7.44782068 12.6140555,7.5233761 12.5459522,7.56766966 L10.4270949,8.91581376 C10.3903366,8.94010203 10.3431312,8.9419685 10.3045699,8.9206583 C10.2660086,8.89934811 10.2424712,8.85838696 10.2434767,8.81434055 L10.2434767,5.91510593 C10.2420711,5.86982855 10.2666257,5.82771857 10.3067229,5.80664182 C10.3468202,5.78556507 10.3954292,5.7892172 10.431927,5.81604875 L12.5483683,7.16419284 Z M6.10608679,9.81089299 C4.9635781,9.81089299 4.03739181,8.8847067 4.03739181,7.74219802 C4.03739181,6.59968933 4.9635781,5.67350304 6.10608679,5.67350304 C7.24859547,5.67350304 8.17478176,6.59968933 8.17478176,7.74219802 C8.17478176,8.8847067 7.24859547,9.81089299 6.10608679,9.81089299 Z"></path></svg><span>Sandboxes</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/scenarios/kubernetes-sandbox/9781492062820/" class="l2 nav-icn"><span>Kubernetes</span></a></li><li><a href="https://learning.oreilly.com/scenarios/python-sandbox/9781492062844/" class="l2 nav-icn"><span>Python</span></a></li><li><a href="https://learning.oreilly.com/scenarios/tensorflow-sandbox/9781492062851/" class="l2 nav-icn"><span>TensorFlow</span></a></li><li><a href="https://learning.oreilly.com/scenarios/ubuntu-sandbox/9781492062837/" class="l2 nav-icn"><span>Ubuntu</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="l1 nav-icn "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>queue icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 29.2C25.4 29.2 25.8 29.1 26.1 28.9L48.7 16.8C49.5 16.4 50 15.5 50 14.6 50 13.7 49.5 12.8 48.7 12.4L26.1 0.3C25.4-0.1 24.6-0.1 23.9 0.3L1.3 12.4C0.5 12.8 0 13.7 0 14.6 0 15.5 0.5 16.4 1.3 16.8L23.9 28.9C24.2 29.1 24.6 29.2 25 29.2ZM7.3 14.6L25 5.2 42.7 14.6 25 24 7.3 14.6ZM48.7 22.4L47.7 21.9 25 34.2 2.3 21.9 1.3 22.4C0.5 22.9 0 23.7 0 24.7 0 25.6 0.5 26.5 1.3 26.9L23.9 39.3C24.2 39.5 24.6 39.6 25 39.6 25.4 39.6 25.8 39.5 26.1 39.3L48.7 26.9C49.5 26.5 50 25.6 50 24.7 50 23.7 49.5 22.9 48.7 22.4ZM48.7 32.8L47.7 32.3 25 44.6 2.3 32.3 1.3 32.8C0.5 33.3 0 34.1 0 35.1 0 36 0.5 36.9 1.3 37.3L23.9 49.7C24.2 49.9 24.6 50 25 50 25.4 50 25.8 49.9 26.1 49.7L48.7 37.3C49.5 36.9 50 36 50 35.1 50 34.1 49.5 33.3 48.7 32.8Z"></path></g></svg><span>Explore</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/topics/" class="l2 nav-icn"><span>All Topics</span></a></li><li><a href="https://learning.oreilly.com/search/?query=&amp;extended_publisher_data=true&amp;highlight=true&amp;include_assessments=false&amp;include_case_studies=true&amp;include_courses=true&amp;include_orioles=true&amp;include_playlists=true&amp;include_collections=true&amp;include_notebooks=true&amp;is_academic_institution_account=false&amp;source=user&amp;formats=book&amp;formats=case%20study&amp;formats=learning%20path&amp;formats=live%20online%20training&amp;formats=notebook&amp;formats=oriole&amp;formats=video&amp;sort=popularity&amp;facet_json=true&amp;page=0&amp;collection_type=expert" class="l2 nav-icn"><span>Most Popular Titles</span></a></li><li><a href="https://learning.oreilly.com/r/" class="l2 nav-icn"><span>Recommendations</span></a></li><li><a href="https://learning.oreilly.com/search/?query=&amp;extended_publisher_data=true&amp;highlight=true&amp;include_assessments=false&amp;include_case_studies=true&amp;include_courses=true&amp;include_orioles=true&amp;include_playlists=true&amp;include_collections=true&amp;include_notebooks=true&amp;is_academic_institution_account=false&amp;source=user&amp;formats=book&amp;sort=publication_date&amp;facet_json=true&amp;page=0" class="l2 nav-icn"><span>Early Release</span></a></li><li><a href="https://learning.oreilly.com/playlists/discover/" class="l2 nav-icn"><span>Playlists</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M13.4 9.8a.6.6 0 0 1 .6.6v1.2h-1.2l-.6 2.4H3.8l-.6-2.4H2v-1.2a.6.6 0 0 1 .6-.6h10.8zM8 5.6a1.8 1.8 0 1 1-.001-3.599A1.8 1.8 0 0 1 8 5.6zm3.6 2.35v.95H4.4v-.95c0-.167.066-.33.19-.443A5.08 5.08 0 0 1 8 6.2a5.08 5.08 0 0 1 3.41 1.307c.124.113.19.276.19.444z"></path></svg><span>Attend</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/live-training/" class="l2 nav-icn"><span>Live Training</span></a></li></ul></li><li><a href="https://learning.oreilly.com/certifications/" class="l1 nav-icn "><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M12.912 9.18L14 8.014l-1.088-1.18a.304.304 0 01-.075-.268L13.195 5l-1.535-.463a.313.313 0 01-.194-.194l-.462-1.537-1.565.358c-.09.03-.194 0-.269-.074L8.007 2 6.845 3.09a.303.303 0 01-.269.074l-1.565-.358-.462 1.537a.313.313 0 01-.194.194L2.82 5l.358 1.567a.26.26 0 01-.075.269L2 8.015l1.088 1.164c.075.075.09.18.075.269l-.358 1.567 1.535.463c.09.03.164.104.194.194l.462 1.537 1.565-.358c.015 0 .045-.015.075-.015.075 0 .15.03.209.074L8.007 14l1.163-1.09a.303.303 0 01.269-.074l1.565.358.462-1.537a.313.313 0 01.194-.194L13.195 11l-.358-1.567a.338.338 0 01.075-.254zm-6.046 1.37L4.41 8.26l1.16-1.244 1.767 1.649L10.4 5.6l1.202 1.202-4.242 4.243-.495-.495z"></path></svg><span>Certifications</span></a></li><li><a href="https://get.oreilly.com/email-signup.html" class="l1 nav-icn " target="&quot;_blank&quot;"><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.564 2.263l2.172 2.174c.17.168.264.397.264.636V11a.6.6 0 0 1-.6.6h-.6V6.2h-6V2.6a.6.6 0 0 1 .6-.6h3.527c.239 0 .468.095.637.263zM2.6 14a.6.6 0 0 1-.6-.6V6.8a.6.6 0 0 1 .6-.6h1.903a1.2 1.2 0 0 1 .849.352L6.2 7.4H11a.6.6 0 0 1 .6.6v5.4a.6.6 0 0 1-.6.6H2.6zM11 5h1.8L11 3.2V5z"></path></svg><span>Newsletters</span></a></li><li><a href="https://learning.oreilly.com/u/preferences/" class="l1 nav-icn "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://learning.oreilly.com/public/support/" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M7.363 6.656a2.692 2.692 0 0 1-2.681-2.703c0-1.493 1.2-2.703 2.681-2.703a2.692 2.692 0 0 1 2.682 2.703c0 1.493-1.2 2.703-2.682 2.703zm4.023 2.027c-1.852 0-3.352 1.513-3.352 3.379H2v-1.534c-.006-.31.099-.612.295-.852a6.666 6.666 0 0 1 9.09-.993zm-.543.676h1.12v.304c.003.284.16.543.408.676a.766.766 0 0 0 .77 0l.303-.176.556.966-.302.176a.772.772 0 0 0-.362.676v.08a.772.772 0 0 0 .362.677l.302.21-.556.965-.302-.175a.766.766 0 0 0-.771 0 .778.778 0 0 0-.409.675v.352h-1.106v-.372a.778.778 0 0 0-.409-.676.766.766 0 0 0-.77 0l-.303.176-.556-.912.302-.176a.772.772 0 0 0 .362-.676v-.04-.04a.772.772 0 0 0-.362-.676l-.302-.176.556-.966.289.155a.766.766 0 0 0 .77 0 .778.778 0 0 0 .41-.676V9.36zm1.562 2.703c0-.271-.108-.531-.3-.722a1.001 1.001 0 0 0-.72-.292 1.01 1.01 0 0 0-.992 1.023 1.01 1.01 0 0 0 1.01 1.004 1.01 1.01 0 0 0 1.002-1.013z"></path></svg><span>Support</span></a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M2.613 12.63A.607.607 0 0 1 2 12.03V3.602C2 3.269 2.274 3 2.613 3h5.515v1.204H3.226v7.223h4.902v1.203H2.613zM5.677 9.02V6.611h4.903V4.926a.301.301 0 0 1 .19-.274.31.31 0 0 1 .33.063l2.722 2.673a.594.594 0 0 1 0 .849L11.1 10.909a.31.31 0 0 1-.331.063.301.301 0 0 1-.19-.274V9.02H5.677z"></path></svg><span>Sign Out</span></a></li></ul></div></li></ul></nav></header>



      </div>
      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Securing the Perimeter: Deploying Identity and Access Management with Free Open Source Software
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" title="Search in archive" class="js-search-controls search-controls" onclick="window.Appcues.track(&#39;SearchBook_HeronBook&#39;)"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781484226018/chapter/html/425975_1_En_4_Chapter.xhtml"><div class="js-collections-dropdown collections-dropdown menu-bit-cards" onclick="window.Appcues.track(&#39;AddPlaylist_HeronBook&#39;)"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size" onclick="window.Appcues.track(&#39;ChangeFont_HeronBook&#39;)"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="trigger" data-push-state="false" title="Share" aria-label="Share" onclick="window.Appcues.track(&#39;Share_HeronBook&#39;)"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml&amp;text=Securing%20the%20Perimeter%3A%20Deploying%20Identity%20and%20Access%20Management%20with%20Free%20Open%20Source%20Software&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%204.%C2%A0OAuth&amp;body=https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml%0D%0Afrom%20Securing%20the%20Perimeter%3A%20Deploying%20Identity%20and%20Access%20Management%20with%20Free%20Open%20Source%20Software%0D%0A"><span>Email</span></a></li></ul></li>
      </ul>
    </div>

    
    <section role="document">
        
        




  <script defer="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/djangoMessagesPage.61a28d591d16.js"></script>


        <script src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/48743.js"></script>
<script>
  var userId = "6866040";

  var userObject = {
    firstName: "MACKYNZIE",
    segment: "Trial",
    admin: "False",
    profileCreatedOn: "April 4, 2020, 9:28 a.m.",
    academic: ""
  };
  window.Appcues.identify(userId, userObject);
  window.Appcues.page();

  setTimeout(function () {
    window.Appcues.track('ViewingBook_HeronBook')
  }, 20000);
</script>


	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_3_Chapter.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">3.&nbsp;SAML</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_5_Chapter.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">5.&nbsp;OpenID Connect</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content" style="transform: none;"><div class="annotator-wrapper"><div class="ChapterContextInformation"><div class="ContextInformation" id="b978-1-4842-2601-8_4"><div class="ChapterCopyright">©&nbsp;Michael Schwartz, Maciej Machulak&nbsp;2018</div><span class="ContextInformationAuthorEditorNames"><span class="Author"><span class="AuthorName">Michael&nbsp;Schwartz</span> and </span><span class="Author"><span class="AuthorName">Maciej&nbsp;Machulak</span></span></span><span class="ContextInformationBookTitles"><span class="BookTitle" epub:type="title" lang="en">Securing the Perimeter</span></span><span class="ChapterDOI"><a href="https://doi.org/10.1007/978-1-4842-2601-8_4">https://doi.org/10.1007/978-1-4842-2601-8_4</a></span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" lang="en">4.&nbsp;OAuth</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">Michael&nbsp;Schwartz</span><sup><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Aff3" class="totri-footnote">1</a>&nbsp;<span class="ContactIcon"></span></sup> and </span><span class="Author"><span class="AuthorName">Maciej&nbsp;Machulak</span><sup><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Aff4" class="totri-footnote">2</a></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff3"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">Austin, TX, USA</div></div><div class="Affiliation" id="Aff4"><span class="AffiliationNumber">(2)</span><div class="AffiliationText">London, UK</div></div><div class="ClearBoth">&nbsp;</div></div></div><!--End Abstract--><div class="Fulltext"><p class="Para" id="Par2">OAuth 2.0 (or simply as “OAuth” because OAuth 1.0 is now irrelevant) defines a <span id="ITerm1">mechanism</span> for using bearer tokens to make authorized HTTP requests. Simple possession of a bearer token enables access. For example, a long time ago in New York City, if you had a “subway token,” you inserted it into the turnstile and entered the subway station. No questions asked—you have the token, you get in. Bearer tokens are also called “access tokens”.</p><div class="Para" id="Par3">Although OAuth is known primarily as a technology for <span id="ITerm2">consumer applications</span>, its popularity is expanding in enterprise IAM. A common misperception is that OAuth is a protocol. More accurately, it is a framework for authorization—a set of foundational patterns and vocabulary. OAuth is not an authentication protocol. If this were true, OAuth would need to provide specific details, like how messages are sent, the exact data structure of those messages, and how message integrity is assured. Vittorio Bertocci made an apt analogy in one of his <span id="ITerm3">Microsoft blogs</span> for Microsoft<sup><a epub:type="noteref" href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fn1" id="Fn1_source" class="totri-footnote">1</a></sup>:<blockquote class="BlockQuote"><p class="Para" id="Par5">
              <em class="EmphasisTypeItalic ">OAuth 2.0 as a building block for implementing a sign-in flow is not only perfectly possible, but quite handy too: a LOT of web applications take advantage of that, and it works great. But that does NOT mean that OAuth is an authentication protocol, with all the affordances you’ve come to expect from one, as much as using chocolate to make fudge does not make (chocolate == fudge) true.</em>
            </p></blockquote></div><p class="Para" id="Par6">Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_5_Chapter.xhtml" class="totri-footnote"><span class="RefSource">5</span></a></span> focuses on a protocol that uses OAuth to define a sign in flow—OpenID Connect. Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_8_Chapter.xhtml" class="totri-footnote"><span class="RefSource">8</span></a></span> focuses on another OAuth protocol used for API access Management—UMA. But in this chapter, we introduce some of the common OAuth terminology and ideas that to give you some background for what’s to come.</p><section class="Section1 RenderAsSection1" id="Sec1"><h2 class="Heading">Scopes</h2><p class="Para" id="Par7"><span id="ITerm4">Scopes</span> are used to specify the extent of access for a token. Think of an airplane boarding pass. Airlines scan your boarding pass before they let you enter the plane. If the agent sees a green light, they let you pass—real-world token validation! On some airlines, not all boarding passes are the same. You might prefer a boarding pass that entitles you to sit in first class. Or your boarding pass may qualify you for a specific seat assignment. You can think of scopes as these additional constraints. For example, a resource server may offer many APIs. The authorization server may use scopes to differentiate which APIs you can access. Even within an API, certain features may not be available unless you have a token with the right scope.</p><div class="Para" id="Par8">Scopes may be any string value, but it’s a common practice to use a URI for scopes. The advantage of this practice is that scopes will be less likely to collide. For example, many developers in an organization may want to use a scope called “write”. If each developer uses a different URI namespace for their “write” scope, they will be unique. Google publishes a list of all their APIs and which scopes are required in order to call them. A small excerpt is shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig1">4-1</a></span>.<figure class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig1_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig1_HTML.jpg" style="height:27.98em" width="1713" height="1119" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig1_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-1</span><p class="SimplePara">Some Google OAuth <span id="ITerm5">scopes</span></p></div></figcaption></figure></div><p class="Para" id="Par9">According to Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig1">4-1</a></span>, if you want to call a Google API that allows you to “view and manage your data in Google BigQuery,” you’ll need a token with the scope <span class="ExternalRef"><a href="https://www.googleapis.com/auth/bigquery"><span class="RefSource">
                <span class="EmphasisFontCategoryNonProportional ">https://www.googleapis.com/auth/bigquery</span>
              </span></a></span>. Using this approach, Google uses scopes to manage which clients can access which features of their service. Google follows the convention of using URIs for scope values. You may also notice that the APIs are versioned. If an API is updated, new features may be introduced, which may require different scopes. Client developers rely on these scopes and need to know about them before they write their code.</p></section><section class="Section1 RenderAsSection1" id="Sec2"><h2 class="Heading">OAuth Roles</h2><div class="Para" id="Par10">You’ll sometimes hear OAuth referred to as “three-legged”. Those legs are the “client,” “resource server,” and “authorization server”. The client is the software (website or mobile application) that is either requesting a protected resource or connected to a person requesting a protected web resource. The resource server is the software that has web content that needs protecting, API endpoints for example. The authorization server is the software that issues tokens to a client. Another way to think about OAuth is that the resource server is the policy enforcement point (PEP), and the authorization server is the policy decision point (PDP). Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig2">4-2</a></span> shows the three legs, as well as the people who interact with them.<figure class="Figure" id="Fig2"><div class="MediaObject" id="MO2"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig2_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig2_HTML.jpg" style="height:28.25em" width="1719" height="1130" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig2_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-2</span><p class="SimplePara">OAuth <span id="ITerm6">roles</span></p></div></figcaption></figure></div><section class="Section2 RenderAsSection2" id="Sec3"><h3 class="Heading">Authorization Server</h3><p class="Para" id="Par11">The authorization server is the most complex component of an OAuth infrastructure. For some deployments, the authorization server and the resource <span id="ITerm7">server</span> may be one software process. For larger deployments, a centralized, single-purpose authorization server may issue tokens to control access to a distributed network of resource servers. The authorization server holds <span id="ITerm8">client credentials</span>—for example, an API key and secret for each client. Client credentials are important, because they enable an organization to provision specific permissions for a client. Don’t confuse client credentials with a person’s credentials (i.e., username and password). Person authentication is a very different requirement from client authentication. People are messy analog carbon-based things. Clients are software. There are fewer options to authenticate clients than people.</p><div class="Para" id="Par12">In some flows, the authorization server may also need to authenticate a person, who then directly authorizes a client. For example, if you’ve used Google login from a third-party website, after authenticating (unless you are already logged into Google) you are presented with a dialog asking you to authorize this client to call an API that will release information about you, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig3">4-3</a></span>.<figure class="Figure" id="Fig3"><div class="MediaObject" id="MO3"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig3_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig3_HTML.jpg" style="height:34.12em" width="1418" height="1365" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig3_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-3</span><p class="SimplePara">GA sample Google authorization <span id="ITerm9">dialog</span></p></div></figcaption></figure></div><p class="Para" id="Par13">A quick aside—one important thing to note is that in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig3">4-3</a></span>, you can see the <span id="ITerm10">URL</span> of the authorization server—<span class="ExternalRef"><a href="https://accounts.google.com/"><span class="RefSource">
                  <span class="EmphasisFontCategoryNonProportional ">https://accounts.google.com</span>
                </span></a></span>. This is especially important when you are entering your credentials. You should never share your password with a <span id="ITerm11">third-party website</span>, and you should always make sure that the certificates are valid. Most modern browsers will help you out here. If the little lock icon in the address bar is not green, be concerned. Even if it is green, you may not be safe—check the hostname and make sure it’s one that you trust (easier said than done, for sure...) This pattern should remind you of SAML, where you are redirected to the IDP to enter your credentials. An OAuth based flow adds an extra step for authorization.</p><p class="Para" id="Par14">Getting back to OAuth roles, the <span id="ITerm12">resource owner</span> is the person who is responsible for making the authorization decision. When you use Google login at a third-party site, you are the resource owner—you control access to your information. In an enterprise IAM setting, the resource owner is the organization that manages the RS and AS. For example, an organization may make policies about which people, or which partners may access a certain API or website.</p><p class="Para" id="Par15">The other two people (not software components) in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig2">4-2</a></span> are the developer and the requesting <span id="ITerm13">party</span>. Developers are active participants in the OAuth infrastructure because they obtain client credentials that are used in their software. The requesting party is the person who is using a software client to access a protected resource. The requesting party is optional. A machine-to-machine API does not require a requesting party.</p><p class="Para" id="Par16">The primary job of the authorization server is to evaluate <span id="ITerm14">policies</span> that enable it to issue tokens. To accomplish this, clients and resource servers interact with APIs (or endpoints) published by the authorization server. Two endpoints defined by the OAuth RFC are the authorization and token endpoints. The authorization endpoint is where a client sends a person using a browser to interact with an authorization server. The token endpoint is used only by OAuth clients to obtain or refresh a bearer token. For example, using the Google sign-in flow again as an example, the first redirect to the authorization endpoint displays a dialog, such as the one shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig3">4-3</a></span>. If you authorize the request, the client will call the token endpoint next to obtain an access token, with which it can call an API on a resource server.</p><p class="Para" id="Par17">The authorization server may publish other OAuth endpoints, depending on what profiles of OAuth it implements. Like LDAP and SAML, OAuth is defined by several related standards. An authorization server may implement some <span id="ITerm15">optional interfaces</span> for client registration, token introspection (a way to obtain information about a particular token) or discovery information (similar to SAML metadata).</p></section><section class="Section2 RenderAsSection2" id="Sec4"><h3 class="Heading">Resource Server</h3><p class="Para" id="Par18">The resource <span id="ITerm16">server</span><span id="ITerm17">
                
                
              </span>, acting as the policy enforcement point, plays a critical role in the security of the OAuth infrastructure. Its job is to make sure a valid token is present—that the token is not expired and that it has been authorized for the correct scopes. The resource server will also need to understand how to use the various types of tokens. In some cases, the resource server must itself call APIs of the authorization server—to validate a token, for example.</p><p class="Para" id="Par19">The resource server will want to minimize external calls and the processing time to decrypt tokens. For this reason, many resource server implementations cache tokens to expedite subsequent authorization for the same token value.</p><p class="Para" id="Par20">The developer who writes a resource server will have to coordinate with the administrators of the authorization server regarding what policies are in place to issue tokens for certain scopes. Sometimes the same group controls both the authorization server and resource servers. In other cases, the authorization server might be in control of the central access management team. This is the reason that Google publishes the scopes that are required to call its APIs, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig1">4-1</a></span>.</p><p class="Para" id="Par21">The resource server will have to decide which policies to delegate to the authorization server. “The user has approved access” is the most common policy for consumer OAuth applications. But using UMA, a protocol that builds on OAuth (the topic of Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_8_Chapter.xhtml" class="totri-footnote"><span class="RefSource">8</span></a></span>), you can map scopes to enterprise access policies.</p><p class="Para" id="Par22">Centralized policy <span id="ITerm18">management</span><span id="ITerm19">
                
                
              </span> is a useful approach but it’s not a silver bullet. In general, centralized policy management works well for coarse-grain authorization, but not for fine-grain authorization. In a web application, what to display on a certain page is normally controlled by “fine-grained” permissions. Coarse-grained policies are shared across more than one application. For example, what type of authentication is required, which internal roles can access which types of applications, which software clients to trust—implementing these policies in every application would lead to code duplication.</p></section><section class="Section2 RenderAsSection2" id="Sec5"><h3 class="Heading">Client</h3><p class="Para" id="Par23">An OAuth <span id="ITerm20">client</span> is the software that calls the protected resource. It is frequently connected to a person—the requesting party. The client obtains a token from the authorization server and presents it to the resource server. In many cases, it’s the job of the client developer to obtain client credentials at the authorization server and to know what scopes are needed to access the resource server. The client may need to process a redirect to enable the requesting party to interact with the authorization server. The client may also need to handle errors that are returned by either the authorization server or the resource server.</p><p class="Para" id="Par24">Clients may be a website or native application. In some cases, the client may even be a JavaScript application that exists entirely in the person’s browser. It’s important to remember that the client is not the same as the browser. The browser is software that the requesting party uses to access the Internet. SAML jargon “user agent” applies here too. The client is software that is between the browser and the protected resource.</p><p class="Para" id="Par25">In machine-to-machine transactions, where there is no requesting party, the policies must apply only to information about the client and the context of the transaction. For example, is this client (authenticated with a client_id and secret), calling from this network, during this time of day, authorized to obtain a token for certain scopes? A certain group of clients may be associated with a certain partner or category of applications—such information about the client is called a “client claim” and is different from user claims about the requesting <span id="ITerm21">party</span>.</p></section></section><section class="Section1 RenderAsSection1" id="Sec6"><h2 class="Heading">Tokens</h2><p class="Para" id="Par26">A <span id="ITerm22">token</span> is an abstraction that represents permission by the authorization server to do something. An <span id="ITerm23">access</span> token is a short-lived token that is obtained by the client. A refresh token is a long-lived token that is presented by the client to the authorization server in exchange for a new access token. “Short-lived” means one hour or less, but actual times may vary depending on the policy of the authorization server. One to five minutes are common lengths for the lifetime of an access token.</p><p class="Para" id="Par27">The authorization server decides what type of token to return. Each access token type definition specifies the additional attributes (if any) sent to the client along with the access token. The client should not use a token if it does not understand the token type. Each token has a different security profile and is useful for different use cases. Long strings are frequently used as bearer tokens. OAuth provides a mechanism where <span id="ITerm24">additional</span> token types can be registered as extensions. JSON Web Tokens (JWTs)—pronounced “jots”—are popular, and are sometimes used as the bearer token string. There is also an extension for something called “MAC” tokens. These are tokens that enable the client to protect the access token value and are useful for non-secure communication channels. However, due to the widespread use of TLS for OAuth, MAC <span id="ITerm25">tokens</span><span id="ITerm26">
              
            </span> aren’t used that much in enterprise deployments, so we’ll skip discussion of these tokens.</p><section class="Section2 RenderAsSection2" id="Sec7"><h3 class="Heading">Bearer Tokens</h3><p class="Para" id="Par28">RFC 6570, “URI Template,” describes <span id="ITerm27">bearer</span><span id="ITerm28">
                
              </span> token usage in OAuth. A bearer token is any data structure that gives the possessor rights to do something—without requiring the owner of the token to verify control of a cryptographic key. A bearer token can be a string of sufficient entropy to make guessing unlikely.</p><p class="Para" id="Par29">It can also be an XML or JSON document encoded appropriately. OAuth relies heavily on bearer tokens, but SAML IDPs also commonly use them—i.e., signed SAML assertions. It is imperative to the security of any access management infrastructure based on bearer tokens to prevent an attacker from gaining possession of the token during transmission, in memory, or on the disk. If this happens, game over! The resource server has no way to distinguish the attacker from the authorized token owner!</p><div class="Para" id="Par30">Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC1">4-1</a></span> is a simple example of an OAuth bearer token returned from an authorization server.<div class="ProgramCode" id="PC1"><div class="LineGroup"><div class="FixedLine">HTTP/1.1 200 OK</div><div class="FixedLine">Content-Type: application/json;charset=UTF-8</div><div class="FixedLine">Cache-Control: no-store</div><div class="FixedLine">Pragma: no-cache</div><div class="FixedLine">{</div><div class="FixedLine">"access_token": "41902768-ae84-4a1c-8e62-566a8605b90f",</div><div class="FixedLine">"token_type": "Bearer",</div><div class="FixedLine">"expires_in": 3600,</div><div class="FixedLine">"refresh_token": "d1d50489-98ac-4d21-9ddb-2358caf835c3"</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-1</span><p class="SimplePara">OAuth Token Endpoint Response</p></div></div></div></div><div class="Para" id="Par31">The most common way for a client to send a bearer token to the resource server is to include the token in the Authorization header field, although RFC 6570 also defines mechanisms to send the access token as an HTML form encoded body parameter or in the URI (which is a bad idea). Using the header, the bearer token would look like this:<div class="ProgramCode" id="PC2"><div class="LineGroup"><div class="FixedLine">Authorization: Bearer 41902768-ae84-4a1c-8e62-566a8605b90f</div></div></div></div><div class="Para" id="Par32">In simple OAuth <span id="ITerm29">implementations</span><span id="ITerm30">
                
              </span>, where the resource server and authorization server are the same, the resource server might make a query to the local database to retrieve information about a bearer token—for example, when does it expire or for what scopes was it authorized? If the authorization server is remote, RFC 7662 defines an API for “token introspection”. This provides a mechanism for the resource server to retrieve a JSON object from the authorization server that describes the token. Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC3">4-2</a></span> is an example from RFC 7662 of a response to the introspection API.<div class="ProgramCode" id="PC3"><div class="LineGroup"><div class="FixedLine">HTTP/1.1 200 OK</div><div class="FixedLine">Content-Type: application/json</div></div><div class="LineGroup"><div class="FixedLine">{</div><div class="FixedLine">&nbsp;"active": true,</div><div class="FixedLine">&nbsp;"client_id": "l238j323ds-23ij4",</div><div class="FixedLine">&nbsp;"username": "jdoe",</div><div class="FixedLine">&nbsp;"scope": "read write dolphin",</div><div class="FixedLine">&nbsp;"sub": "Z5O3upPC88QrAjx00dis",</div><div class="FixedLine">&nbsp;"aud": "https://protected.example.net/resource",</div><div class="FixedLine">&nbsp;"iss": "https://server.example.com/",</div><div class="FixedLine">&nbsp;"exp": 1419356238,</div><div class="FixedLine">&nbsp;"iat": 1419350238,</div><div class="FixedLine">&nbsp;"extension_field": "twenty-seven"</div><div class="FixedLine">}<span id="ITerm31">
                      
                      
                    </span><span id="ITerm32">
                      
                    </span></div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-2</span><p class="SimplePara">Sample OAuth Token Introspsection Response</p></div></div></div></div></section><section class="Section2 RenderAsSection2" id="Sec8"><h3 class="Heading">JSON Web Token (JWT)</h3><p class="Para" id="Par33">Defined in RFC 7519, the JWT <span id="ITerm33">token</span> type is essentially a compact syntax to send an optionally signed and encrypted JSON object. It’s surprisingly compact on the wire—you may even be able to send it as a query parameter. The token can contain user claims and can eliminate the need for token introspection. JWT tokens are also particularly <span id="ITerm34">advantageous </span> in stateless web architectures. Another application for JWT is where cookies can’t be used, for example, due to restrictions on writing third-party cookies.</p><div class="Para" id="Par34">JSON Web Tokens consist of three sections, separated by two periods:<div class="ProgramCode" id="PC4"><div class="LineGroup"><div class="FixedLine">Header.Payload.Signature</div></div></div></div><p class="Para" id="Par35">The <span id="ITerm35">header</span> describes the <span id="ITerm36">cryptographic algorithms </span> used for signing and encryption, for example: <span class="EmphasisFontCategoryNonProportional ">{"alg": "RS256"}</span>. If you want to know the meaning of “RS256,” you need to check RFC 7518, which describes JSON web algorithms. If you don’t want to use any encryption or signing in your JWT, you can use <span class="EmphasisFontCategoryNonProportional ">{"alg":"none"}</span>. In this case, there would be no text after the second period—you’d just have a header and payload. The header may also be used to send unencrypted claims. Note that the value of any substantive unencrypted claims should be verified against the signed JSON payload.</p><p class="Para" id="Par36">The JSON <span id="ITerm37">payload </span> portion of the token may have three types of claims: reserved, public, and private. The reserved claims are the ones defined in the OAuth specifications, such as <span class="EmphasisFontCategoryNonProportional ">iss</span> (issuer), <span class="EmphasisFontCategoryNonProportional ">exp</span> (expiration time), <span class="EmphasisFontCategoryNonProportional ">sub</span> (subject), and <span class="EmphasisFontCategoryNonProportional ">aud</span> (audience). Public claims are registered at the IANA JSON Web Token Registry or are collision-resistant URIs. Private claims are ad hoc claims agreed upon by the organizations using them.</p><p class="Para" id="Par37">Validation of the <span id="ITerm38">signature</span> is too complex for treatment here. The token can be encrypted, signed, signed and encrypted, or encrypted and signed. If encrypted, the client would have to previously register its public key with the authorization server. For signing, public keys of the authorization server are frequently provided on a URL for download. OAuth supports many different signing and encryption algorithms. As mentioned, check RFC 7518 for a full list. Then, check to make sure these are supported on the authorization server.</p><section class="Section3 RenderAsSection3" id="Sec9"><h4 class="Heading">Proof-of-Possession Tokens</h4><p class="Para" id="Par38">A <span id="ITerm39">proof-of-possession token</span>, also called a holder-of-key (HoK) <span id="ITerm40">token</span><span id="ITerm41">
                  
                </span>, requires control of a cryptographic key to provide additional evidence that the presenter of the token is the party to whom the token was issued. This approach mitigates the risk of stolen tokens. RFC 7800 introduces how to declare in a JWT that the presenter of the JWT possesses a particular proof-of-possession private key and how the recipient can cryptographically confirm this. Thus, a JWT can be either a bearer token or a proof-of-possession token.</p></section><section class="Section3 RenderAsSection3" id="Sec10"><h4 class="Heading">Token Binding</h4><p class="Para" id="Par39">Token <span id="ITerm42">binding</span> is an advanced topic that is still under development, and whose future is not 100% certain, as adoption by websites and browsers has been slow. The Google team has even discussed the possibility of dropping support for it, although hopefully they’ll keep the feature. The idea is for the browser to generate a public key, private key, and an identifier (Token Binding Key) for TLS connections to a web server. These keys and identifiers are long-lived. When a connection is made between the browser and website, the identifier can be remembered at the website. When issuing a security token (e.g., an HTTP cookie or an OAuth token) to a client, the server can include the Token Binding ID in the token, thus cryptographically binding the token to TLS connections between that client and server, as well as inoculating the token against abuse (re-use, attempted impersonation, etc.) by attackers. This would protect the token from man-in-the-middle, token export, and replay attacks.</p><p class="Para" id="Par40">In a typical OAuth session, there are several TLS connections: between the browser and AS, between the browser and RS, between the client and AS, and even between the RS and AS. There are several opportunities to use token binding to improve security. The initial work addresses how to protect OAuth access tokens and refresh tokens for TLS connections between the client and AS.</p><p class="Para" id="Par41">Token <span id="ITerm43">binding</span> could be a useful tool to prevent man-in-the-middle attacks, and its use has been proposed for banking and financial services profiles. An alternative to token binding is mutual TLS, for which another OAuth draft is under development.</p></section></section><section class="Section2 RenderAsSection2" id="Sec11"><h3 class="Heading">Registration</h3><p class="Para" id="Par42">The authorization server needs to know information about each client before it can issue the client a token. This is similar to SAML, where the IDP needs to configure trust for each SP. What is new in <span id="ITerm44">OAuth</span><span id="ITerm45">
                
                
              </span> is a standardized option for self-service registration. In SAML, the IDP administrator generally imports the SP’s metadata or configures information about the SP. This is usually a manual process, although sometimes a website may create a proprietary process for self-provisioning. OAuth registration defines standards for client provisioning. During registration, the client is issued a client identifier. At a minimum, the client must tell the AS the URIs where it is okay to send users after the AS has finished its interaction—the redirect_uris. This is important because the AS should never redirect a person’s browser to a URI that has not been previously registered. If the redirect_uri is a web address, it must always use the https scheme, and the AS must validate the TLS certificate or certificate keychain. Frequently, the authorization collects other information about the client such as a name, an icon, a URL of the home page, a link to the privacy policy, and a brief description of the application. The client may also register an asymmetric client secret. Client <span id="ITerm46">registration</span><span id="ITerm47">
                
                
              </span> is also an appropriate time for the client to notify the AS about its preferences. What types of cryptographic algorithms are preferred? What scopes are requested? What are the default user authentication mechanisms desired? All this information may be provided during registration.</p><div class="Para" id="Par43">Although the API and vocabulary for registration can align to OAuth standards, the business process may still vary. The developer may need to complete a form, sign a legal agreement, or provide various pieces of information about their organization. Sometimes, the client credentials are automatically created and available for use. For example, the OpenID Connect profile of OAuth defines an API that enables a client developer to automatically register. Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig4">4-4</a></span> shows Google’s very minimal client registration page<figure class="Figure" id="Fig4"><div class="MediaObject" id="MO4"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig4_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig4_HTML.jpg" style="height:37.85em" width="1718" height="1514" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig4_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-4</span><p class="SimplePara">Google client registration <span id="ITerm48">form</span><span id="ITerm49">
                        
                        
                      </span></p></div></figcaption></figure></div><p class="Para" id="Par44">RFC 7591 defines common conventions around dynamic client registration, including client metadata fields and details about the client registration endpoint. Also discussed is registration with software statements.</p><div class="Para" id="Par45">It is required that the AS return the client_id in the registration response (see Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC5">4-3</a></span>). A client_secret is also frequently returned. Aaron Parecki lists some common OAuth client_ids on his informative site, <span class="ExternalRef"><a href="http://oauth.com/"><span class="RefSource">
                  <span class="EmphasisFontCategoryNonProportional ">http://oauth.com</span>
                </span></a></span>.<div class="ProgramCode" id="PC5"><div class="LineGroup"><div class="FixedLine">Foursquare: ZYDPLLBWSK3MVQJSIYHB1OR2JXCY0X2C5UJ2QAR2MAAIT5Q</div><div class="FixedLine">Github: 6779ef20e75817b79602</div><div class="FixedLine">Google: 292085223830.apps.googleusercontent.com</div><div class="FixedLine">Instagram: f2a1ed52710d4533bde25be6da03b6e3</div><div class="FixedLine">SoundCloud: 269d98e4922fb3895e9ae2108cbb5064</div><div class="FixedLine">Windows Live: 00000000400ECB04</div><div class="FixedLine">Gluu: @!AA77.E41E.1889.6F5E!0001!09FB.4FBB!0008!3CDC.3AF4</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-3</span><p class="SimplePara">Sample client_id Values from Popular Consumer IDPs</p></div></div></div></div><p class="Para" id="Par46">The combined client_id and client_secret should be stronger than a person’s username and password. In the security considerations section of the core OAuth authorization framework section, guidelines are given to prevent credential-guessing attacks for the size of access tokens, authorization codes, refresh tokens, resource owner <span id="ITerm50">passwords</span><span id="ITerm51">
                
                
              </span>, and client credentials. It states:</p><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar1"><h3 class="Heading">Note</h3><p class="Para" id="Par47">The probability of an attacker guessing generated tokens (and other credentials not intended for handling by end-users) MUST be less than or equal to 2^(-128) and SHOULD be less than or equal to 2^(-160).</p></div><p class="Para" id="Par48">If you have trouble computing those huge numbers, it’s about 1 in 340 undecillion to 1.5 quindecillion (give or take a few billion). That’s a number with 38-48 zeros at the end. How you can accomplish this is beyond my mathematical capabilities. See Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC5">4-3</a></span> for some good examples.</p></section></section><section class="Section1 RenderAsSection1" id="Sec12"><h2 class="Heading">Grants</h2><div class="Para" id="Par49">The process or method by which a client obtains an access token is called an <span id="ITerm52">authorization</span> grant<span id="ITerm53">
              
              
              
            </span>. The grant represents a permission for the client to access an API endpoint. Each type of authorization grant has a different flow with its own security characteristics. Following is a description of the different grants, and when their use is appropriate. Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig5">4-5</a></span> presents a flowchart to help explain when you use each grant type.<figure class="Figure" id="Fig5"><div class="MediaObject" id="MO5"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig5_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig5_HTML.jpg" style="height:36.05em" width="1717" height="1442" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig5_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-5</span><p class="SimplePara">Grant <span id="ITerm54">type</span> flowchart</p></div></figcaption></figure></div><section class="Section2 RenderAsSection2" id="Sec13"><h3 class="Heading">Authorization Code Grant</h3><p class="Para" id="Par50">This flow, for web-based client <span id="ITerm55">applications</span><span id="ITerm56">
                
              </span>, uses a “code” (a guess resistant string) to represent a person’s delegation to the client. The code is returned to the person’s browser and is forwarded to the client, who exchanges it (with client credentials) for a token or tokens. The code can only be used once, which reduces the risk of it leaking. Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig6">4-6</a></span> provides a sequence diagram for a common use case for the authorization code grant—how it can be used as the basis for a login flow.</p><div class="Para" id="Par51">Like SAML, this grant uses browser redirects to enable a person to interact with a central security server. In Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig6">4-6</a></span>, the login form and the authorization form might confuse you—what’s the difference? The login form is where the person enters their username and password or uses another authentication technology (e.g., token or biometric). The person uses the authorization form to approve some action. Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig3">4-3</a></span> shows an authorization where the person authorizes the release of information to a third party. Before enabling you to authorize, the AS may need to authenticate who you are, then it can enable you to authorize something.<figure class="Figure" id="Fig6"><div class="MediaObject" id="MO6"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig6_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig6_HTML.jpg" style="height:29.48em" width="2321" height="1179" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig6_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-6</span><p class="SimplePara">Sequence diagram for an <span id="ITerm57">authorization code grant</span><span id="ITerm58">
                        
                      </span> based login flow</p></div></figcaption></figure></div><p class="Para" id="Par52">It’s important that the code be protected and that it’s sufficiently long to prevent guessing. However, because the code is passed through the browser, it’s still susceptible to interception by existing malware. If additional security is needed, there is an extra security step that can be implemented called Proof Key for Code Exchange (PKCE, pronounced “pixy”) by OAuth public clients, described in RFC 7636. Using this mitigation technique, the client adds a nonce to the authorization request. If the code is intercepted, without this extra nonce, it cannot be exchanged for a <span id="ITerm59">token</span><span id="ITerm60">
                
              </span>.</p></section><section class="Section2 RenderAsSection2" id="Sec14"><h3 class="Heading">Implicit Grant</h3><p class="Para" id="Par53">JavaScript client applications have become very popular and powerful. Sometimes these applications act as OAuth clients. This presents an interesting security challenge because the client is contained in the browser, so there is no point using an authorization code to hide the token—the browser will end up seeing it anyway when it executes the JavaScript! Another consideration is that only front-channel communication can be used—the AS has no direct way to communicate with the client (back-channel).</p><p class="Para" id="Par54">The Implicit <span id="ITerm61">Grant</span><span id="ITerm62">
                
              </span> was designed to accommodate this use case. It enables a JavaScript client to request an access token without a client secret, directly from the authorization URI. For this reason, the Implicit Grant has less security protection. The redirect_uri requested by the client is preregistered with the AS (as normal), which is the main security mechanism. It’s also worth noting that the client cannot obtain a refresh token using this flow (because the client cannot call the token endpoint, which requires client authentication).</p><div class="Para" id="Par55">Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig7">4-7</a></span> provides a sample sequence diagram for an Implicit Grant based login flow. When the access token is returned by the server, it is appended to the redirect_uri as a fragment. It might look something like this:<div class="ProgramCode" id="PC6"><div class="LineGroup"><div class="FixedLine">GET /client-callback#access_token=8027ad39-9316-49d5-9b3b-10cce3e9b02d&amp;token_type=Bearer HTTP/1.1</div></div></div><figure class="Figure" id="Fig7"><div class="MediaObject" id="MO7"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig7_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig7_HTML.jpg" style="height:28.92em" width="2323" height="1157" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig7_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-7</span><p class="SimplePara">Sequence diagram for an implicit grant-based login <span id="ITerm63">flow</span><span id="ITerm64">
                        
                      </span></p></div></figcaption></figure></div></section><section class="Section2 RenderAsSection2" id="Sec15"><h3 class="Heading">Resource Owner Password Credential Grant</h3><div class="Para" id="Par56">Can’t you just validate username/password credentials at the authorization server, like you can with an LDAP BIND operation? The <span id="ITerm65">Resource Owner Password Credential Grant</span><span id="ITerm66">
                
                
              </span> lets a client do just that, posting both client credentials and the person’s credentials at the token endpoint to obtain an access token. One disadvantage of this grant is that all communication is performed on the back channel by the client, so the authorization server will not be able to write any cookie or session information in the browser (defeating many single sign-on implementations). Of course, the biggest disadvantage of this flow is that the client sees the person’s password. This flow should be vehemently discouraged—it is the OAuth anti-pattern. It should only be used where there is a supreme amount of trust in the client. And even then, the client developers should be encouraged to use either the Authorization Code Flow (for web or mobile applications) or implicit flow (for JavaScript client applications). Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC7">4-4</a></span> shows a sample request (with client credentials sent as Basic).<div class="ProgramCode" id="PC7"><div class="LineGroup"><div class="FixedLine">POST /token</div><div class="FixedLine">&nbsp;&nbsp;Host: trusted_client.example.local</div><div class="FixedLine">&nbsp;&nbsp;Accept: application/json</div><div class="FixedLine">&nbsp;&nbsp;Content-type: application/x-www-form-encoded</div><div class="FixedLine">&nbsp;&nbsp;Authorization: Basic 32c0992ae4194701a12dc7440d513d45</div><div class="FixedLine">&nbsp;&nbsp;grant_type=password&amp;username=foo&amp;password=spam&amp;scope=uid</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-4</span><p class="SimplePara">Sample <span id="ITerm67">Resource Owner Password Credential Grant</span><span id="ITerm68">
                        
                        
                      </span> Request</p></div></div></div></div></section><section class="Section2 RenderAsSection2" id="Sec16"><h3 class="Heading">Client Credential Grant</h3><div class="Para" id="Par57">Probably the simplest grant <span id="ITerm69">type</span>, the client gains an access token by just providing its own credentials. It’s a useful grant type for <span id="ITerm70">machine-to-machine use cases</span> where there is no person associated with an API request. It’s so simple, I’ll just show the sample request and response from <span id="ITerm71">RFC 6749</span> (see Listings <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC8">4-5</a></span> and <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC9">4-6</a></span>).<div class="ProgramCode" id="PC8"><div class="LineGroup"><div class="FixedLine">POST /token HTTP/1.1</div><div class="FixedLine">Host: server.example.com</div><div class="FixedLine">Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW</div><div class="FixedLine">Content-Type: application/x-www-form-urlencoded</div></div><div class="LineGroup"><div class="FixedLine">grant_type=client_credentials</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-5</span><p class="SimplePara">Sample Request</p></div></div></div><div class="ProgramCode" id="PC9"><div class="LineGroup"><div class="FixedLine">HTTP/1.1 200 OK</div><div class="FixedLine">&nbsp;&nbsp;Content-Type: application/json;charset=UTF-8</div><div class="FixedLine">&nbsp;&nbsp;Cache-Control: no-store</div><div class="FixedLine">&nbsp;&nbsp;Pragma: no-cache</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;{</div><div class="FixedLine">&nbsp;&nbsp;"access_token":"2YotnFZFEjr1zCsicMWpAA",</div><div class="FixedLine">&nbsp;&nbsp;"token_type":"example",</div><div class="FixedLine">&nbsp;&nbsp;"expires_in":3600,</div><div class="FixedLine">&nbsp;&nbsp;"example_parameter":"example_value"</div><div class="FixedLine">&nbsp;&nbsp;}<span id="ITerm72">
                      
                      
                    </span><span id="ITerm73">
                      
                    </span></div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-6</span><p class="SimplePara">Sample Response</p></div></div></div></div></section><section class="Section2 RenderAsSection2" id="Sec17"><h3 class="Heading">Token Introspection</h3><div class="Para" id="Par58">If a resource server receives an access <span id="ITerm74">token</span> issued by an external authorization server, it needs some way to understand what the access token means. Is it still valid? When was it issued? For what scopes was it authorized? Sometimes this information is available in a shared database. Encoded JWT tokens are sometimes used as access tokens. But if the bearer token value is only a reference identifier, RFC 7662 describes a mechanism where a resource server can request information about it. This process is called “token introspection”. It's a simple flow. Listings <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC10">4-7</a></span> and <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC11">4-8</a></span> show the sample introspection request and response from the RFC.<div class="ProgramCode" id="PC10"><div class="LineGroup"><div class="FixedLine">POST /introspect HTTP/1.1</div><div class="FixedLine">Host: server.example.com</div><div class="FixedLine">Accept: application/json</div><div class="FixedLine">Content-Type: application/x-www-form-urlencoded</div><div class="FixedLine">Authorization: Bearer 23410913-abewfq.123483</div></div><div class="LineGroup"><div class="FixedLine">token=2YotnFZFEjr1zCsicMWpAA</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-7</span><p class="SimplePara">Sample Request</p></div></div></div><div class="ProgramCode" id="PC11"><div class="LineGroup"><div class="FixedLine">HTTP/1.1 200 OK</div><div class="FixedLine">&nbsp;&nbsp;Content-Type: application/json</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;{</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;"active": true,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"client_id": "l238j323ds-23ij4",</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;"username": "jdoe",</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;"scope": "read write dolphin",</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;"sub": "Z5O3upPC88QrAjx00dis",</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;"aud": "https://protected.example.net/resource",</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;"iss": "https://server.example.com/",</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;"exp": 1419356238,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;"iat": 1419350238,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;"extension_field": "twenty-seven"</div><div class="FixedLine">&nbsp;&nbsp;}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-8</span><p class="SimplePara">Sample Response</p></div></div></div></div><p class="Para" id="Par59">RFC 7662 says the RS must authenticate to introspect a token to prevent a token scanning attack. This normally happens by presenting an OAuth token or by including basic client credentials. Given the entropy and short lifetime of access tokens, you could allow unauthenticated responses if you understand the risks.</p><p class="Para" id="Par60">If the token is valid, the active response claim is true. If the token is not valid, it should be false, and no other information should be returned. RFC 7662 defines some standard claims, but a domain may use any claims. If the intention is to use token claims across domains, they should be registered with <span id="ITerm75">IANA</span>.</p></section></section><section class="Section1 RenderAsSection1" id="Sec18"><h2 class="Heading">OAuth Client Example: Calling a Google API</h2><p class="Para" id="Par61">Enough theory, let’s work on an example of using Google’s free open source Python client library to call an OAuth protected API—in this case Google’s <span id="ITerm76">URL</span> shortening service. In subsequent chapters, we cover in more detail how to use OAuth to protect enterprise resources—how to configure a resource server and authorization server for your organization. Google has a lot of APIs, and their <span id="ITerm77">policies and procedures</span> are typical of a well-run application service.</p><p class="Para" id="Par62">This chapter uses a sample project called “urlias” (like alias for a URL). It will submit a long URL and get back from Google a shorter URL that can be used for tracking. For example, if you post a blog and want to know how many people click on your blog, it is convenient to use a tracking URL. The sample code will be in Python, but the process will be the same across any platform. The code is available in the GitHub repository for this book.</p><section class="Section2 RenderAsSection2" id="Sec19"><h3 class="Heading">Obtaining Client Credentials</h3><p class="Para" id="Par63">Remember that each authorization server will have its own policies and procedures for obtaining <span id="ITerm78">client credentials</span>. Google has a website that enables you to enroll (agree to the terms of services) and to automatically register your application, and in the process, obtain client credentials. Start this process by opening <span class="ExternalRef"><a href="https://console.developers.google.com/"><span class="RefSource">
                  <span class="EmphasisFontCategoryNonProportional ">https://console.developers.google.com</span>
                </span></a></span> in your browser.</p><div class="Para" id="Par64">In the <span id="ITerm79">Library tab</span>, search for URL, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig8">4-8</a></span>.<figure class="Figure" id="Fig8"><div class="MediaObject" id="MO8"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig8_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig8_HTML.jpg" style="height:13em" width="1713" height="520" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig8_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-8</span><p class="SimplePara">Searching Google libraries for URL shortener</p></div></figcaption></figure></div><div class="Para" id="Par65">After clicking on the <span id="ITerm80">URL Shortener API, </span> you’ll need to enable it, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig9">4-9</a></span>.<figure class="Figure" id="Fig9"><div class="MediaObject" id="MO9"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig9_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig9_HTML.jpg" style="height:15.02em" width="1725" height="601" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig9_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-9</span><p class="SimplePara">Enabling Google URL shortener</p></div></figcaption></figure></div><div class="Para" id="Par66">Google does not offer a dynamic client registration API, so you’ll need to manually register your client in the dashboard. First, you’ll need to set up some general properties, like the name, contact information, and logo of your application, which Google will use to render the OAuth consent notification. Note that the values shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig10">4-10</a></span> are just an example. You would use information appropriate to your application.<figure class="Figure" id="Fig10"><div class="MediaObject" id="MO10"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig10_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig10_HTML.jpg" style="height:37.62em" width="1725" height="1505" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig10_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-10</span><p class="SimplePara">Configuring<span id="ITerm81">
                        
                        
                      </span> Google OAuth consent screen</p></div></figcaption></figure></div><div class="Para" id="Par67">Click on the Credentials tab, then on Create Credentials. Then choose <span id="ITerm82">OAuth Client ID</span>, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig11">4-11</a></span>.<figure class="Figure" id="Fig11"><div class="MediaObject" id="MO11"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig11_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig11_HTML.jpg" style="height:28.38em" width="1725" height="1135" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig11_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-11</span><p class="SimplePara">Creating a Google <span id="ITerm83">OAuth client ID</span></p></div></figcaption></figure></div><div class="Para" id="Par68">The form to create client credentials is actually rather short. To create a web client, there are only three pieces of information you need to supply: the application type, name, and redirect_uris, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig12">4-12</a></span>.<figure class="Figure" id="Fig12"><div class="MediaObject" id="MO12"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig12_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig12_HTML.jpg" style="height:29.88em" width="1725" height="1195" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig12_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-12</span><p class="SimplePara">Google <span id="ITerm84">client ID request form</span></p></div></figcaption></figure></div><div class="Para" id="Par69">If successful, you should see a modal window with your client credentials—record these in a secure place. You should never share your <span id="ITerm85">client credentials</span>. Hypothetical examples are shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig13">4-13</a></span>.<figure class="Figure" id="Fig13"><div class="MediaObject" id="MO13"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig13_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig13_HTML.jpg" style="height:17.3em" width="1725" height="692" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig13_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-13</span><p class="SimplePara">Final client credentials</p></div></figcaption></figure></div></section><section class="Section2 RenderAsSection2" id="Sec20"><h3 class="Heading">Calling the Google API</h3><div class="Para" id="Par70">Now that you have client credentials, it’s time to call the API. To show this I’d like to reference a sample node project called <span class="EmphasisFontCategoryNonProportional ">google-oauth-implicit-example</span> in my <span id="ITerm86">GitHub project</span> for this book at <span class="ExternalRef"><a href="https://github.com/GluuFederation/iam-book"><span class="RefSource">
                  <span class="EmphasisFontCategoryNonProportional ">https://github.com/GluuFederation/iam-book</span>
                </span></a></span>. This is a two-page application: page one displays a login button that enables the user to authorize the use of their Google account; page two is a <span id="ITerm87">JavaScript application</span> that uses the returned access token to call the API. Figure&nbsp;<span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig14">4-14</a></span> shows the sequence diagram for this application.<figure class="Figure" id="Fig14"><div class="MediaObject" id="MO14"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig14_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig14_HTML.jpg" style="height:42.75em" width="1718" height="1710" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig14_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-14</span><p class="SimplePara">Sequence diagram for <span id="ITerm88">URL shortener application</span></p></div></figcaption></figure></div><div class="Para" id="Par71">To run this application, you’ll need <span class="EmphasisFontCategoryNonProportional ">node.js</span> installed on your workstation or server. Follow the relevant instructions on <span class="ExternalRef"><a href="http://nodejs.org/"><span class="RefSource">
                  <span class="EmphasisFontCategoryNonProportional ">http://nodejs.org</span>
                </span></a></span> for your operating system. After cloning the project from GitHub, the first thing you’ll need to do is to set the properties files, called <span class="EmphasisFontCategoryNonProportional ">settings.js</span>, to enter the client credentials retrieved in the preceding steps (see Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC12">4-9</a></span>). Don’t forget to quote the strings and to use a semicolon at the end of each line. Just as an example, <span class="EmphasisFontCategoryNonProportional ">settings.js</span> should look something like Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC12">4-9</a></span> (again, those are not real Google API creds.). Note that the callback must match the one you registered for this client with Google. For this demo, I was running the server on port 8000, but you can choose any free port on your system.<div class="ProgramCode" id="PC12"><div class="LineGroup"><div class="FixedLine">exports.client_id =&nbsp;&nbsp;'6fb8.apps.googleusercontent.com';</div><div class="FixedLine">exports.client_secret = ' ghoeg&amp;qecyic8_1';</div><div class="FixedLine">exports.port = 8000;</div><div class="FixedLine">exports.redirectURIPath = '/cb';</div><div class="FixedLine">exports.redirectURI = 'http://localhost:8000/cb';</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-9</span><p class="SimplePara">Sample Properties for <span id="ITerm89">URL Shortener Application</span> (Shortened for Display)</p></div></div></div></div><div class="Para" id="Par72">To download the necessary libraries and run the application, navigate via the command line to the project folder and run the commands shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC13">4-10</a></span>.<div class="ProgramCode" id="PC13"><div class="LineGroup"><div class="FixedLine">$ npm install</div><div class="FixedLine">$ node app</div><div class="FixedLine">Server Started on port 8000</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-10</span><p class="SimplePara">Starting the <span id="ITerm90">Node Application</span></p></div></div></div></div><p class="Para" id="Par73">It might be confusing at first as to why the callback <span id="ITerm91">works</span> using localhost. How can Google call back to localhost? The simple answer is that Google gets your browser to call the callback. So as long as you can connect to <span class="EmphasisFontCategoryNonProportional ">http://localhost:8000</span>, you’re fine. Also, if you’re using localhost, you don’t need to use https—the traffic is not traversing the network. If you are redirecting over to anywhere other than localhost, then https is highly recommended. The client must protect the access token, so using a non-encrypted protocol would be unwise, even on your local network.</p><div class="Para" id="Par74">To test the application, point your browser at <span class="EmphasisFontCategoryNonProportional ">http://localhost:8000</span>. You should see the very simple <span id="ITerm92">web page</span> shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig15">4-15</a></span>.<figure class="Figure" id="Fig15"><div class="MediaObject" id="MO15"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig15_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig15_HTML.jpg" style="height:9.95em" width="1725" height="398" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig15_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-15</span><p class="SimplePara">Page one of the URL shortener application</p></div></figcaption></figure></div><div class="Para" id="Par75">When you click on the button, you may be prompted to log in to Google if you don’t already have a session in your browser. Once Google knows who you are, you will be asked to authorize the client and then will be redirected to page two, shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig16">4-16</a></span>.<figure class="Figure" id="Fig16"><div class="MediaObject" id="MO16"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig16_HTML.png" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig16_HTML.png" style="height:37.95em" width="1382" height="1518" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig16_HTML.png"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-16</span><p class="SimplePara"><span id="ITerm93">Authorization</span> and page two of the URL shortener application*</p></div></figcaption></figure></div><div class="Para" id="Par76">The app is simple: enter a URL and it will obtain a Google-shortened version for you. The action of calling the API actually happens in the JavaScript in the browser, which uses the access token returned in the URL fragment (a fragment is content returned in a URL after the <span class="EmphasisFontCategoryNonProportional ">#</span>). The callback URL and fragment in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig16">4-16</a></span> is:<div class="ProgramCode" id="PC14"><div class="LineGroup"><div class="FixedLine">http://localhost:8000/cb#state=urlshortenapicall&amp;access_token=ya29.Ci-</div><div class="FixedLine">UAzies3LBs9mMLOIZr8Sp_iYMgkxTE5aTT3wb6ymyPIccIx-hS8h-</div><div class="FixedLine">Hlrjlx6f8Q&amp;token_type=Bearer&amp;expires_in=3599</div></div></div></div><div class="Para" id="Par77">You can see the parameters <span id="ITerm94">
                <span class="EmphasisFontCategoryNonProportional ">access_token</span>
                
              </span>, <span class="EmphasisFontCategoryNonProportional ">token_type</span>, and <span class="EmphasisFontCategoryNonProportional ">expires_in</span>, which are listed after the hash mark (<span class="EmphasisFontCategoryNonProportional ">#</span>) of the callback URI. You shouldn’t share an access token, but this one will be long expired by the time you read this! Let’s take a quick look at some of the more interesting parts of the code. The interesting part starts after you click the button. This code is quite simple (see Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC15">4-11</a></span>).<div class="ProgramCode" id="PC15"><div class="LineGroup"><div class="FixedLine">// Redirect to Google's authorization endpoint</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;app.post('/authRequest', function(req, res) {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log('Redirect to : ', url);</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.redirect(url);</div><div class="FixedLine">&nbsp;&nbsp;});</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-11</span><p class="SimplePara">Sample Code to Redirect to the Authorization Endpoint</p></div></div></div></div><div class="Para" id="Par78">The authorization URL sends the required parameters scope, <span class="EmphasisFontCategoryNonProportional ">redirect_uri</span>, <span class="EmphasisFontCategoryNonProportional ">response_type</span>, and <span class="EmphasisFontCategoryNonProportional ">client_id</span> (see Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC16">4-12</a></span>).<div class="ProgramCode" id="PC16"><div class="LineGroup"><div class="FixedLine">var url = 'https://accounts.google.com/o/OAuth/v2/auth?' +</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'scope='+urlShortenScope+'&amp;'+</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'redirect_uri='+redirectURI+'&amp;'+</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'response_type=token&amp;' +</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'client_id='+client_id;</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-12</span><p class="SimplePara">Forming the Correct URL Value for OAuth <span id="ITerm95">Authorization</span></p></div></div></div></div><p class="Para" id="Par79">Of course, the <span class="EmphasisFontCategoryNonProportional ">response_type</span> token tells the authorization server that this is implicit flow. The state parameter is not needed in this case, because the application is running on localhost. The risk of a malicious application sending a response to the <span id="ITerm96">callback URI</span> is minimal. For web applications, the state value is recommended. The state is returned by the authorization server—the application generates a random, hard-to-guess state value and caches it. When a response is received on the callback, the state should be looked up. If it doesn’t exist, the response should be discarded—it was unsolicited. If the state exists in the cache, it should be removed, and the response should be processed.</p><p class="Para" id="Par80">When the callback is called, it renders the <span class="EmphasisFontCategoryNonProportional ">demourlshorten.ejs</span> page<span id="ITerm97">
                
                
              </span>. When the Submit button is clicked, a JavaScript script is called: <span class="EmphasisFontCategoryNonProportional ">$('#submit').click(function())</span>, which gathers the URL from the text field and submits it with the access token to the <span class="EmphasisFontCategoryNonProportional ">urlshortener</span> API. The results are just printed to a log message on the page itself, along with a log of the exact request that was sent, so you can understand what is going on in the background.</p></section></section><section class="Section1 RenderAsSection1" id="Sec21"><h2 class="Heading">Client Credential Grant Example with the&nbsp;Gluu Server</h2><p class="Para" id="Par81">If you are wondering how to put OAuth to work in your environment, it’s not that hard! Let’s look at a simple “machine-to-machine” example of a script that calls a protected API. The example is written in Python, using the easy-to-read “requests” module.</p><section class="Section2 RenderAsSection2" id="Sec22"><h3 class="Heading">Configuring the Gluu Server</h3><div class="Para" id="Par82">In this example, the Gluu Server acts as the authorization server. The easiest way to run this demo is to add both a <span id="ITerm98">scope</span> (<span class="EmphasisFontCategoryNonProportional ">myScope</span>) and a client using the oxTrust administrative interface. Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig17">4-17</a></span> shows a sample of the scope. OAuth scopes are managed under the “OpenID Connect” section. That might be a little confusing, but OpenID Connect does a really good job of defining how to manage OAuth clients. When you add the client, select Scope <span id="ITerm99">Type</span> OAuth. In this example, we made the scope available for dynamically registered clients. It wasn’t necessary, because we’re going to add the scope to the client manually. In general, if you make scopes available by default, make sure they are not protecting any resources that require user explicit user approval. When adding the client, make sure to add Client Credential Grant and two scopes: <span class="EmphasisFontCategoryNonProportional ">myScope</span> and <span class="EmphasisFontCategoryNonProportional ">uma_protection</span> (see Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fig18">4-18</a></span>). The latter will enable you to reuse these credentials for both the client and resource server. The <span class="EmphasisFontCategoryNonProportional ">uma_protection</span> scope is needed to call the OAuth token introspection endpoint. You can disable protection of the introspection endpoint, but by default, it’s protected. The thought is you may not want any client to be able to convert a bearer token into its JSON equivalent.<figure class="Figure" id="Fig17"><div class="MediaObject" id="MO17"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig17_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig17_HTML.jpg" style="height:26.5em" width="1725" height="1060" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig17_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-17</span><p class="SimplePara">Gluu Server OAuth <span id="ITerm100">scope</span> configuration</p></div></figcaption></figure><figure class="Figure" id="Fig18"><div class="MediaObject" id="MO18"><img alt="../images/425975_1_En_4_Chapter/425975_1_En_4_Fig18_HTML.jpg" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_4_Fig18_HTML.jpg" style="height:11.92em" width="1182" height="477" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_4_Chapter/425975_1_En_4_Fig18_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-18</span><p class="SimplePara">Gluu Server client <span id="ITerm101">configuration</span> detail on scopes and grant type</p></div></figcaption></figure></div><div class="Para" id="Par83">The sample client in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC17">4-13</a></span> is pretty simple: it gets a token and calls the API. The sample RS is almost as simple: it looks at the token sent by the client, introspects it, checks to see if it has the required scopes, and if so, returns the content. Of course you'll have to insert your own client credentials and fix the URLs. Note: we aren't using SSL for the sample API. If you want to use SSL, just add <span class="EmphasisFontCategoryNonProportional ">verify=False</span> or read more about the <span id="ITerm102">Python</span> requests module to properly validate the SSL certificate (a requirement for any production system).<div class="ProgramCode" id="PC17"><div class="LineGroup"><div class="FixedLine">#!/usr/bin/python</div></div><div class="LineGroup"><div class="FixedLine">import requests, json</div></div><div class="LineGroup"><div class="FixedLine"># Get access token</div><div class="FixedLine">client_id = '12345676890abcdefg'</div><div class="FixedLine">client_secret = "secret"</div><div class="FixedLine">token_endpoint = "https://idp.example.com/token"</div><div class="FixedLine">scope = "myScope"</div><div class="FixedLine">payload = {"grant_type":"client_credentials", "scope":scope}</div><div class="FixedLine">response = requests.post(token_endpoint, data=payload, verify=False, auth=(client_id, client_secret))</div><div class="FixedLine">j = json.loads(response.text)</div><div class="FixedLine">access_token = j['access_token']</div><div class="FixedLine"># Call API</div><div class="FixedLine">api_endpoint = "http://api.example.com/cgi-bin/oauth-rs.cgi"</div><div class="FixedLine">h = {'Authorization': 'Bearer %s' % access_token}</div><div class="FixedLine">response = requests.post(api_endpoint, headers=h)</div><div class="FixedLine">print response.text</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-13</span><p class="SimplePara">Simple Python OAuth Client</p></div></div></div></div><div class="Para" id="Par84">The sample RS in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#PC18">4-14</a></span> is almost as simple: it looks at the token sent by the client, introspects it, checks to see if it has the required scopes, and if so, returns the content. Of course, you'll have to insert your own client credentials and fix the URLs. Note: we aren't using SSL for the sample API. If you want to use <span id="ITerm103">SSL</span>, just add <span class="EmphasisFontCategoryNonProportional ">verify=False</span> or read more about the Python requests module to properly validate the SSL certificate (a requirement for any production system).<div class="ProgramCode" id="PC18"><div class="LineGroup"><div class="FixedLine">#!/usr/bin/python</div></div><div class="LineGroup"><div class="FixedLine">import requests, json, os</div><div class="FixedLine">from sets import Set</div></div><div class="LineGroup"><div class="FixedLine">result = None</div><div class="FixedLine">client_token = None</div><div class="FixedLine">required_scopes = Set(['myScope'])</div></div><div class="LineGroup"><div class="FixedLine">try:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;client_token = os.environ['HTTP_AUTHORIZATION'].split('Bearer')[-1].strip()</div><div class="FixedLine">except:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "HTTP/1.0 200 OK"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "Content-type: text/html\n\n"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print 'Access token not found'</div><div class="FixedLine"># First get access token to call introspection endpoint</div><div class="FixedLine">client_id = '1234567890abcdefg'</div><div class="FixedLine">client_secret = 'secret'</div><div class="FixedLine">token_endpoint = 'https://idp.example.com/token'</div><div class="FixedLine">payload = {'grant_type':'client_credentials', 'scope':'uma_protection'}</div><div class="FixedLine">response = requests.post(token_endpoint,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data=payload,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify=False,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auth=(client_id, client_secret))</div><div class="FixedLine">j = json.loads(response.text)</div><div class="FixedLine">introspection_token = j['access_token']</div></div><div class="LineGroup"><div class="FixedLine"># Introspect token</div><div class="FixedLine">introspection_endpoint = 'https://idp.example.com/introspection'</div><div class="FixedLine">h = {'Authorization': 'Bearer %s' % introspection_token}</div><div class="FixedLine">token = {'token': client_token}</div><div class="FixedLine">response = requests.post(introspection_endpoint,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify=False,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;headers=h,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data=token)</div><div class="FixedLine">result = response.text</div><div class="FixedLine">j = response.json()</div><div class="FixedLine">try:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;scopes = Set(j['scopes'][0].strip().split(' '))</div><div class="FixedLine">except:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "HTTP/1.0 200 OK"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "Content-type: text/html\n\n"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "No scopes found"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "Result:\n" + result</div></div><div class="LineGroup"><div class="FixedLine">missing_scopes = required_scopes - scopes</div><div class="FixedLine">if len(missing_scopes):</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "HTTP/1.0 200 OK"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "Content-type: text/html\n\n"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "Missing scopes: %s" % `list(missing_scopes)`</div><div class="FixedLine">elif len(missing_scopes)==0:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "HTTP/1.0 200 OK"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "Content-type: text/html\n\n"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;print "Scopes %s all found" % `list(required_scopes)` <span id="ITerm104">
                      
                      
                      
                    </span></div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 4-14</span><p class="SimplePara">Simple <span id="ITerm105">OAuth Protected Python API</span></p></div></div></div></div><p class="Para" id="Par85">Make sure the web server is sending the request headers—if it's not, the RS script will complain that it can't find the access token. You can use the print headers example from Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_3_Chapter.xhtml" class="totri-footnote"><span class="RefSource">3</span></a></span>. Look for the <span id="ITerm106">Authorization header</span>: you should see the bearer token. Also, see the print headers example from Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_3_Chapter.xhtml" class="totri-footnote"><span class="RefSource">3</span></a></span> if you're not sure how to deploy a CGI script.</p><p class="Para" id="Par86">This RS script was tested with nginx. For Apache you may need to remove the <span class="EmphasisFontCategoryNonProportional ">print "HTTP/1.0 200 OK"</span> lines. The client script can be run from anywhere, even from your laptop. If you are not sure where the <span class="EmphasisFontCategoryNonProportional ">token</span> and <span class="EmphasisFontCategoryNonProportional ">introspection</span> endpoint<span id="ITerm107">
                
                
                
              </span> are located on your Gluu Server, use the OpenID Connect discovery endpoint. This is a simple JSON object with the location of all the endpoints (and a bunch of other stuff you'll learn more about in the next chapter), and you can view it by pointing your browser to <span class="ExternalRef"><a href="https://gluu.server.hostname/.well-known/openid-configuration"><span class="RefSource">
                  <span class="EmphasisFontCategoryNonProportional ">https://gluu.server.hostname/.well-known/openid-configuration</span>
                </span></a></span>.</p></section></section><section class="Section1 RenderAsSection1" id="Sec23"><h2 class="Heading">OAuth Glossary and IANA Registry Terms</h2><p class="Para" id="Par87">OAuth has a large vocabulary of terms, some of which are registered at the <span id="ITerm108">Internet Assigned Numbers Authority (IANA)</span>. This is a department of ICANN, a nonprofit organization that oversees domain names, IP addresses, and protocol parameters. <span id="ITerm109">IANA</span> publishes many standard names, which are essential for the Internet to work. Port numbers, media types, and language tags are some examples.</p><div class="Para" id="Par88">The <span id="ITerm110">Internet Engineering Task Force (IETF)</span> community writes drafts, which become Requests for Comments (RFCs) when they are final. Many RFCs contain guidance to the IANA department for the creation of unique registry for protocol parameters, the registration policy, and initial registrations of reserved values. There are almost 3,000 protocol registries published on <span class="ExternalRef"><a href="http://www.iana.org/"><span class="RefSource">
                <span class="EmphasisFontCategoryNonProportional ">http://www.iana.org</span>
              </span></a></span>. The two of interest to us are the OAuth Parameters Registry and the JSON Web Token Registry. Familiarizing yourself with these parameters shown in Tables <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Tab1">4-1</a></span> through <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Tab9">4-9</a></span> will help you understand which part of a profile is OAuth and which part is custom.<div class="Table" id="Tab1"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 4-1</span><p class="SimplePara">OAuth <span id="ITerm111">Access Token Types</span></p></div></div><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Parameter</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Reference</p></th><th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Description</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">bearer</span>
                      </p></td><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6750</p></td><td style="text-align: left;"><p class="SimplePara">Any party in possession of this type of token can use it to access a protected resource.</p></td></tr></tbody></table></div><div class="Table" id="Tab2"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 4-2</span><p class="SimplePara">OAuth <span id="ITerm112">Authorization Endpoint Response Types</span></p></div></div><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Parameter</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Reference</p></th><th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Description</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">code</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Authorization Code Flow</p></td></tr><tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">token</span>
                      </p></td><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="text-align: left;"><p class="SimplePara">Implicit Flow</p></td></tr></tbody></table></div><div class="Table" id="Tab3"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 4-3</span><p class="SimplePara">OAuth <span id="ITerm113">Extensions Errors</span></p></div></div><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Parameter</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Reference</p></th><th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Description</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">invalid_request</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6750</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The request is missing a required parameter, includes an unsupported parameter or parameter value, repeats the same parameter, uses more than one method for including an access token, or is otherwise malformed. The resource server SHOULD respond with the HTTP 400 (Bad Request) status code.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">invalid_token</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6750</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The access token provided is expired, revoked, malformed, or invalid for other reasons. The resource SHOULD respond with the HTTP 401 (Unauthorized) status code. The client MAY request a new access token and retry the protected resource request.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">insufficient_scope</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6750</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The request <span id="ITerm114">requires</span> higher privileges than provided by the access token. The resource server SHOULD respond with the HTTP 403 (Forbidden) status code and MAY include the "<span class="EmphasisFontCategoryNonProportional ">scope</span>" attribute with the scope necessary to access the protected resource.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">unsupported_token_type</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7009</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The authorization server does not support the revocation of the presented token type. That is, the client tried to revoke an access token on a server not supporting this feature. If the server responds with HTTP status code 503, the client must assume the token still exists and may retry after a reasonable delay.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">unauthorized_client</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The client is not authorized to request an authorization code using this method.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">access_denied</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The resource owner or authorization server denied the request.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">unsupported_response_type</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The authorization server does not support obtaining an authorization code using this method.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">invalid_scope</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The requested scope is invalid, unknown, or malformed.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">server_error</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The authorization <span id="ITerm115">server</span> encountered an unexpected condition that prevented it from fulfilling the request. (This error code is needed because a 500 Internal Server Error HTTP status code cannot be returned to the client via an HTTP redirect.)</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">temporarily_unavailable</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server. (This error code is needed because a 503 Service Unavailable HTTP status code cannot be returned to the client via an HTTP redirect.)</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">invalid_client</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Client authentication failed.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">invalid_grant</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The provided authorization grant or refresh token is invalid, expired, revoked, does not match the redirection URI used in the authorization request, or was issued to another client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">invalid_scope</span>
                      </p></td><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="text-align: left;"><p class="SimplePara">The requested scope is invalid, unknown, malformed, or exceeds the scope granted by the resource <span id="ITerm116">owner</span>.</p></td></tr></tbody></table></div><div class="Table" id="Tab4"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 4-4</span><p class="SimplePara">OAuth <span id="ITerm117">Parameters</span></p></div></div><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"><col class="tcol4 align-left"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Parameter</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Parameter Usage Location</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Reference</p></th><th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Description</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_id</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization request, token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The client identifier issued to the client during the registration process.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_secret</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">A string with sufficient entropy to prevent a credential guessing attack.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">response_type</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The expected response from the authorization endpoint, can be <span class="EmphasisFontCategoryNonProportional ">'code'</span>, <span class="EmphasisFontCategoryNonProportional ">'token'</span>, or other registered extension values.<span id="ITerm118">
                          
                          
                        </span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">redirect_uri</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization request, token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">After completing its interaction with the resource owner, the authorization server redirects the user-agent to this URI.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">scope</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization request, authorization response, token request, token response</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The permissions associated with the access token.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">state</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization request, authorization response</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">An opaque value used by the client to maintain state between the request and callback. The authorization server includes this value when redirecting the user-agent back to the client. The parameter SHOULD be used for preventing cross-site request forgery.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">code</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization response, token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">A string generated by the authorization server that’s used by the client to obtain tokens. It should be short-lived (less than 10 minutes), one-time use, and bound to a client-id.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">error</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization response, token response</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">A single ASCII error code specified in the OAuth Extensions Error Registry.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">error_description</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization response, token response</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Human-readable ASCII [USASCII] text providing additional information, used to assist the client developer in understanding the <span id="ITerm119">error</span> that occurred.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">error_uri</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization response, token response</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">A URI identifying a human-readable web page with information about the error, used to provide the client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">grant_type</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Credential representing the resource owner's authorization (to access its protected resources) used by the client to obtain an access token.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">access_token</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization response, token response</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">A string denoting a specific scope, lifetime, and other access attributes.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">token_type</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization response, token response</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Information the client needs to successfully utilize the access token.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">expires_in</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization response, token response</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The lifetime in seconds of the access token. For example, the value “<span class="EmphasisFontCategoryNonProportional ">3600</span>” denotes that the access token will expire in one hour from the time the response was generated.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">username</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The identifier for the resource <span id="ITerm120">owner</span>.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">password</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The resource owner’s ASCII secret.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">refresh_token</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">token request, token response</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 6749</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">A token that can be used to obtain a new access token from the authorization server.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">assertion</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7521</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">A package of information that facilitates the sharing of identity and security information across security domains.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_assertion</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7521</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">An assertion about the client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_assertion_type</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7521</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The format of the assertion.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">code_verifier</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">token request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7636</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">A cryptographically random string that is used to correlate the authorization request to the token request.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">code_challenge</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization request</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7636</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">A challenge derived from the code verifier that is sent in the authorization request, to be verified against later.</p></td></tr><tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">code_challenge_method</span>
                      </p></td><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">authorization request</p></td><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7636</p></td><td style="text-align: left;"><p class="SimplePara">A <span id="ITerm121">mechanism</span> that was used to derive code challenge.</p></td></tr></tbody></table></div><div class="Table" id="Tab5"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 4-5</span><p class="SimplePara">OAuth Dynamic <span id="ITerm122">Client Registration Metadata</span></p></div></div><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Parameter</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Reference</p></th><th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Description</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">redirect_uris</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Array of redirection URIs for use in redirect-based flows.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">token_endpoint_auth_method</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Requested authentication method for the token endpoint.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">grant_types</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Array of OAuth 2.0 grant types that the client may use.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">response_types</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Array of the OAuth 2.0 response types that the client may use.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_name</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Human-readable name of the client to be presented to the user.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_uri</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">URL of a web page providing information about the client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">logo_uri</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">URL that references a logo for the client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">scope</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Space-separated list of OAuth 2.0 scope values.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">contacts</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Array of strings representing ways to contact people responsible for this client, typically email addresses.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">tos_uri</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">URL that points to a human-readable terms of service document for the client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">policy_uri</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">URL<span id="ITerm123">
                          
                          
                        </span> that points to a human-readable policy document for the client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">jwks_uri</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">URL referencing the client’s JSON Web Key Set [RFC7517] document representing the client's public keys.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">jwks</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Client’s JSON Web Key Set [RFC7517] document representing the client’s public keys.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">software_id</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Identifier for the software that comprises a client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">software_version</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Version identifier for the software that comprises a client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_id</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Client identifier.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_secret</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Client secret.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_id_issued_at</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Time at which the client identifier was issued.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_secret_expires_at</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Time at which the client secret will expire.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">registration_access_token</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">OAuth 2.0 Bearer Token used to access the client configuration endpoint.</p></td></tr><tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">registration_client_uri</span>
                      </p></td><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="text-align: left;"><p class="SimplePara">Fully qualified <span id="ITerm124">URI</span> of the client registration endpoint.</p></td></tr></tbody></table></div><div class="Table" id="Tab6"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 4-6</span><p class="SimplePara">OAuth <span id="ITerm125">Token Endpoint Authentication Methods</span></p></div></div><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Parameter</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Reference</p></th><th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Description</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">none</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">No authentication.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_secret_post</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">The client uses the HTTP <span class="EmphasisFontCategoryNonProportional ">POST</span> parameters as defined in OAuth 2.0, Section 2.3.1.</p></td></tr><tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_secret_basic</span>
                      </p></td><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7591</p></td><td style="text-align: left;"><p class="SimplePara">HTTP Basic authentication.</p></td></tr></tbody></table></div><div class="Table" id="Tab7"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 4-7</span><p class="SimplePara">OAuth <span id="ITerm126">Token Introspection Responses</span></p></div></div><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Parameter</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Reference</p></th><th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Description</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">active</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Token active status.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">username</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">User identifier of the resource owner.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">client_id</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Client identifier of the client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">scope</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Authorized scopes of the token.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">token_type</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Type of the token.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">exp</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Expiration timestamp of the token.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">iat</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Issuance timestamp of the token.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">nbf</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Timestamp before which the token is not valid.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">sub</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Subject of the token.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">aud</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Audience of the token.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">iss</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Issuer of the token.</p></td></tr><tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">jti</span>
                      </p></td><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7662</p></td><td style="text-align: left;"><p class="SimplePara">Unique identifier of the <span id="ITerm127">token</span>.</p></td></tr></tbody></table></div><div class="Table" id="Tab8"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 4-8</span><p class="SimplePara">JSON Web Token <span id="ITerm128">Claims</span></p></div></div><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Parameter</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Reference</p></th><th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Description</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">iss</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7519</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Issuer</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">sub</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7519</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Subject</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">aud</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7519</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Audience</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">exp</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7519</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Expiration Time</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">nbf</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7519</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Not Before</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">iat</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7519</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Issued At</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">jti</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7519</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">JWT ID</p></td></tr><tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">cnf</span>
                      </p></td><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7800</p></td><td style="text-align: left;"><p class="SimplePara">Confirmation</p></td></tr></tbody></table></div><div class="Table" id="Tab9"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 4-9</span><p class="SimplePara">JWT <span id="ITerm129">Confirmation Methods</span></p></div></div><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Parameter</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Reference</p></th><th style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Description</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">jwk</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7800</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">JSON Web Key Representing Public Key</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">jwe</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7800</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Encrypted JSON Web Key</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">kid</span>
                      </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7800</p></td><td style="border-bottom: 0.5pt solid ; text-align: left;"><p class="SimplePara">Key Identifier</p></td></tr><tr><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">
                        <span class="EmphasisFontCategoryNonProportional ">jku</span>
                      </p></td><td style="border-right: 0.5pt solid ; text-align: left;"><p class="SimplePara">RFC 7800</p></td><td style="text-align: left;"><p class="SimplePara">JWK Set URL<span id="ITerm130">
                          
                          
                        </span></p></td></tr></tbody></table></div></div></section><section class="Section1 RenderAsSection1" id="Sec24"><h2 class="Heading">Conclusion</h2><p class="Para" id="Par89">Didn’t get enough OAuth? Now that you know the OAuth basics, it’s time to move on. The preceding examples showed how to write a client to call an OAuth protected API. Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_5_Chapter.xhtml" class="totri-footnote"><span class="RefSource">5</span></a></span> deep dives on using OAuth for authentication, using the OpenID Connect profile. Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_6_Chapter.xhtml" class="totri-footnote"><span class="RefSource">6</span></a></span> details using a web proxy and OAuth to protect APIs. Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_8_Chapter.xhtml" class="totri-footnote"><span class="RefSource">8</span></a></span> discusses using the User Managed Access protocol (UMA), a profile of OAuth for API access management.</p></section><section class="Section1 RenderAsSection1" id="Sec25"><h2 class="Heading">References</h2><div class="Para" id="Par90">
            <div class="OrderedList"><ol><li class="ListItem"><span class="ItemNumber">1.</span><div class="ItemContent"><p class="Para" id="Par91">“OAuth 2.0 and Sign-In,” 1/2/2013, <span class="ExternalRef"><a href="http://www.cloudidentity.com/blog/2013/01/02/oauth-2-0-and-sign-in-4/"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">http://www.cloudidentity.com/blog/2013/01/02/oauth-2-0-and-sign-in-4/</span>
                      </span></a></span></p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">2.</span><div class="ItemContent"><p class="Para" id="Par92">Google Scopes page: <span class="ExternalRef"><a href="https://developers.google.com/identity/protocols/googlescopes%253FlinkId%253D17886206"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://developers.google.com/identity/protocols/googlescopes?linkId=17886206</span>
                      </span></a></span></p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">3.</span><div class="ItemContent"><p class="Para" id="Par93">“JSON Web Token (JWT),” Jones, Bradley, Sakimura, May 2015, <span class="ExternalRef"><a href="https://tools.ietf.org/html/rfc7519%2523section-10.2.1"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/rfc7519#section-10.2.1</span>
                      </span></a></span></p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">4.</span><div class="ItemContent"><p class="Para" id="Par94">“OAuth 2.0 Message Authentication Code (MAC) Tokens,” Richer, Mills, Tschofenig, January 2014, <span class="ExternalRef"><a href="https://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-05"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-05</span>
                      </span></a></span></p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">5.</span><div class="ItemContent"><p class="Para" id="Par95">“The OAuth 2.0 Authorization Framework: Bearer Token Usage,” Jones, Hardt, October 2012, <span class="ExternalRef"><a href="https://tools.ietf.org/html/rfc6750"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/rfc6750</span>
                      </span></a></span></p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">6.</span><div class="ItemContent"><p class="Para" id="Par96">OAuth 2.0 Token Introspection, J. Richer, October 2015, <span class="ExternalRef"><a href="https://tools.ietf.org/html/rfc7662"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/rfc7662</span>
                      </span></a></span></p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">7.</span><div class="ItemContent"><p class="Para" id="Par97">“JSON Web Algorithms (JWA),” Jones, M., May 2015, <span class="ExternalRef"><a href="http://www.rfc-editor.org/info/rfc7518"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">http://www.rfc-editor.org/info/rfc7518</span>
                      </span></a></span></p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">8.</span><div class="ItemContent"><p class="Para" id="Par98">“Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs),” Jones, Bradley, Tschofenig, April 2016, <span class="ExternalRef"><a href="https://tools.ietf.org/html/rfc7800"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/rfc7800</span>
                      </span></a></span></p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">9.</span><div class="ItemContent"><p class="Para" id="Par99">“OAuth 2.0 Dynamic Client Registration Protocol,” Jone, Bradley, Machalak, Hunt, July 2015, <span class="ExternalRef"><a href="https://tools.ietf.org/html/rfc7591"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/rfc7591</span>
                      </span></a></span></p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">10.</span><div class="ItemContent"><p class="Para" id="Par100">
                    <span class="ExternalRef"><a href="https://tools.ietf.org/html/rfc6749%2523section-10.10"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/rfc6749#section-10.10</span>
                      </span></a></span>
                  </p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">11.</span><div class="ItemContent"><p class="Para" id="Par101">“Proof Key for Code Exchange by OAuth Public Clients,” Sakimura, Bradley, Agarwal, September 2015, <span class="ExternalRef"><a href="https://tools.ietf.org/html/rfc7636"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/rfc7636</span>
                      </span></a></span></p></div><div class="ClearBoth">&nbsp;</div></li></ol></div>
          </div></section><aside class="FootnoteSection" epub:type="footnotes"><div class="Heading">Footnotes</div><div class="Footnote"><span class="FootnoteNumber"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#Fn1_source" class="totri-footnote">1</a></span><div class="FootnoteContent" epub:type="footnote" id="Fn1"><p class="Para" id="Par4">
              <span class="ExternalRef"><a href="https://blogs.msdn.microsoft.com/vbertocci/2013/01/02/oauth-2-0-and-sign-in/"><span class="RefSource">
                  <span class="EmphasisFontCategoryNonProportional ">https://blogs.msdn.microsoft.com/vbertocci/2013/01/02/oauth-2-0-and-sign-in/</span>
                </span></a></span>
            </p></div><div class="ClearBoth">&nbsp;</div></div></aside></div><div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-0" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none;">
	<ul class="adders">
		
		<li class="copy"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#">Copy</a></li>
		
		<li class="add-highlight"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#">Add Highlight</a></li>
		<li class="add-note"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#">
			Add Note
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_3_Chapter.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">3.&nbsp;SAML</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_5_Chapter.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">5.&nbsp;OpenID Connect</div>
        </a>
    
  
  </div>


        
    </section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    
      <div id="js-subscribe-nag" class="subscribe-nag clearfix trial-panel t-subscribe-nag collapsed slideUp">
        
        
          
          
            <p class="usage-data">Find answers on the fly, or master something new. Subscribe today. <a href="https://learning.oreilly.com/subscribe/" class="ga-active-trial-subscribe-nag">See pricing options.</a></p>
          

          
        
        

      </div>

    
    



        
      </div>
      
        


<footer class="pagefoot t-pagefoot" style="padding-bottom: 69px;">
  <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" class="icon-up" onclick="window.Appcues.track(&#39;JumpTop_HeronBook&#39;)" style="display: none;"><div class="visuallyhidden">Back to top</div></a>
  <ul class="js-footer-nav">
  
    
    <li><a href="https://learning.oreilly.com/u/preferences/">Settings</a></li>
    
    <li><a href="https://learning.oreilly.com/public/support/">Support</a></li>
    
    <li><a href="https://learning.oreilly.com/accounts/logout/">Sign Out</a></li>
    
  
  
  </ul>
  <span class="copyright">© 2020 <a href="https://learning.oreilly.com/" target="_blank">O'Reilly Media, Inc</a>.</span>
  
    
    <a href="https://www.oreilly.com/terms/">Terms of Service</a> 
     / 
    
    <a href="https://learning.oreilly.com/privacy">Privacy Policy</a> 
    
    
  
</footer>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"agent":"","beacon":"bam.nr-data.net","applicationTime":445,"queueTime":3,"applicationID":"172641827,79672898,93931619","errorBeacon":"bam.nr-data.net","transactionName":"YgdaZ0NSW0cEB0RdWltNfkZfUEFdCgofXFBHDVYdR1pQQxZeRl1QQj1aWkU=","licenseKey":"510f1a6865"}</script>

      
    
    <script src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource" charset="utf-8"></script>
    <script src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource(1)" charset="utf-8"></script>
  

<div></div><div></div><script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1732687426968531");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1732687426968531&amp;ev=PageView&amp;noscript=1"></noscript><script type="text/javascript" id="">(function(){window.medalliaUserIdentifier=document.documentElement.dataset.userUuid;window.medalliaUserName=document.documentElement.dataset.username})();</script>
<script type="text/javascript" id="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/embed.js"></script>
<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","443792972845831");fbq("set","agent","tmgoogletagmanager","443792972845831");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=443792972845831&amp;ev=PageView&amp;noscript=1"></noscript>

<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","443792972845831");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=443792972845831&amp;ev=PageView&amp;noscript=1"></noscript>
<script type="text/javascript" id="">window._pp=window._pp||[];if("\/library\/view\/securing-the-perimeter\/9781484226018\/html\/425975_1_En_4_Chapter.xhtml"=="/confirmation/nnv/"&&"https:\/\/learning.oreilly.com\/library\/view\/securing-the-perimeter\/9781484226018\/html\/Cover.xhtml"=="https://learning.oreilly.com/register/")_pp.targetUrl="/confirm/trial";else if("\/library\/view\/securing-the-perimeter\/9781484226018\/html\/425975_1_En_4_Chapter.xhtml"=="/confirmation/nv/"&&"https:\/\/learning.oreilly.com\/library\/view\/securing-the-perimeter\/9781484226018\/html\/Cover.xhtml"=="https://learning.oreilly.com/subscribe/")_pp.targetUrl="/confirm/paid";else if("\/library\/view\/securing-the-perimeter\/9781484226018\/html\/425975_1_En_4_Chapter.xhtml"=="/confirmation/nnv/"&&"https:\/\/learning.oreilly.com\/library\/view\/securing-the-perimeter\/9781484226018\/html\/Cover.xhtml"=="https://learning.oreilly.com/signup/")_pp.targetUrl="/confirm/paid";_pp.siteId="2508";
_pp.siteUId="39a88cd5-54f5-4d61-aec6-7884d06dfba1";_pp.orderValue="undefined";_pp.orderId="undefined";(function(){var ppjs=document.createElement("script");ppjs.type="text/javascript";ppjs.async=true;ppjs.src=("https:"==document.location.protocol?"https:":"http:")+"//cdn.pbbl.co/r/"+_pp.siteId+".js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ppjs,s)})();</script><div class="annotator-notice"></div><div class="font-flyout" style="top: 151.006px; left: 1583px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_4_Chapter.xhtml#">Reset</a>
</div>
</div><iframe id="nr-ext-rsicon" style="position: absolute; display: none; width: 50px; height: 50px; z-index: 2147483647; border-style: none; background: transparent;" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource(5).html"></iframe><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.1722968407519636"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.9526668630207187" width="0" height="0" alt="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/0"></div><iframe height="0" width="0" frameborder="0" style="display: none;" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/pp.html"></iframe><script type="text/javascript" async="" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/generic1585109433606.js" charset="UTF-8"></script><div style="display: none; visibility: hidden;"><script>(function(){if(null!==document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]')&&void 0!==document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]')){var a=!1;window.addEventListener("blur",function(){a&&dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"facebook",eventVal:0,nonInteraction:0})});document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]').addEventListener("mouseover",function(){window.focus();
a=!0});document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]').addEventListener("mouseout",function(){a=!1})}if(null!==document.querySelector("iframe.twitter-share-button")&&void 0!==document.querySelector("iframe.twitter-share-button")){var b=!1;window.addEventListener("blur",function(){b&&dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"twitter",eventVal:0,nonInteraction:0})});document.querySelector("iframe.twitter-share-button").addEventListener("mouseover",
function(){window.focus();b=!0});document.querySelector("iframe.twitter-share-button").addEventListener("mouseout",function(){b=!1})}try{window.twttr=function(a,b,d){var c,e=a.getElementsByTagName(b)[0];if(!a.getElementById(d))return a=a.createElement(b),a.id=d,a.src="//platform.twitter.com/widgets.js",e.parentNode.insertBefore(a,e),window.twttr||(c={_e:[],ready:function(a){c._e.push(a)}})}(document,"script","twitter-wjs"),twttr.ready(function(a){a.events.bind("tweet",trackTwitter)})}catch(c){}})();
null!==document.querySelector(".IN-widget")&&void 0!==document.querySelector(".IN-widget")&&document.querySelector(".IN-widget").addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"linkedin",eventVal:0,nonInteraction:0})});
function trackTwitter(a){a&&(a.target&&"IFRAME"==a.target.nodeName&&(opt_target=extractParamFromUri(a.target.src,"url")),dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"twitter",eventVal:0,nonInteraction:0}))}function extractParamFromUri(a,b){if(a&&(b=new RegExp("[\\?\x26#]"+b+"\x3d([^\x26#]*)"),a=b.exec(a),null!=a))return unescape(a[1])};</script></div><script type="text/javascript" id="">function forceInputUppercase(a){var b=a.target.selectionStart,c=a.target.selectionEnd;a.target.value=a.target.value.toUpperCase();a.target.setSelectionRange(b,c)}void 0!=document.getElementById("id_promotion")&&null!=document.getElementById("id_promotion")&&document.getElementById("id_promotion").addEventListener("keyup",forceInputUppercase,!1);
void 0!=document.getElementsByName("promotionCode")[0]&&null!=document.getElementsByName("promotionCode")[0]&&document.getElementsByName("promotionCode")[0].addEventListener("keyup",forceInputUppercase,!1);</script><script type="text/javascript" id="">var nonwExpandable=document.querySelectorAll(".orm-ff-NavigationSubnav-headerListItem a, .orm-ff-NavigationView-headerListItem a");nonwExpandable.forEach(function(a,b){b+1!=nonwExpandable.length?a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.childNodes[1].textContent})}):b+1==nonwExpandable.length&&a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"user login",eventAct:"logout",eventLbl:"global nav | unified"})})});
var nonwExpandableFo=document.querySelectorAll(".drop-content li:not(.flyout-parent) a");
nonwExpandableFo.forEach(function(a,b){"drop-content"==a.parentNode.parentNode.parentNode.className&&b+1!=nonwExpandableFo.length?a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.childNodes[1].textContent})}):"drop-content"==a.parentNode.parentNode.parentNode.className&&b+1==nonwExpandableFo.length&&a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"user login",eventAct:"logout",eventLbl:"global nav | unified"})})});
var expandable=document.querySelectorAll(".orm-ff-NavigationSubnav-toggleControls a, .orm-ff-NavigationView-toggleControls a");expandable.forEach(function(a){a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.parentNode.parentNode.parentNode.querySelectorAll(".orm-Button-btnContentWrap span")[0].childNodes[1].textContent+" | "+a.textContent})})});var flyoutLinks=document.querySelectorAll(".flyout a");
flyoutLinks.forEach(function(a){a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.closest("li.flyout-parent").getElementsByTagName("a")[0].textContent+" | "+a.textContent})})});</script><span></span><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./4. OAuth - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/widget_iframe.d0f13be8321eb432fba28cfc1c3351b1.html" title="Twitter settings iframe" style="display: none;"></iframe><div id="eJOY__extension_root" style="all: unset;"></div></body><div class="XTranslate"></div></html>