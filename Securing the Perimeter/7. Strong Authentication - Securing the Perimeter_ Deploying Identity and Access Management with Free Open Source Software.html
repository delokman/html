<!DOCTYPE html>
<!-- saved from url=(0111)https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml -->
<html class="js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom fa-events-icons-ready" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="6866040" data-user-uuid="39a88cd5-54f5-4d61-aec6-7884d06dfba1" data-username="vrad201" data-account-type="Trial" data-activated-trial-date="04/04/2020" data-archive="9781484226018" data-publishers="Apress" data-htmlfile-name="425975_1_En_7_Chapter.xhtml" data-epub-title="Securing the Perimeter: Deploying Identity and Access Management with Free Open Source Software" data-debug="0" data-testing="0" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Safari Books Online"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781484226018"><link rel="shortcut icon" href="https://www.oreilly.com/favicon.ico"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><script id="twitter-wjs" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/widgets.js"></script><script type="text/javascript" async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/cool-2.1.15.min.js"></script><script type="text/javascript" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/510f1a6865"></script><script src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/nr-1167.min.js"></script><script type="text/javascript" async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/ec.js"></script><script type="text/javascript" async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/2508.js"></script><script src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/443792972845831" async=""></script><script src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/1732687426968531" async=""></script><script async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/fbevents.js"></script><script type="text/javascript" async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f.txt"></script><script type="text/javascript" async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/analytics.js"></script><script type="text/javascript" async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/bat.js"></script><script type="text/javascript" async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f.txt"></script><script type="text/javascript" async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/insight.min.js"></script><script type="text/javascript" async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f.txt"></script><script crossorigin="anonymous" integrity="sha256-4ZnAISy2+rbOaVUOBtJrqxBTrJ5kctu9r4qBJBt0Oo0=" type="text/javascript" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/appcues.main.40a6b605d29a66b083aa6d74c07bb73eae19e31b.js" async=""></script><script async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/gtm.js"></script><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={licenseKey:"510f1a6865",applicationID:"172641827"};window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var i=n[t]={exports:{}};e[t][0].call(i.exports,function(n){var i=e[t][1][n];return r(i||n)},i,i.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<t.length;i++)r(t[i]);return r}({1:[function(e,n,t){function r(){}function i(e,n,t){return function(){return o(e,[u.now()].concat(f(arguments)),n?null:this,t),n?void 0:this}}var o=e("handle"),a=e(4),f=e(5),c=e("ee").get("tracer"),u=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",d=l+"ixn-";a(p,function(e,n){s[n]=i(l+n,!0,"api")}),s.addPageAction=i(l+"addPageAction",!0),s.setCurrentRouteName=i(l+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,i="function"==typeof n;return o(d+"tracer",[u.now(),e,t],r),function(){if(c.emit((i?"":"no-")+"fn-start",[u.now(),r,i],t),i)try{return n.apply(this,arguments)}catch(e){throw c.emit("fn-err",[arguments,this,e],t),e}finally{c.emit("fn-end",[u.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=i(d+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),o("err",[e,u.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){var t=e.getEntries();t.forEach(function(e){"first-paint"===e.name?c("timing",["fp",Math.floor(e.startTime)]):"first-contentful-paint"===e.name&&c("timing",["fcp",Math.floor(e.startTime)])})}function i(e,n){var t=e.getEntries();t.length>0&&c("lcp",[t[t.length-1]])}function o(e){if(e instanceof s&&!l){var n,t=Math.round(e.timeStamp);n=t>1e12?Date.now()-t:u.now()-t,l=!0,c("timing",["fi",t,{type:e.type,fid:n}])}}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var a,f,c=e("handle"),u=e("loader"),s=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){a=new PerformanceObserver(r),f=new PerformanceObserver(i);try{a.observe({entryTypes:["paint"]}),f.observe({entryTypes:["largest-contentful-paint"]})}catch(p){}}if("addEventListener"in document){var l=!1,d=["click","keydown","mousedown","pointerdown","touchstart"];d.forEach(function(e){document.addEventListener(e,o,!1)})}}},{}],3:[function(e,n,t){function r(e,n){if(!i)return!1;if(e!==i)return!1;if(!n)return!0;if(!o)return!1;for(var t=o.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var f=navigator.userAgent,c=f.match(a);c&&f.indexOf("Chrome")===-1&&f.indexOf("Chromium")===-1&&(i="Safari",o=c[1])}n.exports={agent:i,version:o,match:r}},{}],4:[function(e,n,t){function r(e,n){var t=[],r="",o=0;for(r in e)i.call(e,r)&&(t[o]=n(r,e[r]),o+=1);return t}var i=Object.prototype.hasOwnProperty;n.exports=r},{}],5:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,i=t-n||0,o=Array(i<0?0:i);++r<i;)o[r]=e[n+r];return o}n.exports=r},{}],6:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function i(e){function n(e){return e&&e instanceof r?e:e?c(e,f,o):o()}function t(t,r,i,o){if(!l.aborted||o){e&&e(t,r,i);for(var a=n(i),f=v(t),c=f.length,u=0;u<c;u++)f[u].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function d(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||i(t)}function w(e,n){u(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:d,addEventListener:d,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function o(){return new r}function a(){(s.api||s.feature)&&(l.aborted=!0,s=l.backlog={})}var f="nr@context",c=e("gos"),u=e(4),s={},p={},l=n.exports=i();l.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(i.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return e[n]=r,r}var i=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){i.buffer([e],r),i.emit(e,n,t)}var i=e("ee").get("handle");n.exports=r,r.ee=i},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,o,function(){return i++})}var i=1,o="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!x++){var e=E.info=NREUM.info,n=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();u(y,function(n,t){e[n]||(e[n]=t)}),c("mark",["onload",a()+E.offset],null,"api");var t=d.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function i(){"complete"===d.readyState&&o()}function o(){c("mark",["domContent",a()+E.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(f=Math.max((new Date).getTime(),f))-E.offset}var f=(new Date).getTime(),c=e("handle"),u=e(4),s=e("ee"),p=e(3),l=window,d=l.document,m="addEventListener",v="attachEvent",g=l.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:l.setImmediate,CT:clearTimeout,XHR:g,REQ:l.Request,EV:l.Event,PR:l.Promise,MO:l.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1167.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),E=n.exports={offset:f,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),e(2),d[m]?(d[m]("DOMContentLoaded",o,!1),l[m]("load",r,!1)):(d[v]("onreadystatechange",i),l[v]("onload",r)),c("mark",["firstbyte",f],null,"api");var x=0,O=e(6)},{}],"wrap-function":[function(e,n,t){function r(e){return!(e&&e instanceof Function&&e.apply&&!e[a])}var i=e("ee"),o=e(5),a="nr@original",f=Object.prototype.hasOwnProperty,c=!1;n.exports=function(e,n){function t(e,n,t,i){function nrWrapper(){var r,a,f,c;try{a=this,r=o(arguments),f="function"==typeof t?t(r,a):t||{}}catch(u){l([u,"",[r,a,i],f])}s(n+"start",[r,a,i],f);try{return c=e.apply(a,r)}catch(p){throw s(n+"err",[r,a,p],f),p}finally{s(n+"end",[r,a,c],f)}}return r(e)?e:(n||(n=""),nrWrapper[a]=e,p(e,nrWrapper),nrWrapper)}function u(e,n,i,o){i||(i="");var a,f,c,u="-"===i.charAt(0);for(c=0;c<n.length;c++)f=n[c],a=e[f],r(a)||(e[f]=t(a,u?f+i:i,o,f))}function s(t,r,i){if(!c||n){var o=c;c=!0;try{e.emit(t,r,i,n)}catch(a){l([a,t,r,i])}c=o}}function p(e,n){if(Object.defineProperty&&Object.keys)try{var t=Object.keys(e);return t.forEach(function(t){Object.defineProperty(n,t,{get:function(){return e[t]},set:function(n){return e[t]=n,n}})}),n}catch(r){l([r])}for(var i in e)f.call(e,i)&&(n[i]=e[i]);return n}function l(n){try{e.emit("internal-error",n)}catch(t){}}return e||(e=i),t.inPlace=u,t.flag=a,t}},{}]},{},["loader"]);</script><link rel="shortcut icon" href="https://learning.oreilly.com/favicon.ico" type="image/x-icon"><link href="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/css" rel="stylesheet" type="text/css"><title>7.&nbsp;Strong Authentication - Securing the Perimeter: Deploying Identity and Access Management with Free Open Source Software</title><link rel="stylesheet" href="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/output.8054605313ed.css" type="text/css"><link rel="stylesheet" type="text/css" href="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/annotator.e3b0c44298fc.css"><link rel="stylesheet" href="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/font-awesome.min.css"><style type="text/css" title="ibis-book">
    #sbo-rt-content a{text-decoration:none}#sbo-rt-content a:link,#sbo-rt-content a:active{color:#0176C3}#sbo-rt-content a:visited{color:#5f5f5f}#sbo-rt-content div{font-family:"Cambria","Minion Pro","Times New Roman","Times",serif;}#sbo-rt-content img{border:0;vertical-align:middle}#sbo-rt-content video{display:block;margin-top:1em;max-width:100%;text-indent:0;width:100%}#sbo-rt-content p{margin:0}#sbo-rt-content .Heading,#sbo-rt-content .SubHeading,#sbo-rt-content .ContextInformation,#sbo-rt-content .MainTitleSection,#sbo-rt-content .PartTitle,#sbo-rt-content .SeriesTitle,#sbo-rt-content .SeriesSubTitle,#sbo-rt-content .SubSeriesTitle,#sbo-rt-content .SubSeriesSubTitle,#sbo-rt-content .BookTitle,#sbo-rt-content .BookSubTitle,#sbo-rt-content .ForewordTitle,#sbo-rt-content .PrefaceTitle,#sbo-rt-content .BookAcknowledgmentsTitle,#sbo-rt-content .BookNotesTitle{text-align:left !important}#sbo-rt-content .Heading,#sbo-rt-content .SubHeading{display:block;font-weight:bold}#sbo-rt-content .ArticleContextInformation{border-bottom:1px solid;margin-bottom:.8em;padding-bottom:.3em}#sbo-rt-content .ArticleContextInformation .ContextInformation{display:block;font-size:80%}#sbo-rt-content .ArticleContextInformation .JournalTitle:after,#sbo-rt-content .ArticleContextInformation .JournalSubTitle:after{content:", "}#sbo-rt-content .ArticleCopyright{display:inline}#sbo-rt-content .ArticleCopyright .CopyrightComment,#sbo-rt-content .ArticleContextInformation .ArticleDOI{display:block}#sbo-rt-content .ChapterContextInformation{border-bottom:1px solid;margin-bottom:.8em;padding-bottom:.3em}#sbo-rt-content .ChapterContextInformation .ContextInformation{display:block;font-size:80%}#sbo-rt-content .ChapterCopyright .CopyrightComment{display:block}#sbo-rt-content .ChapterContextInformation .BookEdition:before{content:", "}#sbo-rt-content .ChapterContextInformation .ContextInformationAuthorEditorNames:after{content:", "}#sbo-rt-content .ChapterContextInformation .BookTitle{font-style:italic}#sbo-rt-content .ChapterContextInformation .SeriesTitle:before{content:", "}#sbo-rt-content .ChapterContextInformation .SeriesSubTitle:before{content:": "}#sbo-rt-content .ChapterContextInformation .ContextInformationVolumeNumber:before{content:" "}#sbo-rt-content .ChapterContextInformation .ChapterDOI{display:block}#sbo-rt-content .Categories{color:#666;margin-bottom:1em;margin-top:1em}#sbo-rt-content .ArticleCategory,#sbo-rt-content .ChapterCategory{font-size:1.2rem}#sbo-rt-content .ArticleSubCategory,#sbo-rt-content .ChapterSubCategory{font-size:1rem}#sbo-rt-content .MainTitleSection{font-weight:bold;margin-bottom:1.2em;margin-top:1.2em}#sbo-rt-content .ArticleSuperTitle{font-size:1.2rem}#sbo-rt-content .MainTitleSection .ArticleTitle,#sbo-rt-content .ForeignLanguageHeader .ArticleTitle,#sbo-rt-content .MainTitleSection .ChapterTitle,#sbo-rt-content .ForeignLanguageHeader .ChapterTitle{font-size:1.73rem;margin:0}#sbo-rt-content .ArticleSubTitle,#sbo-rt-content .ChapterSubTitle{font-size:1.2rem;padding-top:.2em}#sbo-rt-content div>.AuthorGroup .AuthorNames,#sbo-rt-content .BookBackmatter>.AuthorGroup .AuthorNames{font-size:100%;margin-bottom:1em;margin-top:1em;text-align:left !important}#sbo-rt-content .BookBackmatter>.AuthorGroup .AuthorNames{font-weight:bold}#sbo-rt-content .AuthorNames sup{font-size:70%}#sbo-rt-content .Prefix:after{content:" "}#sbo-rt-content .Suffix:before{content:" "}#sbo-rt-content .Degrees:before{content:", "}#sbo-rt-content .NativeName:before,#sbo-rt-content .Role:before{content:" ("}#sbo-rt-content .NativeName:after,#sbo-rt-content .Role:after{content:")"}#sbo-rt-content .AffiliationNumber{float:left;padding-right:.5em}#sbo-rt-content .AffiliationText{margin-left:2em}#sbo-rt-content .AffiliationHint{font-style:italic}#sbo-rt-content .AuthorNames .DeceasedSymbol:before{content:"†";padding-left:3px}#sbo-rt-content .AuthorNames .EqualContributionSymbol:before{content:"*";padding-left:3px}#sbo-rt-content .InstitutionMembers:before{content:" ("}#sbo-rt-content .InstitutionMembers:after{content:")"}#sbo-rt-content .AffiliationLegend .DeceasedSymbol:before{content:"†";display:inline-block;width:14px}#sbo-rt-content .AffiliationLegend .EqualContributionSymbol:before{content:"*";display:inline-block;width:14px}#sbo-rt-content .ClearBoth{clear:both;font-size:0;line-height:0 !important}#sbo-rt-content .Contact,#sbo-rt-content .AffiliationLegend{margin-bottom:1em;margin-top:1em}#sbo-rt-content .ContactIcon{background-image:url(envelope.png);background-repeat:no-repeat;background-size:contain;width:.8rem}#sbo-rt-content .AuthorNames .ContactIcon{display:inline-block}#sbo-rt-content .Contact .ContactIcon{float:left;margin-top:4px;margin-right:4px}#sbo-rt-content .ContactAuthorLine{padding-left:20px;font-weight:bold}#sbo-rt-content .ContactAdditionalLine{padding-left:20px}#sbo-rt-content .ContactType{font-weight:bold}#sbo-rt-content .ArticleHistory{margin-bottom:1em;margin-top:1em}#sbo-rt-content .HistoryLabel{font-weight:bold}#sbo-rt-content .History+.History{padding-left:.5em}#sbo-rt-content .ArticleOrChapterToc{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .ArticleOrChapterToc .HeadingNumber{font-weight:bold;padding-right:.3em}#sbo-rt-content .Abstract{margin-top:1em}#sbo-rt-content .Abstract>.Heading{font-size:1em;margin:0}#sbo-rt-content .AbstractSection{margin-top:.3em}#sbo-rt-content .Heading+.AbstractSection{margin-top:0}#sbo-rt-content .AbstractSection>.Heading{font-size:1em;font-style:italic;font-weight:normal;margin:0}#sbo-rt-content .KeywordGroup{margin-top:1em}#sbo-rt-content .KeywordGroup .Heading{display:inline;font-size:1em;margin:0;padding-right:.5em}#sbo-rt-content .Keyword+.Keyword:before{content:" – "}#sbo-rt-content .ArticleExternalID{margin-top:1em}#sbo-rt-content .ArticleExternalIDLabel{font-weight:bold}#sbo-rt-content .ForeignLanguageHeader{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .ForeignLanguageTitleSection{font-weight:bold;margin-bottom:1.2em;margin-top:1rem}#sbo-rt-content .AbbreviationGroup{margin-top:1em}#sbo-rt-content .ForeignLanguageHeader+.AbbreviationGroup{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .AbbreviationGroup>.Heading{font-size:1em;margin:0}#sbo-rt-content .AbbreviationGroup .DefinitionList{margin-top:0;margin-bottom:0;padding-right:.1em;padding-top:.1em;padding-bottom:.1em}#sbo-rt-content .AbbreviationGroupSection>.Heading{font-size:1em;margin:0;padding-top:.2em}#sbo-rt-content .ArticleNote{margin-top:1em}#sbo-rt-content .ArticleNote>.Heading{font-size:1em;margin:0}#sbo-rt-content .ArticleNoteMotto{font-style:italic;margin-left:1.5em;margin-right:1.5em;text-align:right}#sbo-rt-content .Biography{display:block;margin-top:.8em;padding-bottom:0;width:100%}#sbo-rt-content .Loc .AuthorGroup .Biography{margin-top:0}#sbo-rt-content .Biography .FormalPara,#sbo-rt-content .Biography .BiographyFigure{display:block;margin-top:0;margin-bottom:0}#sbo-rt-content .Biography .BiographyFigure{float:right;margin-left:6px}#sbo-rt-content .Biography .Figure{border-bottom:none;margin-top:.5em;margin-bottom:0}#sbo-rt-content .Fulltext>.Para:first-of-type>.BlockQuote:first-child{margin-top:0}#sbo-rt-content .BlockQuote{margin:1em 1.5em}#sbo-rt-content .BlockQuote>.Heading{font-size:1em;margin-top:1em;margin-bottom:0;text-indent:0}#sbo-rt-content .BlockQuote>.Para{text-indent:0}#sbo-rt-content .Heading+.Para>.BlockQuote:first-child{margin-top:0}#sbo-rt-content .Caption,#sbo-rt-content .TableFooter{display:block;text-align:left}#sbo-rt-content .TableFooter .SimplePara+.SimplePara{text-indent:0}#sbo-rt-content .Caption{margin-top:.5em}#sbo-rt-content .CaptionContent{font-size:90%}#sbo-rt-content .TableFooter{margin-top:1em}#sbo-rt-content .Table .Caption{margin-top:.5em}#sbo-rt-content .Figure .Caption,#sbo-rt-content video+.Caption{margin-bottom:1em}#sbo-rt-content .Table .Caption{margin-bottom:.5em}#sbo-rt-content .CaptionNumber{font-style:italic;font-weight:bold;padding-right:.6em}#sbo-rt-content .CaptionContent>span.Heading{display:inline}#sbo-rt-content .CaptionContent>span.SimplePara{display:block}#sbo-rt-content .CaptionContent>.SimplePara:first-child,#sbo-rt-content .CaptionContent>.CaptionNumber+.SimplePara,#sbo-rt-content .CaptionContent>a+.SimplePara{display:inline;margin-top:0}#sbo-rt-content .Credit>.SimplePara{text-indent:1.5em}#sbo-rt-content .DefinitionList{margin-top:1em;margin-bottom:1em;padding:.1em}#sbo-rt-content .DefinitionList>.Heading{font-size:1rem;margin:0;text-indent:0}#sbo-rt-content dl{margin:0}#sbo-rt-content .DefinitionList:after{content:"";clear:both;display:table}#sbo-rt-content .Term{clear:both;float:left;font-style:italic;padding-right:1em;text-indent:0;vertical-align:top}#sbo-rt-content .Description{padding-bottom:.3em;margin-left:0}#sbo-rt-content .Description .Para:first-child{text-indent:0}#sbo-rt-content .Heading+.Para>div.DefinitionList:first-child{margin-top:0}#sbo-rt-content .EmphasisTypeBold{font-weight:bold}#sbo-rt-content .EmphasisTypeItalic{font-style:italic}#sbo-rt-content .EmphasisTypeUnderline{text-decoration:underline}#sbo-rt-content .EmphasisTypeDoubleUnderline{border-bottom-style:double}#sbo-rt-content .EmphasisTypeSmallCaps{font-variant:small-caps}#sbo-rt-content .EmphasisTypeBoldItalic{font-weight:bold;font-style:italic}#sbo-rt-content .EmphasisTypeBoldUnderline{font-weight:bold;text-decoration:underline}#sbo-rt-content .EmphasisTypeBoldDoubleUnderline{font-weight:bold;border-bottom-style:double}#sbo-rt-content .EmphasisTypeBoldSmallCaps{font-weight:bold;font-variant:small-caps}#sbo-rt-content .EmphasisTypeItalicUnderline{font-style:italic;text-decoration:underline}#sbo-rt-content .EmphasisTypeItalicDoubleUnderline{font-style:italic;border-bottom-style:double}#sbo-rt-content .EmphasisTypeItalicSmallCaps{font-style:italic;font-variant:small-caps}#sbo-rt-content .EmphasisTypeBoldItalicUnderline{font-weight:bold;font-style:italic;text-decoration:underline}#sbo-rt-content .EmphasisTypeBoldItalicDoubleUnderline{font-weight:bold;font-style:italic;border-bottom-style:double}#sbo-rt-content .EmphasisTypeBoldItalicSmallCaps{font-weight:bold;font-style:italic;font-variant:small-caps}#sbo-rt-content .EmphasisTypeUnderlineSmallCaps{text-decoration:underline;font-variant:small-caps}#sbo-rt-content .EmphasisTypeDoubleUnderlineSmallCaps{border-bottom-style:double;font-variant:small-caps}#sbo-rt-content .EmphasisFontCategoryNonProportional{font-family:"Courier New",Courier,monospace}#sbo-rt-content :not(.ParaTypeProgramcode)>.EmphasisFontCategoryNonProportional{font-size:95%}#sbo-rt-content .EmphasisFontCategorySansSerif{font-family:"Arial","Helvetica",sans-serif;font-size:75%}#sbo-rt-content .EmphasisTypeStrikethrough{text-decoration:line-through}#sbo-rt-content .Equation{display:block;text-indent:0;vertical-align:middle}#sbo-rt-content .NumberedEquation{display:table;width:100%}#sbo-rt-content .NumberedEquation .EquationWrapper{display:table-row}#sbo-rt-content .NumberedEquation .EquationContent{display:table-cell}#sbo-rt-content .EquationContent{margin-top:.5em;margin-bottom:0;width:100%;text-align:center;text-indent:0;vertical-align:middle}#sbo-rt-content .EquationContent div{margin-top:.5em}#sbo-rt-content .EquationContent .MediaObject{margin-left:auto;margin-right:auto}#sbo-rt-content .EquationContent img{background:white;max-width:100%}#sbo-rt-content .EquationNumber{display:table-cell;margin-bottom:.4em;text-align:right;vertical-align:middle}#sbo-rt-content .EquationSourceXml{white-space:nowrap}#sbo-rt-content .InlineEquation img{background:white;vertical-align:text-top}#sbo-rt-content .Figure{margin-top:1em;margin-bottom:1em;margin-left:0;margin-right:0;text-align:center;text-indent:0}#sbo-rt-content .Figure img{height:auto;margin:0;max-width:100%;padding:2px}#sbo-rt-content .MediaObject{display:block;text-align:center}#sbo-rt-content .MediaObject:last-child{margin-bottom:1em}#sbo-rt-content .EquationContent>.MediaObject:last-child{margin-bottom:0}#sbo-rt-content .MediaObject+.MediaObject{margin-top:1em}#sbo-rt-content .FootnoteSection{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .FootnoteSection>.Heading{font-size:1.44rem;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Footnote{clear:both;font-size:90%;text-align:left}#sbo-rt-content .FootnoteNumber{float:left;padding-right:.5em}#sbo-rt-content .FootnoteParas>div{margin-left:1em;margin-top:.3em}#sbo-rt-content .FormalPara{margin-top:1em;margin-bottom:1em}#sbo-rt-content .FormalPara .Heading{font-size:1em;margin:0}#sbo-rt-content .FormalParaRenderingStyle1>.Heading{display:inline;padding-right:1em}#sbo-rt-content .FormalParaRenderingStyle2>.Heading{display:inline;font-style:italic;font-weight:normal;padding-right:1em}#sbo-rt-content .FormalParaRenderingStyle3>.Heading{padding-right:1em}#sbo-rt-content .FormalParaRenderingStyle1>p:first-of-type,#sbo-rt-content .FormalParaRenderingStyle2>p:first-of-type{display:inline}#sbo-rt-content .Heading+.FormalPara{margin-top:0}#sbo-rt-content .FormalPara .AuthorNames{font-style:italic;font-weight:normal !important}#sbo-rt-content .HeadingNumber{padding-right:.3em}#sbo-rt-content .RenderAsSection1>.Heading{font-size:1.44rem;margin-top:.5em;margin-bottom:.1em}#sbo-rt-content .RenderAsSection2>.Heading{font-size:1.2rem;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section2>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection3>.Heading{font-size:1.2rem;font-style:italic;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section3>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection4>.Heading{font-size:100%;font-style:italic;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section4>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection5>.Heading{font-size:100%;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section5>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection6>.Heading{font-size:100%;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section6>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection7>.Heading{font-size:100%;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section7>.Heading:first-child{margin-top:0}#sbo-rt-content .Literal{font-family:"Courier New",Courier,monospace}#sbo-rt-content .OrderedList{margin-top:.5em;margin-bottom:.5em;text-indent:0;display:table}#sbo-rt-content .OrderedList>ol{margin:0;padding:0}#sbo-rt-content .OrderedList .Heading{font-size:1em;font-style:italic;font-weight:normal;margin-top:0;margin-bottom:0;display:table-caption}#sbo-rt-content .OrderedList .Heading+.ListItem{margin-top:0}#sbo-rt-content .Heading+.Para>div.OrderedList:first-child,#sbo-rt-content .Heading+.Para>div.OrderedList:first-child>.Heading{margin-top:0}#sbo-rt-content .ListItem{margin-top:.5em;display:table-row}#sbo-rt-content .ItemNumber{padding-right:.5em;display:table-cell;vertical-align:top}#sbo-rt-content .ItemContent{display:table-cell}#sbo-rt-content .Fulltext>.Para:first-of-type{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .Fulltext>.Para~.Para:first-of-type{border-top:none;margin-top:0;padding-top:0}#sbo-rt-content .Para+.Para{margin-top:0;text-indent:1.5em}#sbo-rt-content .ParaTextBreak{margin-top:1em !important;text-indent:0 !important}#sbo-rt-content .ParaTypeExample{border-left:4px solid;padding-left:.5em;margin-top:1em !important;margin-bottom:1em}#sbo-rt-content .ParaTypeEyeCatcher,#sbo-rt-content .ParaTypeTip{border-left:4px solid;padding-left:.5em;margin-top:1em !important;margin-bottom:.5em}#sbo-rt-content .ParaTypeImportant{background:#bbb;border:2px solid;padding:.5em;margin-top:.8em !important;margin-bottom:.8em}#sbo-rt-content .ParaTypeImportant img{background-color:transparent}#sbo-rt-content .ParaTypeGeneticSequence,#sbo-rt-content .ParaTypeLiteral,#sbo-rt-content .ParaTypeProgramcode{font-family:"Courier New",Courier,monospace;font-size:95%}#sbo-rt-content .ParaTypeProgramcode{text-indent:0 !important;word-wrap:break-word}#sbo-rt-content .Para:not(.ParaTypeProgramcode)+.ParaTypeProgramcode{margin-top:.5em}#sbo-rt-content .ParaTypeProgramcode+.Para:not(.ParaTypeProgramcode){margin-top:.5em}#sbo-rt-content .ParaTypeLegalText{font-weight:bold;margin-left:1em;text-align:left}#sbo-rt-content .ParaTypeOverview,#sbo-rt-content .ParaTypeAnswers,#sbo-rt-content .ParaTypeQuestions,#sbo-rt-content .ParaTypeDefinition,#sbo-rt-content .ParaTypeProcedure,#sbo-rt-content .ParaTypeRecipe{border:2px solid;margin-top:.8em !important;margin-bottom:.8em;padding:.5em}#sbo-rt-content .ParaTypeSource{font-style:italic}#sbo-rt-content .ParaTypeTrailer,#sbo-rt-content .ParaTypeLearningGoals{font-weight:bold;padding-left:.5em;padding-right:.5em}#sbo-rt-content .ParaTypeWarning{font-weight:bold}#sbo-rt-content .ParaTypeExample,#sbo-rt-content .ParaTypeEyeCatcher,#sbo-rt-content .ParaTypeImportant,#sbo-rt-content .ParaTypeLegalText,#sbo-rt-content .ParaTypeOverview,#sbo-rt-content .ParaTypeTip,#sbo-rt-content .ParaTypeAnswers,#sbo-rt-content .ParaTypeQuestions,#sbo-rt-content .ParaTypeDefinition,#sbo-rt-content .ParaTypeProcedure,#sbo-rt-content .ParaTypeRecipe{text-indent:0 !important}#sbo-rt-content .Para+.ParaOneEmphasisChild{margin-top:1em;text-indent:0 !important}#sbo-rt-content .ParaOneEmphasisChild+.Para{text-indent:0 !important}#sbo-rt-content .PartNumber{display:block;font-size:1.73rem}#sbo-rt-content .PartTitle{display:block;font-size:1.73rem}#sbo-rt-content .SubPartTitle{display:block;font-size:1.44rem}#sbo-rt-content .ProgramCode{margin-top:1em;margin-bottom:1em}#sbo-rt-content .ProgramCode .FixedLine{font-family:"Courier New",Courier,monospace;font-size:95%;word-wrap:break-word}#sbo-rt-content .LineGroup+.LineGroup{margin-top:1em}#sbo-rt-content .Heading+.Para>.Quiz>.Heading{margin-top:0;}#sbo-rt-content .Quiz .Heading{font-size:1rem;margin-top:1em;margin-bottom:0;text-indent:0}#sbo-rt-content .QuizTask{display:table;margin-top:.5em;margin-bottom:.5em;width:100%;text-indent:0}#sbo-rt-content .QuizTask+.QuizTask{margin-top:1.5em}#sbo-rt-content .QuizItem{padding:.1em}#sbo-rt-content .QuizItemTypeSolution{border:2px solid #aaa;margin-top:.5em;padding:10px}#sbo-rt-content .QuizTask>input{display:none}#sbo-rt-content .QuizItem>label{color:#0176C3}#sbo-rt-content .QuizTask>input~.QuizItem>label+div{display:none}#sbo-rt-content .QuizTask>input:checked~.QuizItem>label+div{display:table-cell}#sbo-rt-content .QuizTask>input~.QuizItem>label:after{content:"  »"}#sbo-rt-content .QuizTask>input:checked~.QuizItem>label:after{content:"  «"}#sbo-rt-content .QuizTask>input~.QuizItemTypeCorrectAnswer{background-color:transparent;transition:background .4s}#sbo-rt-content .QuizTask>input:checked~.QuizItemTypeCorrectAnswer{background-color:#EAF2DB;transition:background .4s}#sbo-rt-content .ReviewTitle{font-weight:bold;margin-top:1em;text-indent:0}#sbo-rt-content .Review .AuthorName+.AuthorName:before{content:", "}#sbo-rt-content .Review .ISBN,#sbo-rt-content .ReviewDataUnstructured{text-indent:0}#sbo-rt-content .Review .Para:first-of-type{margin-top:1em;text-indent:0}#sbo-rt-content .BookBackmatter>.Appendix:first-child>div:first-child{border-top:none !important;margin-top:0 !important;padding-top:0 !important}#sbo-rt-content .BookAcknowledgmentsBody>.RenderAsSection1:first-child,#sbo-rt-content .BookNotesBody>.RenderAsSection1:first-child,#sbo-rt-content .ForewordBody>.RenderAsSection1:first-child,#sbo-rt-content .PrefaceBody>.RenderAsSection1:first-child,#sbo-rt-content .BookBackmatter>.Appendix:first-child>.RenderAsSection1:first-child{border-top:none;margin-top:0}#sbo-rt-content .BookAcknowledgmentsBody>.RenderAsSection1:first-child>.Heading,#sbo-rt-content .ForewordBody>.RenderAsSection1:first-child>.Heading,#sbo-rt-content .PrefaceBody>.RenderAsSection1:first-child>.Heading{margin-top:0}#sbo-rt-content .Section1 .AuthorNames,#sbo-rt-content .Section2 .AuthorNames,#sbo-rt-content .Section3 .AuthorNames{font-weight:bold;margin-top:.3em;margin-bottom:.5em}#sbo-rt-content .Section1 .AuthorNames sup,#sbo-rt-content .Section2 .AuthorNames sup,#sbo-rt-content .Section3 .AuthorNames sup{font-size:70%}#sbo-rt-content .Section1 .Affiliations,#sbo-rt-content .Section2 .Affiliations,#sbo-rt-content .Section3 .Affiliations{margin-bottom:.5em}#sbo-rt-content .SectionTypeBackgroundInformation,#sbo-rt-content .SectionTypeExcurse{font-size:90%}#sbo-rt-content .SectionTypeBox,#sbo-rt-content .SectionTypeOverview,#sbo-rt-content .SectionTypeQuestionnaire{background-color:#BBB;margin-top:1em !important;padding:.5em}#sbo-rt-content .SectionTypeCaseStudy,#sbo-rt-content .SectionTypeExample,#sbo-rt-content .SectionTypeTip{border-left:4px solid;margin-top:1em !important;padding-top:0;padding-left:.5em;padding-right:.5em;padding-bottom:.5em}#sbo-rt-content .SectionTypeTrailer,#sbo-rt-content .SectionTypeLearningGoals{font-weight:bold;text-align:left}#sbo-rt-content .SectionTypeLegalText{font-weight:bold;margin-left:1em;text-align:left;text-indent:0 !important}#sbo-rt-content .SectionTypeProcedure,#sbo-rt-content .SectionTypeRecipe{border:2px solid;margin-top:.8em !important;margin-bottom:.8em;padding:.5em}#sbo-rt-content .SectionTypeWarning{font-weight:bold}#sbo-rt-content .RenderAsSection1{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .SectionTypeBox+.RenderAsSection1,#sbo-rt-content .SectionTypeOverview+.RenderAsSection1,#sbo-rt-content .SectionTypeQuestionnaire+.RenderAsSection1{border-top:0;}#sbo-rt-content .SectionTypeBox>.Heading,#sbo-rt-content .SectionTypeOverview>.Heading,#sbo-rt-content .SectionTypeQuestionnaire>.Heading,#sbo-rt-content .SectionTypeProcedure>.Heading,#sbo-rt-content .SectionTypeRecipe>.Heading{margin-top:0}#sbo-rt-content .InternalRefSidebarLexicon{background-image:url(sidebar.gif);background-repeat:no-repeat;font-weight:bold;padding-left:20px}#sbo-rt-content .SidebarDialog{border:1px solid;margin-left:1.5em;margin-top:.4em;margin-bottom:.2em;padding:.2em;text-indent:0}#sbo-rt-content .SidebarNumber{font-weight:bold;padding-right:.5em}#sbo-rt-content .SimplePara+.SimplePara{margin-top:0;text-indent:1.5em}#sbo-rt-content .Stack{display:inline-table;vertical-align:top}#sbo-rt-content .Stack sub{display:table-row}#sbo-rt-content .Stack sup{display:table-header-group}#sbo-rt-content table{border-collapse:collapse;font-size:80%;max-width:100%;text-indent:0}#sbo-rt-content table .SimplePara+.SimplePara{text-indent:0}#sbo-rt-content table,#sbo-rt-content tr,#sbo-rt-content td{border-color:#bbb !important}#sbo-rt-content th{border-color:#999 !important}#sbo-rt-content thead{background:#bbb;color:#000 !important}#sbo-rt-content .Table{margin-bottom:1em;text-indent:0}#sbo-rt-content .Caption .Table{margin-bottom:0}#sbo-rt-content .Table img{height:auto;margin:0;max-width:100%}#sbo-rt-content th div{text-align:left}#sbo-rt-content td div,#sbo-rt-content td p,#sbo-rt-content th div,#sbo-rt-content th p{padding:.2em}#sbo-rt-content .Para+.Table,#sbo-rt-content .Para>.Table{margin-top:1em}#sbo-rt-content .SimplePara>.Table{margin-top:.5em}#sbo-rt-content thead,#sbo-rt-content tdiv{vertical-align:top}#sbo-rt-content tbody+tbody tr:first-child td{padding-top:1em}#sbo-rt-content .ExternalTable{background-color:#F8F8F8;border-top:1px solid;border-bottom:1px solid;margin-top:1em;margin-bottom:1em;padding-top:0;padding-bottom:0}#sbo-rt-content .ExternalTable .Table{padding-bottom:.3em}#sbo-rt-content .UnorderedList>.Heading{font-size:1em;font-style:italic;font-weight:normal;margin-top:0;margin-bottom:0}#sbo-rt-content .Heading+.Para>div.UnorderedList:first-child>.Heading{margin-top:0}#sbo-rt-content .UnorderedList li .Para:first-child{text-indent:0}#sbo-rt-content .Heading+ul{margin-top:0}#sbo-rt-content ul{margin-top:.5em;margin-bottom:.5em}#sbo-rt-content ul.UnorderedListMarkBullet{list-style-type:disc;padding-left:1em}#sbo-rt-content ul.UnorderedListMarkBullet div{margin-bottom:.3em}#sbo-rt-content ul.UnorderedListMarkBullet .Equation div{margin-bottom:0}#sbo-rt-content ul.UnorderedListMarkNone{list-style-type:none;padding-left:1em}#sbo-rt-content ul.UnorderedListMarkNone div{margin-bottom:.3em}#sbo-rt-content ul.UnorderedListMarkNone .Equation div{margin-bottom:0}#sbo-rt-content ul.UnorderedListMarkDash{list-style:none;padding-left:1.1em;text-indent:-.8em}#sbo-rt-content ul.UnorderedListMarkDash>li>*:first-child{display:inline}#sbo-rt-content ul.UnorderedListMarkDash div{text-indent:0;margin-top:.3em;margin-bottom:.3em}#sbo-rt-content ul.UnorderedListMarkDash>li:before{content:"– "}#sbo-rt-content .Verse{margin-top:1em;margin-bottom:1em}#sbo-rt-content .Verse .Heading{font-size:1rem;margin-top:1em;margin-bottom:1em;text-indent:0}#sbo-rt-content .Acknowledgments,#sbo-rt-content .AuthorContribution,#sbo-rt-content .Ethics{margin-top:1em}#sbo-rt-content .Acknowledgments>.Heading,#sbo-rt-content .AuthorContribution>.Heading,#sbo-rt-content .FundingInformation>.Heading,#sbo-rt-content .DataAvailability>.Heading,#sbo-rt-content .Ethics>.Heading{font-size:1.2rem;margin-bottom:0}#sbo-rt-content .License{font-size:.9rem !important;margin-top:1em;margin-bottom:1em}#sbo-rt-content .License>a:first-child img{float:left;height:1.9rem;padding-right:.5em;padding-bottom:0;padding-top:.2em}#sbo-rt-content .Glossary{border-top:1px solid #bbb;margin-top:1em;margin-bottom:1em;padding-top:.3em}#sbo-rt-content .Glossary .Headings{margin-top:.8em;margin-bottom:.8em}#sbo-rt-content .Glossary>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Glossary>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .GlossarySection .Headings{margin-top:.8em;margin-bottom:.4em}#sbo-rt-content .GlossarySection>.Headings>.Heading{font-size:1.2rem;margin:0}#sbo-rt-content .GlossarySection>.Headings>.SubHeading{font-size:100%}#sbo-rt-content .GlossaryTerm{float:left;font-style:italic;padding-right:.5em}#sbo-rt-content .GlossarySeeLabel,#sbo-rt-content .GlossarySeeAlsoLabel{font-style:italic;padding-right:.3em}#sbo-rt-content .GlossaryDef{display:inline;margin-top:.3em}#sbo-rt-content .GlossaryDef>.SimplePara,#sbo-rt-content .GlossaryDef>.GlossarySee,#sbo-rt-content .GlossaryDef>.GlossarySeeAlso{display:block}#sbo-rt-content .GlossaryDef>:first-child{display:inline;margin-top:0;margin-left:0}#sbo-rt-content .GlossaryDef .SimplePara+.GlossarySee,#sbo-rt-content .GlossaryDef .SimplePara+.GlossarySeeAlso{text-indent:0}#sbo-rt-content .GlossaryTerm{display:inline}#sbo-rt-content .GlossaryTerm+.GlossarySee,#sbo-rt-content .GlossaryTerm+.GlossarySeeAlso{display:inline}#sbo-rt-content .InternalRefGlossaryEntry{border-bottom:thin dotted;cursor:help}#sbo-rt-content .InternalRefGlossaryEntry:hover{border-bottom:none}#sbo-rt-content .InternalRefGlossaryEntry a:link,#sbo-rt-content .InternalRefGlossaryEntry a:active,#sbo-rt-content .InternalRefGlossaryEntry a:visited{color:inherit}#sbo-rt-content .InternalRefGlossaryEntry .InlineGlossaryDefinition{background:#fff;display:none;margin:0 3em 0 2em;padding:3px 3px 3px 6px;border-style:solid;border-color:#49546F;border-width:2px;border-radius:5px;box-shadow:5px 5px 5px #888}#sbo-rt-content .InternalRefGlossaryEntry:hover .InlineGlossaryDefinition{display:block;z-index:6}#sbo-rt-content .TocAppendix{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .BookContextInformation+.Appendix>.TocAppendix:first-child{border-top:none;padding-top:0}#sbo-rt-content .TocAppendix .Headings{margin-bottom:.5em}#sbo-rt-content .TocAppendix>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .TocAppendix>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .TocEntry,#sbo-rt-content .TocPart,#sbo-rt-content .TocBack{margin-top:.5em;text-align:left !important}#sbo-rt-content .TocItem{font-weight:bold}#sbo-rt-content .TocPageNumber{display:none}#sbo-rt-content .TocAuthors{padding-left:1.5em}#sbo-rt-content .TocSection1,#sbo-rt-content .TocSection2,#sbo-rt-content .TocSection3,#sbo-rt-content .TocSection4,#sbo-rt-content .TocSection5,#sbo-rt-content .TocSection6,#sbo-rt-content .TocSection7{padding-left:1.5em}#sbo-rt-content .Index{border-top:1px solid #bbb;margin-top:1em;padding-top:.3em;margin-bottom:.8em}#sbo-rt-content .BookBackmatter>.Index:first-child{border-top:none;margin-top:0}#sbo-rt-content .Index .Headings{margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .BookBackmatter>.Index:first-child>.Headings{margin-top:0}#sbo-rt-content .Index>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Index>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .IndexDiv .Headings{margin-top:.5em;margin-bottom:.1em}#sbo-rt-content .IndexDiv>.Headings>.Heading{font-size:1.2rem;margin:0}#sbo-rt-content .IndexDiv>.Headings>.SubHeading{font-size:100%;font-style:italic}#sbo-rt-content .IndexEntrySeeLabel{font-style:italic;margin-left:1em;padding-right:.3em}#sbo-rt-content .SecondaryIE{margin-left:1em}#sbo-rt-content .TertiaryIE{margin-left:2em}#sbo-rt-content .ChangeHistory{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .ChangeHistory>.Heading{font-size:1.44rem;margin-top:.8em;margin-bottom:.3em}#sbo-rt-content .ChangeDate{font-weight:bold;padding-right:1em}#sbo-rt-content .ChangeDetails{display:inline}#sbo-rt-content .ChangeDetails>p:first-of-type{display:inline}#sbo-rt-content .Bibliography{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .BookBackmatter>.Bibliography:first-child{border-top:none}#sbo-rt-content .Bibliography>.Heading{font-size:1.44rem;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .BibliographyWrapper{display:table;margin:0;padding:0}#sbo-rt-content .Bibliography>.BibliographyWrapper{padding-top:1em}#sbo-rt-content .Bibliography>.Heading+.BibliographyWrapper{padding-top:0}#sbo-rt-content .BibSection>.Heading{font-size:1.2rem;margin-top:.8em;margin-bottom:.2em}#sbo-rt-content .BibliographyWrapper>.BibSection:first-child>.Heading:first-child{margin-top:.3em}#sbo-rt-content .Citation{display:table-row;font-size:90%}#sbo-rt-content .CitationNumber{display:table-cell}#sbo-rt-content .CitationNumber+.CitationContent{padding-left:.5em;text-align:left}#sbo-rt-content .CitationContent{padding-top:1em;display:table-cell}#sbo-rt-content .BibliographyWrapper>.Citation:first-child>.CitationContent{padding-top:0}#sbo-rt-content .Occurrences{display:block}#sbo-rt-content .Occurrence{margin-right:0}#sbo-rt-content .Occurrence:before{content:"["}#sbo-rt-content .Occurrence:after{content:"]"}#sbo-rt-content .Citation .ArticleTitle:before,#sbo-rt-content .Citation .ChapterTitle:before{content:" “";}#sbo-rt-content .Citation .ArticleTitle,#sbo-rt-content .Citation .ChapterTitle{display:inline}#sbo-rt-content .Citation .ArticleTitle:after{content:"”\ ";}#sbo-rt-content .Citation .ChapterTitle:after{content:"”\ In: ";}#sbo-rt-content .Citation .Year:before{content:" ("}#sbo-rt-content .Citation .Year:after{content:") "}#sbo-rt-content .Citation .JournalTitle:after{content:" "}#sbo-rt-content .Citation .VolumeID:after{content:":"}#sbo-rt-content .BibChapter .FirstPage:before,#sbo-rt-content .BibBook .FirstPage:before{content:", pp "}#sbo-rt-content .Citation .FirstPage+.LastPage:before{content:"–";}#sbo-rt-content .Citation .BookTitle:after,#sbo-rt-content .Citation .BibEditorName:after,#sbo-rt-content .Citation .EditionNumber:after,#sbo-rt-content .Citation .PublisherName:after{content:", "}#sbo-rt-content .BibComments{display:block}#sbo-rt-content .CoverFigure img{margin:0 auto 6px;width:100%;max-width:480px;height:auto}#sbo-rt-content .SeriesTitlePage{padding-bottom:1.5em;padding-top:1em}#sbo-rt-content .SeriesTitlePage .VolumeNumber{font-size:1.44rem}#sbo-rt-content .SeriesTitlePage span.SeriesTitle{display:block;font-size:1.73rem;font-weight:bold;margin-top:.5em}#sbo-rt-content .SeriesTitlePage .SeriesSubTitle{display:block;font-size:1.44rem;font-weight:bold}#sbo-rt-content .SeriesTitlePage .SubSeriesTitle{display:block;font-size:1.44rem;font-weight:bold;margin-top:.5em}#sbo-rt-content .SeriesTitlePage .SubSeriesSubTitle{display:block;font-size:1.2rem;font-weight:bold}#sbo-rt-content .SeriesTitlePage .CollaboratorDesignation{display:block;font-weight:bold;padding-top:3em}#sbo-rt-content .SeriesTitlePage .Collaborators{display:block}#sbo-rt-content .SeriesTitlePage .AffiliationText{font-style:italic;margin-left:0}#sbo-rt-content .SeriesTitlePage .Affiliation+.CollaboratorName{display:inline-block;margin-top:1em}#sbo-rt-content .SeriesInformationText{padding-top:3em}#sbo-rt-content .BookTitlePage{padding-top:1em}#sbo-rt-content .BookTitlePageAfterSeriesTitlePage{border-top:1px solid #bbb;page-break-before:always}#sbo-rt-content .BookContextInformation+.BookTitlePage{border-top:none;padding-top:0}#sbo-rt-content .BookTitlePage .BookEditors,#sbo-rt-content .BookTitlePage .BookAuthors,#sbo-rt-content .BookTitlePage .BookEditorInChiefGroup,#sbo-rt-content .BookTitlePage .BookSectionEditorGroup{text-align:left !important}#sbo-rt-content .BookTitlePage .BookEditorInChiefGroup,#sbo-rt-content .BookTitlePage .BookSectionEditorGroup{margin-top:1em}#sbo-rt-content .BookTitlePage .BookEditorGroup .CollaboratorDesignation,#sbo-rt-content .BookTitlePage .BookEditorInChiefGroup .CollaboratorDesignation,#sbo-rt-content .BookTitlePage .BookSectionEditorGroup .CollaboratorDesignation{font-style:italic}#sbo-rt-content .BookTitlePage .BookTitle{display:block;font-size:1.73rem;font-weight:bold;margin-top:1em}#sbo-rt-content .BookTitlePage .BookSubTitle{display:block;font-size:1.44rem;font-weight:bold;margin-bottom:.5em}#sbo-rt-content .BookTitlePage .BookEdition{display:block;font-size:1rem;font-weight:normal;margin-top:.5em}#sbo-rt-content .BookTitlePage .CollaboratorLine{padding-top:.5em}#sbo-rt-content .BookFeatureText{margin-top:.5em}#sbo-rt-content .BookTitlePage .PublisherLogo .Figure,#sbo-rt-content .BookTitlePage .PublisherImprintName{font-size:1.2rem;margin-top:4em;margin-bottom:1.5em;text-align:left}#sbo-rt-content .CopyrightPage{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .CopyrightPage .CollaboratorDesignation{display:block;font-style:italic;padding-bottom:.5em}#sbo-rt-content .CopyrightPageOriginators{padding-bottom:4em}#sbo-rt-content .CopyrightPage div+.CollaboratorDesignation{padding-top:2em}#sbo-rt-content .CopyrightPage .EditorGroup+.AuthorGroup{padding-top:2em}#sbo-rt-content .CopyrightPage .Author+.Author,#sbo-rt-content .CopyrightPage .Author+.InstitutionalAuthor,#sbo-rt-content .CopyrightPage .InstitutionalAuthor+.Author,#sbo-rt-content .CopyrightPage .InstitutionalAuthor+.InstitutionalAuthor,#sbo-rt-content .CopyrightPage .Editor+.Editor,#sbo-rt-content .CopyrightPage .Editor+.InstitutionalEditor,#sbo-rt-content .CopyrightPage .InstitutionalEditor+.Editor,#sbo-rt-content .CopyrightPage .InstitutionalEditor+.InstitutionalEditor,#sbo-rt-content .CopyrightPage .Collaborator+.Collaborator{padding-top:1em}#sbo-rt-content .CopyrightPage .Affiliation{margin-top:0}#sbo-rt-content .CopyrightPage .AffiliationText{margin-left:0}#sbo-rt-content .CopyrightPage .CollaboratorLine{padding-top:1em}#sbo-rt-content .CopyrightPage .CollaboratorLineTranslatedBy{padding-top:2em}#sbo-rt-content .CopyrightPage .CollaboratorLine .CollaboratorDesignation{display:inline;font-style:normal}#sbo-rt-content .BookFrontmatter .CopyrightPage .ArticleNoteESMHint{border:none;padding-bottom:0;page-break-before:auto}#sbo-rt-content .CopyrightPageISBNs,#sbo-rt-content .CopyrightPageISSNs,#sbo-rt-content .SpringerLocationsLine,#sbo-rt-content .CatalogingInformation,#sbo-rt-content .MathematicsSubjectClassification,#sbo-rt-content .CopyrightLine,#sbo-rt-content .CopyrightPage .CopyrightComment,#sbo-rt-content .BookCopublishingInformation .SimplePara,#sbo-rt-content .CopyrightStandardText,#sbo-rt-content .TrademarkQualifierText,#sbo-rt-content .ProductLiability,#sbo-rt-content .LegalNotice,#sbo-rt-content .CoverDesigner,#sbo-rt-content .BookCoverFigureText,#sbo-rt-content .PaperInfo,#sbo-rt-content .SpringerReferenceLine{margin-top:1em}#sbo-rt-content .CopyrightComment+.CopyrightLine{margin-top:.5em}#sbo-rt-content .SeriesTitle+.CopyrightPageISBNs,#sbo-rt-content .SubSeriesTitle+.CopyrightPageISBNs{margin-top:0}#sbo-rt-content .CopyrightPage .SeriesTitle{display:block;margin-top:1em}#sbo-rt-content .SeriesTitle+.CopyrightPageISSNs,#sbo-rt-content .CopyrightPageISSNs+.SeriesTitle,#sbo-rt-content .CopyrightPageISSNs+.SubSeriesTitle{margin-top:0}#sbo-rt-content .CopyrightPagePrintISSN,#sbo-rt-content .CopyrightPagePrintISBN{display:inline-block;min-width:12em}#sbo-rt-content .SpringerReferenceLine .SimplePara+.SimplePara,#sbo-rt-content .BookCoverFigureText .SimplePara+.SimplePara,#sbo-rt-content .BookCopublishingInformation .SimplePara+.SimplePara{text-indent:0}#sbo-rt-content .CopyrightPagePrintISSN+.CopyrightPageElectronicISSN{padding-left:1.5em}#sbo-rt-content .CopyrightPagePrintISBN+.CopyrightPageElectronicISBN{padding-left:1.5em}#sbo-rt-content .CopyrightComment .SimplePara+.SimplePara{padding-top:.5em;text-indent:0}#sbo-rt-content .MathematicsSubjectClassificationCode+.MathematicsSubjectClassificationCode:before{content:", "}#sbo-rt-content .Endorsement{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Frontispiece{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Dedication{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Foreword{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PartFrontmatter h1:first-child+.Foreword{border-top:none;padding-top:0;page-break-before:auto}#sbo-rt-content .ForewordTitle{font-size:1.44rem;font-weight:bold;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .Foreword .AuthorName{margin-top:.2em}#sbo-rt-content .Foreword .AuthorName,#sbo-rt-content .ForewordLocations,#sbo-rt-content .ForewordDate{font-weight:bold;text-align:right}#sbo-rt-content .ForewordLocation+.ForewordLocation:before{content:", "}#sbo-rt-content .Foreword .RenderAsSection1>.Heading{font-size:1.2rem}#sbo-rt-content .Foreword .RenderAsSection2>.Heading,#sbo-rt-content .Foreword .RenderAsSection3>.Heading{font-size:100%}#sbo-rt-content .Preface{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PrefaceTitle{font-size:1.44rem;font-weight:bold;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .Preface .AuthorName{margin-top:.2em}#sbo-rt-content .Preface .AuthorName,#sbo-rt-content .PrefaceLocations,#sbo-rt-content .PrefaceDate{font-weight:bold;text-align:right}#sbo-rt-content .PrefaceLocation+.PrefaceLocation:before{content:", "}#sbo-rt-content .Preface .RenderAsSection1>.Heading{font-size:1.2rem}#sbo-rt-content .Preface .RenderAsSection2>.Heading,#sbo-rt-content .Preface .RenderAsSection3>.Heading{font-size:100%}#sbo-rt-content .BookFrontmatterArticleNote{border-top:1px solid #bbb;margin-top:0;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PartFrontmatter .ArticleNote{padding-bottom:1em}#sbo-rt-content .PartFrontmatter h1:first-child+.ArticleNote{border-top:none;page-break-before:auto}#sbo-rt-content .BookFrontmatter .ArticleNote .Heading,#sbo-rt-content .PartFrontmatter .ArticleNote .Heading{font-size:1.44rem;font-style:normal;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookAcknowledgments{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .BookAcknowledgmentsTitle{font-size:1.44rem;font-weight:bold;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookAcknowledgments .AuthorName{font-weight:bold;margin-top:1em}#sbo-rt-content .BookAcknowledgments .RenderAsSection1>.Heading{font-size:1.2rem}#sbo-rt-content .BookAcknowledgments .RenderAsSection2>.Heading,#sbo-rt-content .BookAcknowledgments .RenderAsSection3>.Heading{font-size:100%}#sbo-rt-content .BookNotes{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .BookNotesTitle{font-size:1.44rem;font-weight:bold;margin-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookNotes .AuthorName{font-weight:bold}#sbo-rt-content .BookFrontmatterAbbreviationGroup{border-top:1px solid #bbb;margin-top:0;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PartFrontmatter .AbbreviationGroup{padding-bottom:1em;margin-top:1em}#sbo-rt-content .BookFrontmatter .AbbreviationGroup .Heading,#sbo-rt-content .PartFrontmatter .AbbreviationGroup .Heading{font-size:1.44rem;font-weight:bold;padding-top:1em;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookFrontmatter .AbbreviationGroupSection>.Heading,#sbo-rt-content .PartFrontmatter .AbbreviationGroupSection>.Heading{font-size:1.2rem;padding-top:1em;padding-bottom:0}#sbo-rt-content .BookFrontmatter .AbbreviationGroupSection+.AbbreviationGroupSection>.Heading,#sbo-rt-content .PartFrontmatter .AbbreviationGroupSection+.AbbreviationGroupSection>.Heading{padding-top:.5em}#sbo-rt-content .Toc{border-top:1px solid #bbb;margin-top:0;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Toc .Headings{margin-bottom:.5em}#sbo-rt-content .Toc>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Toc>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .Loh{border-top:1px solid #bbb;padding-bottom:1em;padding-top:1em;page-break-before:always}#sbo-rt-content .Loh .Headings{margin-bottom:.1em}#sbo-rt-content .Loh>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Loh>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .LohPageNumber{display:none}#sbo-rt-content .LocWithHeading,#sbo-rt-content .LocWithoutHeading>.LocBody>.LocDiv{border-top:1px solid #bbb;padding-bottom:1em;padding-top:1em;page-break-before:always}#sbo-rt-content .Loc .Headings{margin-bottom:.1em}#sbo-rt-content .LocWithHeading>.Headings>.Heading,#sbo-rt-content .LocWithoutHeading>.LocBody>.LocDiv>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .LocWithHeading>.Headings>.SubHeading,#sbo-rt-content .LocWithoutHeading>.LocBody>.LocDiv>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .LocWithHeading .LocDiv{margin-top:1em}#sbo-rt-content .LocWithHeading .LocDiv .Heading{font-size:1.2rem;margin-bottom:.1em}#sbo-rt-content .LocWithHeading .LocDiv .SubHeading{font-size:100%;font-style:italic;font-weight:normal}#sbo-rt-content .LocDiv .FormalPara .Heading{font-size:100%}#sbo-rt-content .Loc .AuthorGroup+.AuthorGroup,#sbo-rt-content .Loc .AuthorGroup+.EditorGroup,#sbo-rt-content .Loc .EditorGroup+.AuthorGroup,#sbo-rt-content .Loc .EditorGroup+.EditorGroup{margin-top:1em}#sbo-rt-content .Loc .Author,#sbo-rt-content .Loc .Editor,#sbo-rt-content .Loc .InstitutionalAuthor,#sbo-rt-content .Loc .InstitutionalEditor{font-weight:bold}#sbo-rt-content .Loc .AffiliationText{margin-left:0}#sbo-rt-content .Loc .Email+.Email:before{content:", "}#sbo-rt-content .Loc .Emails,#sbo-rt-content .Loc .URLs{display:inline}#sbo-rt-content .Loc .Emails+.URLs:before{content:", "}#sbo-rt-content .Loc .URL+.URL:before{content:", "}#sbo-rt-content .BookFrontmatterFootnoteSection{border-top:1px solid #bbb;margin-top:0;page-break-before:always}#sbo-rt-content .PartFrontmatter .FootnoteSection{border-top:none;margin-top:0}#sbo-rt-content .Colophon{border-top:1px solid #bbb;margin-top:1em;padding-top:.8em;font-style:italic}#sbo-rt-content .ConferenceInfo{border-top:1px solid #bbb;margin-top:1em;padding-top:.8em}#sbo-rt-content .ConfEventAbbreviation,#sbo-rt-content .ConfNumber+.ConfSeriesName,#sbo-rt-content .ConfEventAbbreviation+.Year,#sbo-rt-content .ConfEventDateStart,#sbo-rt-content .ConfEventDateEnd{display:inline}#sbo-rt-content .ConfEventAbbreviation:after{content:" "}#sbo-rt-content .ConfEventLocation .City:after{content:", "}#sbo-rt-content .ConfEventDateEnd:before{content:"–"}#sbo-rt-content .ConfEventDateStart .Year:after,#sbo-rt-content .ConfEventDateStart .Month:after,#sbo-rt-content .ConfEventDateEnd .Year:after,#sbo-rt-content .ConfEventDateEnd .Month:after{content:"/"}#sbo-rt-content .ConfEventDate .Month:after{content:"/"}
    </style><script> // <![CDATA[
    var g = {
      position_cache: {
        
          "chapter": "/api/v1/book/9781484226018/chapter/html/425975_1_En_7_Chapter.xhtml",
          "book_id": "9781484226018",
          "chapter_uri": "html/425975_1_En_7_Chapter.xhtml",
          "position": 0,
          "user_uuid": "39a88cd5-54f5-4d61-aec6-7884d06dfba1",
          "next_chapter_uri": "/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_8_Chapter.xhtml"
        
      },
      title: "Securing the Perimeter: Deploying Identity and Access Management with Free Open Source Software",
      author_list: "Michael Schwartz, Maciej Machulak",
      format: "book",
      source: "application/epub+zip",
      is_system_book: true,
      is_public: false,
      loaded_from_server: true,
      allow_scripts: false,
      has_mathml: false
    };
    // ]]></script><script src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/modernizr.8e35451ddb64.js"></script><script>
    
      

      
        
          window.PUBLIC_ANNOTATIONS = true;
        
      

      window.MOBILE_PUBLIC_ANNOTATIONS = false;

    

    
      window.PRIVACY_CONTROL_OVERRIDE = false;
    

      window.PRIVACY_CONTROL_SWITCH = true;

      window.PUBLISHER_PAGES = true;

      window.SBO = {
        "constants": {
          "SITB_ENDPOINT": "/api/v2/sitb/",
          "SEARCH_SELECT_ENDPOINT": "https://learning.oreilly.com/api/v2/search/select/",
          "ENABLE_ONLINE_TRAINING": true
        }
      };
  </script><link rel="canonical" href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml"><meta name="description" content="© Michael Schwartz, Maciej Machulak 2018 Michael Schwartz and Maciej MachulakSecuring the Perimeterhttps://doi.org/10.1007/978-1-4842-2601-8_7 7. Strong Authentication Michael Schwartz1  and Maciej Machulak2 (1)Austin, TX, USA (2)London, UK   Wouldn’t you rather ...!--end&gt;!--begin&gt; "><meta property="og:title" content="7. Strong Authentication"><meta itemprop="isPartOf" content="/library/view/securing-the-perimeter/9781484226018/"><meta itemprop="name" content="7. Strong Authentication"><meta property="og:url" itemprop="url" content="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781484226018/"><meta property="og:description" itemprop="description" content="© Michael Schwartz, Maciej Machulak 2018 Michael Schwartz and Maciej MachulakSecuring the Perimeterhttps://doi.org/10.1007/978-1-4842-2601-8_7 7. Strong Authentication Michael Schwartz1  and Maciej Machulak2 (1)Austin, TX, USA (2)London, UK   Wouldn’t you rather ...!--end&gt;!--begin&gt; "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="Apress"><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781484226018"><meta property="og:book:author" itemprop="author" content="Michael Schwartz"><meta property="og:book:author" itemprop="author" content="Maciej Machulak"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@safari"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &lt;%= font_size %&gt; !important; }"></style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &lt;%= font_family %&gt; !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: &lt;%= column_width %&gt;% !important; margin: 0 auto !important; }"></style><noscript><meta http-equiv="refresh" content="0; url=/library/no-js/" /></noscript><script>
    var dataLayer = window.dataLayer || [];

    
      window.medalliaVsgUserIdentifier = '39a88cd5-54f5-4d61-aec6-7884d06dfba1';
      dataLayer.push({userIdentifier: '39a88cd5-54f5-4d61-aec6-7884d06dfba1'});
      dataLayer.push({loggedIn: 'yes'});

      
        window.medalliaVsgAccountIdentifier = 'c1ff3208-121f-489a-a3cd-0b219a28ba6e';
        

        window.medalliaVsgIsIndividual = true;
        
          
          dataLayer.push({learningAccountType: 'free trial'});
          
        

        
      
    

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4V6Z');
    (function () {
      var VERSION = 'V1.1';
      var AUTHOR = 'Awwad';
      if (!window.GtmHelper)
        window.GtmHelper = function () {
          var instance = this;
          var loc = document.location;
          this.version = VERSION;
          this.author = AUTHOR;
          this.readCookie = function (name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
              var c = ca[i];
              while (c.charAt(0) == ' ') c = c.substring(1, c.length);
              if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
          };
          this.createCookie = function (name, value, days, cookieDomain) {
            var domain = "";
            var expires = "";

            if (days) {
              var date = new Date();
              date.setTime(date.getTime() + Math.ceil(days * 24 * 60 * 60 * 1000));
              var expires = " expires=" + date.toGMTString() + ";";
            }

            if (typeof (cookieDomain) != 'undefined')
              domain = " domain=" + cookieDomain + "; ";

            document.cookie = name + "=" + value + ";" + expires + domain + "path=/";
          };

          this.isDuplicated = function (currentTransactionId) {
            // the previous transaction id:
            var previousTransIdValue = this.readCookie("previousTransId");

            if (currentTransactionId === previousTransIdValue) {
              return true; // Duplication
            } else {
              return false;
            }
          };
        }
    })()
  </script><script defer="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/vendor.667e7ada497a.js"></script><script defer="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/reader.d25c5547507a.js"></script><iframe src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource.html"></iframe><iframe src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource(2).html"></iframe><iframe src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource(3).html"></iframe><link rel="stylesheet" type="text/css" href="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/container.40a6b605d29a66b083aa6d74c07bb73eae19e31b.css"><iframe src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource(4).html"></iframe><script async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/MathJax.js"></script><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 2147483667;
}
.annotator-filter {
  z-index: 2147483657;
}</style><link href="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/840a321d95.css" media="all" rel="stylesheet"><script src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f(1).txt"></script><script src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f(2).txt"></script><script src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/f(3).txt"></script><style type="text/css" id="kampyleStyle">.noOutline{outline: none !important;}.wcagOutline:focus{outline: 1px dashed #595959 !important;outline-offset: 2px !important;transition: none !important;}</style></head>


<body class="reading sidenav nav-collapsed scalefonts subscribe-panel library">

    
  <noscript> 
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
            height="0" width="0"
            style="display:none;visibility:hidden">
    </iframe>
  </noscript>



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        

  


<a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li><a href="https://learning.oreilly.com/home/" class="l0 nav-icn"><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.738 14H9.254v-3.676a.617.617 0 0 0-.621-.613H7.39a.617.617 0 0 0-.62.613V14H4.284a.617.617 0 0 1-.622-.613V10.22c0-.327.132-.64.367-.87l3.547-3.493a.627.627 0 0 1 .875 0l3.54 3.499c.234.229.366.54.367.864v3.167a.617.617 0 0 1-.62.613zM7.57 2.181a.625.625 0 0 1 .882 0l5.77 5.692-.93.92-5.28-5.209-5.28 5.208-.932-.919 5.77-5.692z"></path></svg><span>Home</span></a></li><li class="search"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="l1 nav-icn "><!--?xml version="1.0" encoding="UTF-8"?--><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M8,8 C6.34321755,8 5.00013,6.65691245 5.00013,5.00013 C5.00013,3.34334755 6.34321755,2.00026001 8,2.00026001 C9.65678245,2.00026001 10.99987,3.34334755 10.99987,5.00013 C10.99987,6.65691245 9.65678245,8 8,8 Z M2.33024571,11.3523547 L2.33774538,11.3523547 C3.7622187,9.70968996 5.82947484,8.76608166 8.00374984,8.76608166 C10.1780248,8.76608166 12.245281,9.70968996 13.6697543,11.3523547 C13.8892083,11.6177474 14.0062813,11.9530021 13.99974,12.2973138 L13.99974,13.99974 L2.00026001,13.99974 L2.00026001,12.2973138 C1.99371867,11.9530021 2.11079172,11.6177474 2.33024571,11.3523547 Z" id="path-1"></path></svg><span>Your O'Reilly</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/profile/" class="l2 nav-icn"><span>Profile</span></a></li><li><a href="https://learning.oreilly.com/history/" class="l2 nav-icn"><span>History</span></a></li><li><a href="https://learning.oreilly.com/playlists/" class="l2 nav-icn"><span>Playlists</span></a></li><li><a href="https://learning.oreilly.com/u/39a88cd5-54f5-4d61-aec6-7884d06dfba1/" class="l2 nav-icn"><span>Highlights</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.564 2.263l2.172 2.174c.17.168.264.397.264.636V11a.6.6 0 0 1-.6.6h-.6V6.2h-6V2.6a.6.6 0 0 1 .6-.6h3.527c.239 0 .468.095.637.263zM2.6 14a.6.6 0 0 1-.6-.6V6.8a.6.6 0 0 1 .6-.6h1.903a1.2 1.2 0 0 1 .849.352L6.2 7.4H11a.6.6 0 0 1 .6.6v5.4a.6.6 0 0 1-.6.6H2.6zM11 5h1.8L11 3.2V5z"></path></svg><span>Featured</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/resource-centers/" class="l2 nav-icn"><span>Resource Centers</span></a></li><li><a href="https://learning.oreilly.com/search/?query=&amp;extended_publisher_data=true&amp;highlight=true&amp;include_assessments=false&amp;include_case_studies=true&amp;include_courses=true&amp;include_orioles=true&amp;include_playlists=true&amp;include_collections=true&amp;include_notebooks=true&amp;is_academic_institution_account=false&amp;source=user&amp;formats=collection&amp;sort=date_added&amp;facet_json=true&amp;page=0&amp;collection_type=expert" class="l2 nav-icn"><span>Expert Playlists</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="l1 nav-icn "><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.6467109,4.35328907 L14.7964612,7.51003884 C15.0678463,7.78304342 15.0678463,8.22395603 14.7964612,8.49696061 L11.6467109,11.6467109 L10.6597892,10.6597892 L13.3055794,8 L10.6597892,5.34021084 L11.6467109,4.35328907 Z M4.35328907,11.6467109 L1.20353875,8.48996116 C0.932153749,8.21695658 0.932153749,7.77604397 1.20353875,7.50303939 L4.35328907,4.35328907 L5.34021084,5.34021084 L2.69442057,8 L5.34021084,10.6597892 L4.35328907,11.6467109 Z M5.84417089,11.4997226 L8.67194674,4.50027742 L10.1838269,4.50027742 L7.35605105,11.4997226 L5.84417089,11.4997226 Z" id="Mask"></path></svg><span>Practice</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/scenarios/" class="l2 nav-icn"><span>Katacoda Scenarios</span></a></li><li><a href="https://learning.oreilly.com/interactive/#notebooks" class="l2 nav-icn"><span>Jupyter Notebooks</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="l1 nav-icn "><!--?xml version="1.0" encoding="UTF-8"?--><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M10.0440191,12.1582649 C10.177209,12.3351976 10.2476998,12.552011 10.2434767,12.7742985 L10.2434767,13.9482829 L1.96869684,13.9482829 L1.96869684,12.7742985 C1.96418597,12.536863 2.04491894,12.3056731 2.19625329,12.1226596 L2.20142503,12.1226596 C3.18373453,10.9898864 4.60930376,10.339179 6.10867266,10.339179 C7.30793519,10.339179 8.45998426,10.7554703 9.37576632,11.5017585 L14.3434936,11.5017585 L14.3434936,3.65650645 L1.65650645,3.65650645 L1.65650645,11.5017585 L2.06682298,11.5017585 L1.82063306,12.1582649 L1.32825322,12.1582649 C1.14771395,12.1582649 1,12.010551 1,11.8300117 L1,3.32825322 C1,3.14771395 1.14771395,3 1.32825322,3 L14.6717468,3 C14.852286,3 15,3.14771395 15,3.32825322 L15,11.8300117 C15,12.010551 14.852286,12.1582649 14.6717468,12.1582649 L10.0440191,12.1582649 Z M12.5483683,7.16419284 C12.6159362,7.20929881 12.6563112,7.2853432 12.6558247,7.36658194 C12.6553382,7.44782068 12.6140555,7.5233761 12.5459522,7.56766966 L10.4270949,8.91581376 C10.3903366,8.94010203 10.3431312,8.9419685 10.3045699,8.9206583 C10.2660086,8.89934811 10.2424712,8.85838696 10.2434767,8.81434055 L10.2434767,5.91510593 C10.2420711,5.86982855 10.2666257,5.82771857 10.3067229,5.80664182 C10.3468202,5.78556507 10.3954292,5.7892172 10.431927,5.81604875 L12.5483683,7.16419284 Z M6.10608679,9.81089299 C4.9635781,9.81089299 4.03739181,8.8847067 4.03739181,7.74219802 C4.03739181,6.59968933 4.9635781,5.67350304 6.10608679,5.67350304 C7.24859547,5.67350304 8.17478176,6.59968933 8.17478176,7.74219802 C8.17478176,8.8847067 7.24859547,9.81089299 6.10608679,9.81089299 Z"></path></svg><span>Sandboxes</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/scenarios/kubernetes-sandbox/9781492062820/" class="l2 nav-icn"><span>Kubernetes</span></a></li><li><a href="https://learning.oreilly.com/scenarios/python-sandbox/9781492062844/" class="l2 nav-icn"><span>Python</span></a></li><li><a href="https://learning.oreilly.com/scenarios/tensorflow-sandbox/9781492062851/" class="l2 nav-icn"><span>TensorFlow</span></a></li><li><a href="https://learning.oreilly.com/scenarios/ubuntu-sandbox/9781492062837/" class="l2 nav-icn"><span>Ubuntu</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="l1 nav-icn "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>queue icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 29.2C25.4 29.2 25.8 29.1 26.1 28.9L48.7 16.8C49.5 16.4 50 15.5 50 14.6 50 13.7 49.5 12.8 48.7 12.4L26.1 0.3C25.4-0.1 24.6-0.1 23.9 0.3L1.3 12.4C0.5 12.8 0 13.7 0 14.6 0 15.5 0.5 16.4 1.3 16.8L23.9 28.9C24.2 29.1 24.6 29.2 25 29.2ZM7.3 14.6L25 5.2 42.7 14.6 25 24 7.3 14.6ZM48.7 22.4L47.7 21.9 25 34.2 2.3 21.9 1.3 22.4C0.5 22.9 0 23.7 0 24.7 0 25.6 0.5 26.5 1.3 26.9L23.9 39.3C24.2 39.5 24.6 39.6 25 39.6 25.4 39.6 25.8 39.5 26.1 39.3L48.7 26.9C49.5 26.5 50 25.6 50 24.7 50 23.7 49.5 22.9 48.7 22.4ZM48.7 32.8L47.7 32.3 25 44.6 2.3 32.3 1.3 32.8C0.5 33.3 0 34.1 0 35.1 0 36 0.5 36.9 1.3 37.3L23.9 49.7C24.2 49.9 24.6 50 25 50 25.4 50 25.8 49.9 26.1 49.7L48.7 37.3C49.5 36.9 50 36 50 35.1 50 34.1 49.5 33.3 48.7 32.8Z"></path></g></svg><span>Explore</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/topics/" class="l2 nav-icn"><span>All Topics</span></a></li><li><a href="https://learning.oreilly.com/search/?query=&amp;extended_publisher_data=true&amp;highlight=true&amp;include_assessments=false&amp;include_case_studies=true&amp;include_courses=true&amp;include_orioles=true&amp;include_playlists=true&amp;include_collections=true&amp;include_notebooks=true&amp;is_academic_institution_account=false&amp;source=user&amp;formats=book&amp;formats=case%20study&amp;formats=learning%20path&amp;formats=live%20online%20training&amp;formats=notebook&amp;formats=oriole&amp;formats=video&amp;sort=popularity&amp;facet_json=true&amp;page=0&amp;collection_type=expert" class="l2 nav-icn"><span>Most Popular Titles</span></a></li><li><a href="https://learning.oreilly.com/r/" class="l2 nav-icn"><span>Recommendations</span></a></li><li><a href="https://learning.oreilly.com/search/?query=&amp;extended_publisher_data=true&amp;highlight=true&amp;include_assessments=false&amp;include_case_studies=true&amp;include_courses=true&amp;include_orioles=true&amp;include_playlists=true&amp;include_collections=true&amp;include_notebooks=true&amp;is_academic_institution_account=false&amp;source=user&amp;formats=book&amp;sort=publication_date&amp;facet_json=true&amp;page=0" class="l2 nav-icn"><span>Early Release</span></a></li><li><a href="https://learning.oreilly.com/playlists/discover/" class="l2 nav-icn"><span>Playlists</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M13.4 9.8a.6.6 0 0 1 .6.6v1.2h-1.2l-.6 2.4H3.8l-.6-2.4H2v-1.2a.6.6 0 0 1 .6-.6h10.8zM8 5.6a1.8 1.8 0 1 1-.001-3.599A1.8 1.8 0 0 1 8 5.6zm3.6 2.35v.95H4.4v-.95c0-.167.066-.33.19-.443A5.08 5.08 0 0 1 8 6.2a5.08 5.08 0 0 1 3.41 1.307c.124.113.19.276.19.444z"></path></svg><span>Attend</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/live-training/" class="l2 nav-icn"><span>Live Training</span></a></li></ul></li><li><a href="https://learning.oreilly.com/certifications/" class="l1 nav-icn "><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M12.912 9.18L14 8.014l-1.088-1.18a.304.304 0 01-.075-.268L13.195 5l-1.535-.463a.313.313 0 01-.194-.194l-.462-1.537-1.565.358c-.09.03-.194 0-.269-.074L8.007 2 6.845 3.09a.303.303 0 01-.269.074l-1.565-.358-.462 1.537a.313.313 0 01-.194.194L2.82 5l.358 1.567a.26.26 0 01-.075.269L2 8.015l1.088 1.164c.075.075.09.18.075.269l-.358 1.567 1.535.463c.09.03.164.104.194.194l.462 1.537 1.565-.358c.015 0 .045-.015.075-.015.075 0 .15.03.209.074L8.007 14l1.163-1.09a.303.303 0 01.269-.074l1.565.358.462-1.537a.313.313 0 01.194-.194L13.195 11l-.358-1.567a.338.338 0 01.075-.254zm-6.046 1.37L4.41 8.26l1.16-1.244 1.767 1.649L10.4 5.6l1.202 1.202-4.242 4.243-.495-.495z"></path></svg><span>Certifications</span></a></li><li><a href="https://get.oreilly.com/email-signup.html" class="l1 nav-icn " target="&quot;_blank&quot;"><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.564 2.263l2.172 2.174c.17.168.264.397.264.636V11a.6.6 0 0 1-.6.6h-.6V6.2h-6V2.6a.6.6 0 0 1 .6-.6h3.527c.239 0 .468.095.637.263zM2.6 14a.6.6 0 0 1-.6-.6V6.8a.6.6 0 0 1 .6-.6h1.903a1.2 1.2 0 0 1 .849.352L6.2 7.4H11a.6.6 0 0 1 .6.6v5.4a.6.6 0 0 1-.6.6H2.6zM11 5h1.8L11 3.2V5z"></path></svg><span>Newsletters</span></a></li><li><a href="https://learning.oreilly.com/u/preferences/" class="l1 nav-icn "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://learning.oreilly.com/public/support/" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M7.363 6.656a2.692 2.692 0 0 1-2.681-2.703c0-1.493 1.2-2.703 2.681-2.703a2.692 2.692 0 0 1 2.682 2.703c0 1.493-1.2 2.703-2.682 2.703zm4.023 2.027c-1.852 0-3.352 1.513-3.352 3.379H2v-1.534c-.006-.31.099-.612.295-.852a6.666 6.666 0 0 1 9.09-.993zm-.543.676h1.12v.304c.003.284.16.543.408.676a.766.766 0 0 0 .77 0l.303-.176.556.966-.302.176a.772.772 0 0 0-.362.676v.08a.772.772 0 0 0 .362.677l.302.21-.556.965-.302-.175a.766.766 0 0 0-.771 0 .778.778 0 0 0-.409.675v.352h-1.106v-.372a.778.778 0 0 0-.409-.676.766.766 0 0 0-.77 0l-.303.176-.556-.912.302-.176a.772.772 0 0 0 .362-.676v-.04-.04a.772.772 0 0 0-.362-.676l-.302-.176.556-.966.289.155a.766.766 0 0 0 .77 0 .778.778 0 0 0 .41-.676V9.36zm1.562 2.703c0-.271-.108-.531-.3-.722a1.001 1.001 0 0 0-.72-.292 1.01 1.01 0 0 0-.992 1.023 1.01 1.01 0 0 0 1.01 1.004 1.01 1.01 0 0 0 1.002-1.013z"></path></svg><span>Support</span></a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M2.613 12.63A.607.607 0 0 1 2 12.03V3.602C2 3.269 2.274 3 2.613 3h5.515v1.204H3.226v7.223h4.902v1.203H2.613zM5.677 9.02V6.611h4.903V4.926a.301.301 0 0 1 .19-.274.31.31 0 0 1 .33.063l2.722 2.673a.594.594 0 0 1 0 .849L11.1 10.909a.31.31 0 0 1-.331.063.301.301 0 0 1-.19-.274V9.02H5.677z"></path></svg><span>Sign Out</span></a></li></ul></div></li></ul></nav></header>



      </div>
      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Securing the Perimeter: Deploying Identity and Access Management with Free Open Source Software
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" title="Search in archive" class="js-search-controls search-controls" onclick="window.Appcues.track(&#39;SearchBook_HeronBook&#39;)"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781484226018/chapter/html/425975_1_En_7_Chapter.xhtml"><div class="js-collections-dropdown collections-dropdown menu-bit-cards" onclick="window.Appcues.track(&#39;AddPlaylist_HeronBook&#39;)"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size" onclick="window.Appcues.track(&#39;ChangeFont_HeronBook&#39;)"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="trigger" data-push-state="false" title="Share" aria-label="Share" onclick="window.Appcues.track(&#39;Share_HeronBook&#39;)"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml&amp;text=Securing%20the%20Perimeter%3A%20Deploying%20Identity%20and%20Access%20Management%20with%20Free%20Open%20Source%20Software&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%207.%C2%A0Strong%20Authentication&amp;body=https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml%0D%0Afrom%20Securing%20the%20Perimeter%3A%20Deploying%20Identity%20and%20Access%20Management%20with%20Free%20Open%20Source%20Software%0D%0A"><span>Email</span></a></li></ul></li>
      </ul>
    </div>

    
    <section role="document">
        
        




  <script defer="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/djangoMessagesPage.61a28d591d16.js"></script>


        <script src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/48743.js"></script>
<script>
  var userId = "6866040";

  var userObject = {
    firstName: "MACKYNZIE",
    segment: "Trial",
    admin: "False",
    profileCreatedOn: "April 4, 2020, 9:28 a.m.",
    academic: ""
  };
  window.Appcues.identify(userId, userObject);
  window.Appcues.page();

  setTimeout(function () {
    window.Appcues.track('ViewingBook_HeronBook')
  }, 20000);
</script>


	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_6_Chapter.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">6.&nbsp;Proxy</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_8_Chapter.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">8.&nbsp;User-Managed Access</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content" style="transform: none;"><div class="annotator-wrapper"><div class="ChapterContextInformation"><div class="ContextInformation" id="b978-1-4842-2601-8_7"><div class="ChapterCopyright">©&nbsp;Michael Schwartz, Maciej Machulak&nbsp;2018</div><span class="ContextInformationAuthorEditorNames"><span class="Author"><span class="AuthorName">Michael&nbsp;Schwartz</span> and </span><span class="Author"><span class="AuthorName">Maciej&nbsp;Machulak</span></span></span><span class="ContextInformationBookTitles"><span class="BookTitle" epub:type="title" lang="en">Securing the Perimeter</span></span><span class="ChapterDOI"><a href="https://doi.org/10.1007/978-1-4842-2601-8_7">https://doi.org/10.1007/978-1-4842-2601-8_7</a></span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" lang="en">7.&nbsp;Strong Authentication</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">Michael&nbsp;Schwartz</span><sup><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Aff3" class="totri-footnote">1</a>&nbsp;<span class="ContactIcon"></span></sup> and </span><span class="Author"><span class="AuthorName">Maciej&nbsp;Machulak</span><sup><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Aff4" class="totri-footnote">2</a></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff3"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">Austin, TX, USA</div></div><div class="Affiliation" id="Aff4"><span class="AffiliationNumber">(2)</span><div class="AffiliationText">London, UK</div></div><div class="ClearBoth">&nbsp;</div></div></div><!--End Abstract--><div class="Fulltext"><p class="Para" id="Par2">Wouldn’t you rather stop a security breach than detect it? So why do organizations have a love affair with intrusion detection systems and neglect strong authentication? While an IDS system can detect a breach, the authentication may stop it entirely. Numerous surveys done over the years have shown that passwords are the most common cause of information security breaches. <span id="ITerm1">Upgradin</span>g authentication may be the best investment you can make in enterprise security in terms of effectiveness.</p><p class="Para" id="Par3">Attackers have many good options for <span id="ITerm2">defeating passwords</span>. Easy passwords are guessable. Sloppy programmers write clear text passwords to the file system or registry, or hard-code them in applications. People reuse passwords at many sites. One hacked website leads to others—especially if hackers sell the stolen passwords on the dark web. Hackers trick people into revealing their passwords via phishing. Key loggers and other malware snoop passwords. <span id="ITerm3">Attackers record passwords</span> sent unencrypted over a network (for example, via public WiFi networks). Cross-site scripting (XSS) vulnerabilities may expose your password in the browser. Hackers may have inserted spyware in your hardware. These examples are only the beginning of a list of potential problems with passwords.</p><p class="Para" id="Par4">Early on, security experts realized that combining passwords with another factor (or factors) increases our confidence in the authentication. As such, MFA (Multi-Factor Authentication) was born. In the 90s, one-time password (OTP) hardware tokens and X.509 browser certificates seemed unbreakable. OTPs allow a user to authenticate to a system with an algorithmically-generated numeric password that changes periodically (every 30 seconds or so). X.509 web certificates enable a web browser to present a person’s digital certificate, stored either in the browser or on an external smartcard, to the server and authenticate based on this certificate.</p><div class="Para" id="Par5">Twenty years later, there are many new authentication <span id="ITerm4">technologies</span> beyond OTP and X.509 certificates. The rate of innovation has not slowed—authentication technologies are rapidly emerging. Mobile phones have new sensors and websites have access to behavioral analytics that can mitigate the risk of fraud. But there is a tradeoff in usability. Albert North Whitehead, an English mathematician and philosopher, said “Civilization advances by extending the number of important operations which we can perform without thinking about them.” The best usability would be not authenticating at all! My device should just know it’s me and send that information over the network. But unfortunately, we’re not there yet (although behavioral biometrics and continuous authentication methods are becoming increasing popular). Today, <span id="ITerm5">digital</span> authentication balances a tradeoff between security, usability, and cost (or deployability). If there was a technology that was secure, super easy to use, and cheap for organizations to implement, we would be using it. In fact, in many ways, passwords seemed to offer one of the most attractive “triangles” out there (see Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig1">7-1</a></span>).<figure class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig1_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig1_HTML.jpg" style="height:11.72em" width="591" height="469" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig1_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-1</span><p class="SimplePara">
                  <span id="ITerm6">
                    <em class="EmphasisTypeItalic ">Triangle of trust</em>
                    
                    
                  </span>
                </p></div></figcaption></figure></div><p class="Para" id="Par6">In this chapter, we provide a technical overview of some of the available <span id="ITerm7">technologies and standards</span> for strong authentication, such as OATH, Mutual TLS, Fast Identity Online (FIDO), and W3C Web Authentication. Some of these standards can even help protect us against phishing, man-in-the-middle attacks, and replay password attacks. For ideas on how to provision and de-provisioning strong credentials, see Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_9_Chapter.xhtml" class="totri-footnote"><span class="RefSource">9</span></a></span> on identity management.</p><section class="Section1 RenderAsSection1" id="Sec1"><h2 class="Heading">One-Time Passwords (OTPs)</h2><p class="Para" id="Par7"><span id="ITerm8">OTPs</span> are not susceptible to replay attacks, meaning an attacker cannot use a stolen OTP code later to impersonate someone. As the name suggests, the <span id="ITerm9">usability</span> of an OTP is like a password—something that the person enters in addition to their username. OTPs are not inherently two-factor—the <span id="ITerm10">token value</span> is only one factor. One common strategy to make OTP solutions two-factor is to prefix a <span id="ITerm11">PIN number</span> before the OTP. This combines the “something you know” (PIN number) with the “something you have” (whatever software/hardware supplied you with the OTP). OTPs are also often used in combination with a password (your first authenticate “as usual” and then you need to provide an OTP).</p><p class="Para" id="Par8">One of the easiest ways to <span id="ITerm12">implement</span> OTP is to generate a random number and send it to the person via email, SMS, or some other messaging platform. One way to accomplish this is to use an algorithm based on some cryptographic material stored on that server (preventing attackers from guessing the one-time passwords).</p><div class="Para" id="Par9">For example, the server can use the <span id="ITerm13">HMAC-SHA-1 algorithm</span><span id="ITerm14">
              
              
            </span>, as defined in RFC 2104, and combine it with the truncation method defined in RFC 4266. The algorithm takes a secret as the seed and a second variable (e.g., time) to produce a hash and truncates that hash to produce a code of a desired length. The length of the code should allow the end user to easily read it and type it back at the site during authentication, hence the length is often of six-eight digits long and contains numbers only to be easily usable on a mobile phone. It is then the responsibility of the server to match the code with the one that has been generated. It’s a good idea to make sure the code is only used once, and that the code expires. Such an OTP flow is depicted in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig2">7-2</a></span>.<figure class="Figure" id="Fig2"><div class="MediaObject" id="MO2"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig2_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig2_HTML.jpg" style="height:34.98em" width="1713" height="1399" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig2_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-2</span><p class="SimplePara">One-time passwords delivered using <span id="ITerm15">SMS</span>—example flow</p></div></figcaption></figure></div><p class="Para" id="Par10"><span id="ITerm16">OTPs</span> delivered via <span id="ITerm17">SMS</span> or email don’t prove possession of something, they simply prove access to a communication channel. First, you must trust the channel—that an attacker cannot intercept the message. Internet email is hard to trust because it not encrypted—few email transfer agents support TLS. Email clients make a secure connection to the server, but the emails are sent in the clear from one MTA to another. <span id="ITerm18">Attackers</span> can use malware installed on the person’s  device to intercept the code sent via email. When targeting a specific person, attackers can hack the mobile operator by convincing one of the thousands of people or agents to issue a replacement SIM card for a certain num ber.</p><p class="Para" id="Par11">OTP does not protect you against phishing and allows for man-in-the-middle or man-in-the-browser attacks. If an attacker tricks a person into interacting with the <span id="ITerm19">attacker’s website</span> (e.g., through phishing), the attacker can replay messages on the legitimate site (e.g., a bank) and proxy back the actual content without the person knowing.</p></section><section class="Section1 RenderAsSection1" id="Sec2"><h2 class="Heading">HOTP and TOTP</h2><div class="Para" id="Par12">HMAC-based One-Time Passwords (HOTPs) and Time-based One-Time Passwords (TOTPs) are other types of OTPs. Both types of one-time passwords are examples of a hash-based message authentication code (HMAC) that’s computed based on a secret and some other value, either a counter for HOTP or time for TOTP. There are both software and hardware implementations of HOTP and <span id="ITerm20">TOTP</span> (see Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig3">7-3</a></span>). We discuss both types in subsequent sections of this chapter.<figure class="Figure" id="Fig3"><div class="MediaObject" id="MO3"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig3_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig3_HTML.jpg" style="height:25.92em" width="1712" height="1037" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig3_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-3</span><p class="SimplePara">Examples of HOTP and TOTP hardware and software tokens</p></div></figcaption></figure></div><section class="Section2 RenderAsSection2" id="Sec3"><h3 class="Heading">HOTP</h3><p class="Para" id="Par13">The HMAC-based One-Time Password <span id="ITerm21">method</span> allows for a one-time password to be <span id="ITerm22">generated</span> independently by the client using a <span id="ITerm23">cryptographic function</span>, which takes a secret and a counter as input. The client and server share the secret and counter. The counter is often set to 0, or a known fixed value, to minimize deployment complexity. However, to mitigate more risk, the counter should be set to a random value for each token in a production environment.</p><div class="Para" id="Par14">The Initiative for Open Authentication (<span id="ITerm24">OATH</span>)<span id="ITerm25">
                
              </span> incubated HOTP, specified in RFC 4226. The <span id="ITerm26">design goals</span> were end-consumer usability, as well as ease of implementation on low-cost hardware with minimal user interface. HOTP codes contain only numeric characters, so people can easily enter one on their mobile phones. The math behind HOTP is as follows:<div class="ProgramCode" id="PC1"><div class="LineGroup"><div class="FixedLine">HOTP = Truncate(HMAC-SHA-1(s,c))</div></div></div></div><div class="Para" id="Par15">where<div class="ProgramCode" id="PC2"><div class="LineGroup"><div class="FixedLine">s - secret value (seed)</div><div class="FixedLine">c - counter value</div><div class="FixedLine">Truncate() - truncates the generated HMAC-SHA-1 to extract 6-8 digits (depending on the actual deployment)</div></div></div></div><p class="Para" id="Par16">A hardware or software <span id="ITerm27">token</span> can generate an HOTP. Organizations decide to use hardware or software depending on the security requirements of a deployment (you may recall examples of such tokens depicted in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig3">7-3</a></span>).</p><p class="Para" id="Par17">For hardware tokens, an administrator usually provisions the secret and counter during a centrally-governed account administration process. For software tokens, such as Google Authenticator (which is open source), the server typically generates the secret and counter, and then renders an TLS protected web page, which is scanned by the software token. The server can verify an HOTP because it knows the secret and the counter used to compute the password. Every time an <span id="ITerm28">HOTP</span> is generated, the counter increases by one.</p><p class="Para" id="Par18">You may wonder what happens if the counter on the server gets out of sync with the token (for example, if you start generating HOTPs but are not using them to sign in to the account). HOTP can deal with such situations through its <span id="ITerm29">re-synchronization algorithm</span>, which uses something called a look-ahead window. Such windows define a number of acceptable retries for the server to verify an HOTP until giving up and they are usually set somewhere between 10-20. If the server cannot find an <span id="ITerm30">acceptable counter</span> to produce a valid OTP, the server can then ask for another authentication pass of the protocol to take place and this happens until the maximum number of authorized attempts is reached. It is common that the server would accept several attempts. In fact, during re-synchronization of an OTP, to minimize the possibility of a <span id="ITerm31">fraudulent activity</span>, the server may ask for multiple passcodes to be provided by the user.</p><p class="Para" id="Par19">If the user fails to resynchronize a token and the maximum number of authorized attempts is reached, the HOTP RFC document suggests locking the person’s account.</p><p class="Para" id="Par20">Importantly, when an <span id="ITerm32">HOTP</span> is generated, it can be used on the server for an unknown amount of time. This opens a potential window for an attack, where the OTP is used by the attacker prior to its legitimate use (e.g., the person generates an HOTP but fails to use it for a long time, at which point the OTP can be used on the server by an attacker). This <span id="ITerm33">drawback</span> is addressed in another version of one-time passwords, which is TOTP, or Time-based OTP.</p></section><section class="Section2 RenderAsSection2" id="Sec4"><h3 class="Heading">TOTP</h3><div class="Para" id="Par21">Time-based OTP was also incubated by the OATH initiative and specified in RFC 6238. It is an example of a <span id="ITerm34">hash-based message authentication code (HMAC)</span> and is a variant of HOTP. This algorithm uses a shared secret and time instead of a counter. Because the server and the token are affected by network latency, and their clocks may be slightly out-of-sync, it’s not a precise time that is used for calculating the <span id="ITerm35">HMAC</span>, but rather a time interval. Half-minute intervals are recommended in RFC 6238 as a balance between security and usability. <span id="ITerm36">TOTP</span> is <span id="ITerm37">calculated</span> as follows:<div class="ProgramCode" id="PC3"><div class="LineGroup"><div class="FixedLine">TOTP = Truncate(HMAC-SHA-1(s,TC))</div></div></div></div><div class="Para" id="Par22">where<div class="ProgramCode" id="PC4"><div class="LineGroup"><div class="FixedLine">s - secret value</div><div class="FixedLine">TC - time counter value which can be calculated as TC = floor((unixtime(now) − unixtime(T0)) / TI),</div><div class="FixedLine">Truncate() - truncates the generated to HMAC-SHA-1 to extract 6-8 digits (depending on the actual deployment)</div></div></div></div><div class="Para" id="Par23">If you compare TOTP <span id="ITerm38">with HOTP</span>, you will notice that in fact TOTP can be represented as follows:<div class="ProgramCode" id="PC5"><div class="LineGroup"><div class="FixedLine">TOTP = HOTP(s,TC)</div></div></div></div><p class="Para" id="Par24">TOTP is provisioned to the end user in the same way as HOTP—a shared secret is established between the token and the authentication server. During provisioning, clocks need to be synchronized as well.</p><p class="Para" id="Par25">Verifying a TOTP is similar to the <span id="ITerm39">verification</span> done for HOTP. The main difference is that the server must also calculate the current time counter and use it for calculating its own TOTP for comparison. The authentication server can typically accept TOTPs generated from timestamps that differ by one time interval from the client’s timestamp, but this depends on the actual configuration of the server.</p><p class="Para" id="Par26">For TOTPs, the problem of <span id="ITerm40">desynchronization</span> between the token and the server is largely alleviated because of the use of time and not a counter. Of course, the clocks can still go out-of-sync significantly and some form of token resynchronization may be required. For example, two TOTP values can be used to search for those passcodes in a larger window back and forth for resynchronization purposes. Furthermore, it may also be possible to do auto-resynchronization.</p><p class="Para" id="Par27">For example, if the OTP value does not match during authentication, the server can save this passcode. When the user tries to sign in by providing the next generated passcode, then the server can use both OTPs (previous and current) to perform <span id="ITerm41">synchronization</span> to a bigger time window. Such a method allows the use of TOTP even for those users who use 2FA very rarely.</p><div class="Para" id="Par28">Because <span id="ITerm42">TOTP</span> is generally usable for only a known and limited amount of time, it can be considered more secure than HOTP. (It is still only a one-time password so if it is used in a single window then it cannot be reused in that window again.) An example of a software token (Google Authenticator) with registered TOTPs and HOTP is depicted in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig4">7-4</a></span>. You can see that an HOTP can be <span id="ITerm43">regenerated</span> at the user’s will, while a TOTP changes at each interval automatically.<figure class="Figure" id="Fig4"><div class="MediaObject" id="MO4"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig4_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig4_HTML.jpg" style="height:23.82em" width="768" height="953" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig4_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-4</span><p class="SimplePara"><span id="ITerm44">Google</span><span id="ITerm45">
                        
                        
                      </span> Authenticator with two TOTPs and one HOTP</p></div></figcaption></figure></div><p class="Para" id="Par29">Both <span id="ITerm46">HOTP</span> and <span id="ITerm47">TOTP</span> have nothing that binds these tokens to a session between the person’s browser and the server, hence there is a possibility of man-in-the-middle or man-in-the-browser attacks.</p><div class="Para" id="Par30">An example is depicted in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig5">7-5</a></span> that shows a <span id="ITerm48">man-in-the-middle attack</span> where the victim is tricked into accessing the attacker’s website, which is pretending to be a legitimate banking site. The victim may have checked for a secure SSL connection (green lock), but this might not help if the attacker hacked the target organization’s DNS server, added an A-record pointing to their malicious site, and obtained a valid <span id="ITerm49">SSL certificate</span> from a trusted CA. In one such attack, a hacker intercepted the credentials (username/password) as well as the OTPs (which was either HOTP or <span id="ITerm50">TOTP</span>) and reused them to steal a bundle of cash. The aforementioned attack vector is addressed in standards from the FIDO Alliance, presented later in this chapter. It could also have been prevented with mutual TLS.<figure class="Figure" id="Fig5"><div class="MediaObject" id="MO5"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig5_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig5_HTML.jpg" style="height:27.68em" width="1723" height="1107" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig5_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-5</span><p class="SimplePara"><span id="ITerm51">Man-in-the-middle attack</span> on one-time-passwords</p></div></figcaption></figure></div><p class="Para" id="Par31">HOTP<span id="ITerm52">
                
                
              </span> and <span id="ITerm53">TOTP</span> can be susceptible to brute force attacks as the lengths of OTPs are relatively small (typically between six to eight digits), where the attacker tries to guess the value of the OTP. Therefore, it is necessary to ensure that the server accepting OTPs implements some form of throttling and can detect these kinds of attacks. For example, after a few attempts, the server may force a delay before accepting another OTP or can lock the account and fall back to another authentication method. Importantly, HOTP and TOTP specifications, as defined in RFC 4228 and 6238 respectively, contain extensive sections on security considerations. These are worth a read for anyone seriously considering a deployment of these technologies.</p><p class="Para" id="Par32">Both HOTP <span id="ITerm54">and TOTP</span> rely on a secret shared between the token and the server. As discussed earlier, hardware tokens usually have the <span id="ITerm55">secret</span> (seed) already baked into them during the manufacturing process or need to be programmed using specialized software. Such tokens are designed to be tamper-resistant to deter reverse engineering and avoid leakage of the secret. Software tokens, which are commonly deployed on mobile phones, rely on the secret shared with them from the server. It is paramount that such tokens utilize encryption of those <span id="ITerm56">secrets</span> and rely on existing technologies, such as <span id="ITerm57">Secure Element (SE)</span> on Android or Secure Enclave (SE) for <span id="ITerm58">iPhone</span> for such encryption. Fortunately, existing software tokens that support HOTP or TOTP use strong cryptography following security best practices.</p><p class="Para" id="Par33">In terms of the authentication server, the key that is used for HOTP and TOTP needs to be stored securely. It is a good idea to use a Hardware Security Module (<span id="ITerm59">HSM)</span><span id="ITerm60">
                
              </span> for that purpose, which prevents export of cryptographic material. Interestingly, the RFC 4228 proposes two different ways of generating and securely storing such secrets: deterministic generation or random generation. Deterministic generation can be used to generate secrets on the fly during provisioning and validation. A secret is generated based on the master key (secret value) and some other public information (e.g., identifier of a token). The token itself holds the generated shared secret. Random generation is used only during provisioning and the generated secret must be kept on both the token and the server. See the “Security Considerations” section of RFC 4228 for more information.</p><p class="Para" id="Par34">Note that it is possible to improve security of the shared secret by using a composite shared secret, i.e., augmenting the seed value with some additional information. For example, the token would only store a basic seed and would also require the user to enter a PIN. The token would leverage the PIN, the stored seed, and the counter/time to calculate the required OTP. Such functionality is available on both software and hardware <span id="ITerm61">tokens</span>.</p></section></section><section class="Section1 RenderAsSection1" id="Sec5"><h2 class="Heading">Mutual SSL/TLS</h2><p class="Para" id="Par35">Nearly every user of the Internet has been exposed to the <span id="ITerm62">SSL</span> (Secure Sockets Layer) and TLS (Transport Layer Security) <span id="ITerm63">protocols</span>, which have been securing transactions on the Internet since SSL has been introduced by Netscape to the public in 1995. Both SSL and TLS allow for authentication and encryption of <span id="ITerm64">interactions</span> between two different systems—the client and the server. TLS is the successor of the SSL protocol and provides the same functionality, allowing for two parties to communicate securely. Because of the differences in how these two protocols work, TLS does not interoperate with SSL, although the certificates used in SSL and TLS are the same.</p><div class="Para" id="Par36">When a user accesses a website over SSL or TLS with any modern web browser, the browser makes a secure connection to that website. The web browser aims to achieve two things when making an SSL/TLS <span id="ITerm65">connection</span>:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par37">Check that the server is the correct one.</p></li><li><p class="Para" id="Par38">Provide encrypted channel between the browser and the server.</p></li></ul></div></div><div class="Para" id="Par39">When making a connection with the server, the web browser first obtains an SSL/TLS certificate from the server. This certificate, encoded in X.509 format, contains the issuer of the certificate, the subject including the FQDN (Fully Qualified Domain Name) of the server, the public key of the subject, and the signature of the issuer, among other information. Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#PC6">7-1</a></span> shows an example of a <span id="ITerm66">X.509 certificate</span>.<div class="ProgramCode" id="PC6"><div class="LineGroup"><div class="FixedLine">Certificate:</div><div class="FixedLine">Data:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;Version: 3 (0x2)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;Serial Number: b7:41:8a:d5:00:5e:45:b6</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;Signature Algorithm: sha256WithRSAEncryption</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;Issuer: CN=GlobalSign CA - SHA256 - G2</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;Validity</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not Before: Nov 21 08:00:00 2016 GMT</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not After : Nov 22 07:59:59 2017 GMT</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;Subject: O=SampleCo,cn=A</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;Subject Public Key Info:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Public Key Algorithm: id-ecPublicKey</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Public-Key: (256 bit)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pub: 04:c9:22:69:31 [...omitted for brevity...]</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASN1 OID: prime256v1</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NIST CURVE: P-256</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[...omitted for brevity...]</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;Signature Algorithm: sha256WithRSAEncryption</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6f:af:40:72:bd:1e:18:5e:30:54:23:35:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[...omitted for brevity...]</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 7-1</span><p class="SimplePara">Sample <span id="ITerm67">Certificate</span></p></div></div></div></div><p class="Para" id="Par40">The browser can easily check the identity of the server based on the certificate that it receives. First, the browser knows which URL is being accessed and it can compare it against the FQDN specified in the <span id="ITerm68">X.509 certificate</span>. Second, the SSL/TLS contains an issuer signature, which allows the client to verify if the certificate is valid or not. The certificate must be signed by an certification authority (CA) that’s trusted by the browser and this is where the chain of trust kicks in—it defines which CAs are trusted and which are not (this prevents anyone from creating a certificate for any domain).</p><p class="Para" id="Par41">Once the web browser authenticates the server, an <span id="ITerm69">encrypted channel</span> can be established. This channel uses a symmetric key that can be shared between the browser and the server, leveraging the public key from the certificate (for more information we refer the reader to the TLS protocol specification).</p><div class="Para" id="Par42">Mutual SSL/TLS differs only slightly from a typical SSL/TLS handshake, as it involves sharing of the client certificate and additional verification (see Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig6">7-6</a></span>). First, the server not only shares its certificate with the client, but it also requests client’s certificate. The server does that by sending a <span class="EmphasisFontCategoryNonProportional ">CertificateRequest</span> message to the client. Importantly, the server needs to be configured to send such messages (i.e., it is not the client that communicates to the server that it wishes to authenticate with a certificate). The <span class="EmphasisFontCategoryNonProportional ">CertificateRequest</span> message indicates to the client that the server would like the connection to be mutually authenticated and that the client should authenticate using an SSL/TLS certificate. The server also sends the list of Distinguished CA names.<figure class="Figure" id="Fig6"><div class="MediaObject" id="MO6"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig6_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig6_HTML.jpg" style="height:29.05em" width="1725" height="1162" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig6_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-6</span><p class="SimplePara">
                    <span id="ITerm70">Mutual SSL/TLS</span>
                    <span id="ITerm71">
                      
                      
                    </span>
                  </p></div></figcaption></figure></div><div class="Para" id="Par43">Upon receiving these messages, the client either sends a pre-configured certificate to the server or asks the person to select the certificate that should be sent (we visualize this in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig7">7-7</a></span>). The browser only selects the certificates that have been issued by a CA trusted by the server. Once a certificate is selected, the browser responds to the server with a certificate message, which contains the client’s certificate. In most cases, the user can ask the browser to remember their decision and use the same certificate on subsequent logons. In such cases, the user would not need to explicitly authenticate to the server but instead this process would happen in the background.<figure class="Figure" id="Fig7"><div class="MediaObject" id="MO7"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig7_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig7_HTML.jpg" style="height:44.62em" width="1418" height="1785" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig7_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-7</span><p class="SimplePara">A web browser requests a user to select a client certificate for authentication (self-signed certificate example)</p></div></figcaption></figure></div><p class="Para" id="Par44">The <span id="ITerm72">client certificate</span> is similar to the certificate of a server, i.e., it contains the same set of fields. However, there are two key differences between these two types of certificates. First, the certificate’s Enhanced Key Usage field has the OID set to (1.3.6.1.5.5.7.3.2), which represents “Client Authentication”. Second, the subject in a client certificate describes the identity of the user and most likely differs from the FQDN. For example, the subject may contain a DN of the person or their email address.</p><p class="Para" id="Par45">Based on the subject identifier from the certificate, the server can establish the identity of the person—possession of the certificate (and the corresponding private key) is evidence of identity.</p><p class="Para" id="Par46">You may wonder why the server would trust the <span id="ITerm73">certificate</span> presented from the client. After all, this <span id="ITerm74">certificate</span> can be public as it contains the public key, among other information. However, the server authenticates the client based on a challenge-response protocol, which requires control of the private key corresponding to the public key in the certificate. During the TLS <span id="ITerm75">negotiation</span>, the client also sends a <span class="EmphasisFontCategoryNonProportional ">CertificateVerify</span> message. This message contains a signature of some session related information, and this signature is created using the private key owned by the client. The server can use the corresponding public key from the certificate to verify the signature (see Step 6 in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig6">7-6</a></span>). We refer the reader to RFC 5246 for more information regarding TLS as well as client certificate authentication. Importantly, the server should use an Online Certificate Status Protocol (OCSP) to query the certificate authority’s OCSP and see if the client’s certificate is still valid (and not revoked).</p><p class="Para" id="Par47">One of the <span id="ITerm76">advantages</span> of mutual SSL/TLS is that there is no shared secret between the client and server. Because the client first authenticates the server, phishing can be prevented, although the user must check if the server being accessed is the correct one (the browser would flag any anomalies or even prevent accessing a site if such site would rely on SSL certificate pinning). Similarly, the man-in-the-middle attacks can be alleviated, as a secure channel can be established between the browser and the server.</p><p class="Para" id="Par48">In practice, mutual SSL/TLS is rarely used for authentication on the <span id="ITerm77">Internet</span>. This is primarily because of the deployment burden that requires a user to obtain and install an SSL/TLS certificate on their computer. Such installation needs to be done on each machine that the user wishes to use for a particular site. Such certificates may expire, which means that the user would need to update them periodically. Sometimes, certificates may need to be revoked and a new certificate issued to the person. If you think about the amount of support that an average person requires just for their username and password credentials, you can imagine the pain of then managing client certificates.</p><p class="Para" id="Par49">The <span id="ITerm78">exception</span> is government sites and sometimes “intranets” (if such a thing still exists). In the first case, users can obtain digital certificates to access highly sensitive websites that require not only authentication but also non-repudiation. As the number of sites is usually limited, the burden of deploying a client certificate authentication system is somewhat minimized. For the intranet case, browser versions are tightly controlled, and certificates are centrally managed. Furthermore, sometimes such certificates can be distributed on physical devices—e.g., <span id="ITerm79">X.509 certificates</span> can be placed on smartcards that must be inserted into a computer for <span id="ITerm80">authentication</span>.</p></section><section class="Section1 RenderAsSection1" id="Sec6"><h2 class="Heading">Fast Identity Online (FIDO)</h2><p class="Para" id="Par50">Fast Identity Online (FIDO) is one of the most important recent efforts to standardize a technology stack for web and mobile authentication. The <span id="ITerm81">FIDO</span> standards, incubated by the FIDO Alliance, includes protocols for token based and biometric authentication, including the Universal Authentication Framework (UAF) <span id="ITerm82">
              
              
            </span><span id="ITerm83">
              
            </span> and <span id="ITerm84">Universal 2nd Factor (U2F)</span>.</p><p class="Para" id="Par51">FIDO provides an abstraction layer between the authenticator and the target application that relies on the <span id="ITerm85">authentication process</span>. Normally, during authentication, a person would leverage their device (e.g., laptop or mobile device) to authenticate themselves and this device would be an intermediate between the person and the target application. For example, the web browser would pass information to the server while a mobile application could authenticate locally or remotely.</p><p class="Para" id="Par52">For simplicity, when discussing FIDO, we refer to an IDP as an example of a target application (within the text as well as in the presented figures). However, the target application in this context is any application that relies on the authentication event, for example, the login page of a SAML or <span id="ITerm86">OpenID Connect</span> provider, or even a standalone website that is providing its own authentication service.</p><p class="Para" id="Par53">In FIDO, the intermediate is the authenticator—software running within a web browser, mobile device, or on a separate hardware token. Such <span id="ITerm87">authenticator</span> is responsible for verifying the person’s presence. Upon successful verification, this authenticator then communicates with the IDP using a standardized protocol that FIDO defines.</p><p class="Para" id="Par54">FIDO authentication uses <span id="ITerm88">public key cryptography</span> where the private key is stored on a device that has a UAF/U2F software stack installed. Only the public key is registered with the FIDO IDP. Authentication is accomplished by challenging the authenticator to produce a valid signature. The authenticator uses its private key once the verification of the presence of the person is confirmed (e.g., users touch an authenticator or scan their fingerprints).</p><p class="Para" id="Par55">FIDO <span id="ITerm89">UAF and U2F</span> solve different use cases. UAF aims to provide a passwordless experience for authentication, while U2F supports a universal second factor, which can be added on top of existing authentication. Proving the identity of the person is done based on the valid signature of a challenge that is sent by the IDP to the authenticator. The use of the private key on the authenticator is allowed once user verification succeeds. Importantly, the private key never leaves the authenticator and is only used to sign a challenge. Furthermore, a new cryptographic key pair is created for each IDP with which a person interacts.</p><p class="Para" id="Par56">Using FIDO UAF or U2F requires that the client (e.g., a web browser or a mobile application) used to access the FIDO IDP supports this protocol. At the time of the publication of this book, Google Chrome and Mozilla Firefox natively support FIDO U2F, and a third-party extension exists for Apple Safari. Mobile applications can leverage existing SDKs or frameworks from software and hardware vendors. Android applications can also use the natively provided API for FIDO U2F. The beauty of the FIDO proposal is that it is an open standard, hence mobile developers can use their preferred SDKs without worrying if these will work with third-party FIDO servers.</p><p class="Para" id="Par57">In FIDO, the application recognizes the person through identity verification but does not recognize the identity of the person. Nor does FIDO authentication leak any correlatable identifier of the person—it simply enables a website or IDP to verify that it is the same authenticator that has been previously registered for this person’s account. Binding the authentication event to the identity of the person is therefore done outside of the FIDO protocol and such binding often depends on the actual domain where the protocol is used (e.g., banking, e-commerce, social networks, etc.). During deployment of an IAM solution, it is rarely necessary to think about this issue, as FIDO authentication is a means to identify a known person. But keep in mind that not all websites use a central <span id="ITerm90">IDP</span>, and the FIDO token is useful to the person for any site that supports it. We discuss how Gluu has adopted the FIDO technology in further sections of this chapter.</p><div class="Para" id="Par58">FIDO has several <span id="ITerm91">advantages</span> over traditional authentication mechanisms (see Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig8">7-8</a></span>). It allows the IDP to control which authenticators are allowed and which are explicitly forbidden. This functionality is achieved because each authenticator has metadata, which is referenced through a private key (called an attestation key) baked into the authenticator during its manufacturing process. Such metadata can include information such as the version of the authenticator, what modalities it supports, and what cryptographic capabilities it has.<figure class="Figure" id="Fig8"><div class="MediaObject" id="MO8"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig8_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig8_HTML.jpg" style="height:30em" width="1725" height="1200" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig8_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-8</span><p class="SimplePara">Comparison of traditional <span id="ITerm92">authentication</span> and FIDO authentication</p></div></figcaption></figure></div><p class="Para" id="Par59">An <span id="ITerm93">access-management</span> solution can leverage metadata about authenticators to set authentication policies. For example, a policy may specify that a fingerprint scan is sufficient to access basic functionality, while an iris scan is required to access more sensitive resources. Because the FIDO IDP understands which exact authenticator model is used, one can easily make risk-based policy decisions. For example, an access-management platform may only allow authenticators with a low false acceptance rate.</p><p class="Para" id="Par60">Because FIDO relies on <span id="ITerm94">public key cryptography</span>, there is no secret that is shared between the client and the FIDO server. This prevents several different attacks, which are present for traditional authentication systems. The authenticator would only use the private key to sign a challenge after successful user verification. Such <span id="ITerm95">signature</span> is bound to the TLS channel, which is established between the client and that server, hence preventing man-in-the-middle attacks. The FIDO server merely stores a public key associated with the authenticator, so an attack on such a server would not result in any shared secret being revealed. Such public key differs per website, which prevents the correlation of a person with a single <span id="ITerm96">authenticator</span>.</p><section class="Section2 RenderAsSection2" id="Sec7"><h3 class="Heading">FIDO Universal Authentication Framework (UAF)</h3><div class="Para" id="Par61">FIDO UAF aims to provide a passwordless experience for authentication where the person is challenged to verify their presence against a registered authenticator (see Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig9">7-9</a></span>). Like U2F, the person must first register their device (which supports UAF) at the <span id="ITerm97">IDP</span>. Then, instead of having to remember a password on that device, the person can authenticate using a local biometric or PIN, which unlocks the private key. UAF also allows experiences that combine multiple authentication mechanisms, hence the remote account can be protected with multiple factors such as <span id="ITerm98">fingerprint and PIN</span>.<figure class="Figure" id="Fig9"><div class="MediaObject" id="MO9"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig9_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig9_HTML.jpg" style="height:23.3em" width="1725" height="932" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig9_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-9</span><p class="SimplePara">FIDO UAF <span id="ITerm99">high-level architecture</span></p></div></figcaption></figure></div><p class="Para" id="Par62">The IDP needs to be able to interact with the FIDO server that can interact with the device using the FIDO protocol. Such FIDO server can allow for specifying authentication policies based on authenticator characteristics (which are defined in authenticator metadata).</p><p class="Para" id="Par63">UAF <span id="ITerm100">authenticators</span> may be connected to a person’s device via various physical interfaces, such as SPI, USB, or Bluetooth. The UAF <span id="ITerm101">Authenticator-Specific Module (ASM)</span> is an interface on top of UAF authenticators. This interface gives FIDO UAF clients a standard way of accessing specific authenticators and hides the internal communication with these authenticators. For example, a FIDO UAF client would interact with a biometric authenticator in the same way as it would interact with a hardware token (improving the cost and deployability).</p><div class="Para" id="Par64">The FIDO UAF authentication <span id="ITerm102">protocol</span> consists of two main parts: registration and authentication. Registration is initiated by a client, which asks the server to send a challenge as well as policy of permissible authenticators. The client uses the policy to search for an available authenticator and presents it to the end user. The user enrolls depending on the authenticator (e.g., they can scan their fingerprint or provide a PIN). Upon successful enrollment, the authenticator generates a new public/private key pair. The private key is stored securely within an authenticator and is used to sign a challenge while the public key is registered at the server. The client then sends to the server the following information: a generated public key, a signature of the challenge, and an attestation key of the authenticator. The server verifies the signature and the attestation key whether it matches permissible ones, and then stores the user public key. We visualize this process in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig10">7-10</a></span>.<figure class="Figure" id="Fig10"><div class="MediaObject" id="MO10"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig10_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig10_HTML.jpg" style="height:24.55em" width="1725" height="982" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig10_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-10</span><p class="SimplePara">FIDO UAF <span id="ITerm103">registration message flow</span></p></div></figcaption></figure></div><div class="Para" id="Par65">During authentication, which is initiated by a client, the server sends a challenge and a policy that defines which authenticators may be used. It is the <span id="ITerm104">client’s responsibility</span> to then communicate with the correct authenticator that verifies the person’s presence and produces a signature of the challenge using a securely stored private key for the person and this target application. The client then responds with the signature. The server checks if the signature is correct and it does that using the corresponding public key of the user. Upon successful verification, the person can be signed in to the relying party. We visualize the UAF authentication message flow in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig11">7-11</a></span>.<figure class="Figure" id="Fig11"><div class="MediaObject" id="MO11"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig11_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig11_HTML.jpg" style="height:24.55em" width="1725" height="982" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig11_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-11</span><p class="SimplePara">FIDO UAF <span id="ITerm105">authentication message flow</span></p></div></figcaption></figure></div><p class="Para" id="Par66">Apart from authentication, the FIDO UAF protocol also enables optional transaction confirmation. Such functionality is of paramount importance for use cases such as <span id="ITerm106">banking</span> where information like a payment amount needs to be securely authorized. With a transaction confirmation, apart from sending a challenge, the server also communicates the transaction text to the device, which the person can authorize.</p><div class="Para" id="Par67">After a successful authentication, the authenticator signs the concatenated challenge and transaction text hash, which is returned to the server. This <span id="ITerm107">signature</span> is then verified using the registered public key for the person’s account. We visualize the FIDO UAF transaction confirmation message flow in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig12">7-12</a></span>. For more information on this functionality in FIDO, we refer the reader to the FIDO specification.<figure class="Figure" id="Fig12"><div class="MediaObject" id="MO12"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig12_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig12_HTML.jpg" style="height:24.55em" width="1725" height="982" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig12_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-12</span><p class="SimplePara">FIDO UAF <span id="ITerm108">confirmation message flow</span></p></div></figcaption></figure></div><p class="Para" id="Par68">Once a device, which is used for UAF authentication, is lost there is no way of restoring credentials (i.e., the private keys on that device are kept secure). Hence, it is important that the person registers multiple strong authenticators and disables the lost authenticator.</p></section><section class="Section2 RenderAsSection2" id="Sec8"><h3 class="Heading">FIDO Universal Second Factor (U2F)</h3><p class="Para" id="Par69">The FIDO U2F <span id="ITerm109">protocol</span> allows for online services to add a second factor on top of an existing authentication. Typically the person would use their password as step one of the authentication, and then the FIDO U2F device in the second step. Because FIDO U2F is built into the browser, it prevents phishing via the <span id="ITerm110">MITM attack</span> described in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig5">7-5</a></span>. Combining phishing resistance, a very low failure rate (compared to OTP which is around 3%), wide availability of USB-A or USB-C interfaces on many devices, and a robust market of vendors producing a variety of token form factors, FIDO U2F is one of the most deployable strong authentication choices available to organizations.</p><p class="Para" id="Par70">The U2F standard also defines both <span id="ITerm111">registration</span> and authentication protocols. Registration is very similar to the one described for UAF. During an authenticated session, a relying party sends a challenge and a policy to the IDP. One of the permitted authenticators must be used to authenticate the person, produce a public/private key pair and then sign the challenge. The signature, along with the authenticator’s attestation key and the generated public key is returned to the relying party and checked by the FIDO server. If the verification is successful, then the public key is registered for the person’s account.</p><div class="Para" id="Par71">The FIDO U2F authentication flow is presented in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig13">7-13</a></span>. After the person submits their credentials, the FIDO server sends a challenge to the client and a policy of permissible authenticators. The client authenticates the person through one of those authenticators. In U2F, the user would press a button on the U2F device, tap it over an NFC reader or scan their finger on a FIDO-compliant mobile fingerprint scanner. This unlocks the private key of the device to be used similarly UAF—i.e., to sign a challenge sent by the server. Once a signature is produced, it is returned to the relying party. The relying party verifies that signature using the corresponding registered public key.<figure class="Figure" id="Fig13"><div class="MediaObject" id="MO13"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig13_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig13_HTML.jpg" style="height:22.62em" width="1713" height="905" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig13_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-13</span><p class="SimplePara">FIDO U2F <span id="ITerm112">message flow</span></p></div></figcaption></figure></div></section></section><section class="Section1 RenderAsSection1" id="Sec9"><h2 class="Heading">W3C Web Authentication and CTAP</h2><p class="Para" id="Par72">Adoption of the FIDO <span id="ITerm113">protocol</span> has been largely dependent on support for this protocol by a specific platform. For example, <span id="ITerm114">Android</span> for the last few years has provided the necessary APIs that allow developers to use the functionality of credential creation and subsequent authentication for native applications. On the web, some browsers, such as <span id="ITerm115">Google Chrome</span> or Mozilla Firefox, provided support for FIDO U2F, but the lack of ubiquitous browser support was problematic for application developers.</p><div class="Para" id="Par73"><span id="ITerm116">FIDO 2.0</span> was developed to add features that addressed requirements important to a wider range of browser vendors. It includes two components: the Web Authentication Protocol and the Client to Authenticator Protocol (CTAP). They are complementary and provide a comprehensive suite for strong authentication. Relationships between Web Authentication API and CTAP are visualized in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig14">7-14</a></span>.<figure class="Figure" id="Fig14"><div class="MediaObject" id="MO14"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig14_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig14_HTML.jpg" style="height:23.38em" width="1725" height="935" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig14_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-14</span><p class="SimplePara"><span id="ITerm117">Overview</span> of W3C Web Authentication and related CTAP</p></div></figcaption></figure></div><p class="Para" id="Par74">The Web Authentication <span id="ITerm118">API</span>, incubated by the FIDO Alliance and standardized by The <span id="ITerm119">World Wide Web Consortium (W3C)</span>, provides a mechanism for interacting with the FIDO Authenticator. It defines a common and public API which, if implemented by a browser, enables a web application (such as an IDP) to request authentication using the FIDO protocol. Like FIDO U2F, the W3C Web Authentication API defines an API for registration (i.e., enrollment of a credential) and authentication. <span id="ITerm120">Vendors</span> such as Microsoft, Google, and Mozilla already support this standard in their web browsers.</p><p class="Para" id="Par75">In addition to the <span id="ITerm121">API</span>, W3C Web Authentication also defines a key attestation format and a signature format. The API is used by the website or web application—a simple JavaScript application can call this API on the user’s web browser. Registration communicates data about the authenticator (<span class="EmphasisFontCategoryNonProportional ">makeCredential</span> endpoint), which is stored on the server and used later for authentication (<span class="EmphasisFontCategoryNonProportional ">getAssertion</span> endpoint). Much of the heavy lifting is done by the browser, which creates necessary messages and provides error handling. The authenticator performs authentication operations and produces the attestation.</p><div class="Para" id="Par76">The <span id="ITerm122">key attestation format</span> and the <span id="ITerm123">signature format</span> are the two elements that define what information is passed between the web browser and the server for registration and authentication. This includes information about the authenticator itself, and the proof of possession of a private key of the FIDO 2.0 credential. We visualize credential registration as well as the use of a scoped credential in Figures <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig15">7-15</a></span> and <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig16">7-16</a></span>, respectively.<figure class="Figure" id="Fig15"><div class="MediaObject" id="MO15"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig15_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig15_HTML.jpg" style="height:17.42em" width="1723" height="697" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig15_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-15</span><p class="SimplePara">W3C Web Authentication API: <span id="ITerm124">registration operation</span></p></div></figcaption></figure><figure class="Figure" id="Fig16"><div class="MediaObject" id="MO16"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig16_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig16_HTML.jpg" style="height:16.27em" width="1723" height="651" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig16_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-16</span><p class="SimplePara">W3C Web Authentication API: authentication operation</p></div></figcaption></figure></div><div class="Para" id="Par77">CTAP defines how the FIDO client running on a specific platform, e.g. an <span id="ITerm125">operating system</span> or a web browser, can talk to an external authenticator such as a USB-powered security key or a mobile phone that can interact with the computer via NFC or Bluetooth. Combining W3C Web Authentication and CTAP solves a variety of use cases in a simple and standardized way. For example, a person can sign in to a website such as an IDP using their <span id="ITerm126">smartphone</span> as an external authenticator, which communicates with the person’s laptop over a Bluetooth connection (see Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig17">7-17</a></span>). You should read the specifications of W3C Web Authentication and FIDO 2.0 CTAP for more detailed information.<figure class="Figure" id="Fig17"><div class="MediaObject" id="MO17"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig17_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig17_HTML.jpg" style="height:17.2em" width="1723" height="688" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig17_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-17</span><p class="SimplePara">FIDO client to authenticator protocol use case: user authenticates to IDP using a smartphone as an external authenticator</p></div></figcaption></figure></div></section><section class="Section1 RenderAsSection1" id="Sec10"><h2 class="Heading">Setting Up 2FA with the&nbsp;Gluu Server</h2><p class="Para" id="Par78">It’s important to understand how <span class="EmphasisFontCategoryNonProportional ">acr</span> works in the Gluu <span id="ITerm127">Server</span>. ACR stands for authentication context class reference. It is jargon used both in SAML and OpenID Connect to specify what kind of authentication happened. In an OpenID Connect authentication request, one of the parameters defined is <span class="EmphasisFontCategoryNonProportional ">acr_values</span>. This is the primary way for a client to signal to the <span id="ITerm128">OpenID Provider</span> (OP) the preferred way to authenticate the subject. A client may also specify <span class="EmphasisFontCategoryNonProportional ">default_acr_values</span> during registration (and omit the parameter while making an authentication request). In the Gluu Server configuration, <span class="EmphasisFontCategoryNonProportional ">acr</span> is used to name the authentication workflow.</p><p class="Para" id="Par79">Organizations have a wide array of requirements for <span id="ITerm129">login</span>—not just how to authenticate the person, but how to log, detect fraud, gather consent, and sometimes even update personal data records on the fly. The diversity of authentication business logic requirements for organizations are so varied, it is difficult (if not impossible) to build a GUI that provides the needed flexibility. Gluu’s solution was to create an authentication “interception script”—a standard interface that enables developers to code the exact workflow they need. The goal is to enable extension of the Gluu Server, without forking the core code (which makes it harder to keep current with updates). Gluu uses the interception script approach in several places—not just for authentication. For example, in the next chapter, you see how interception scripts are also used to express policies about when to grant access tokens using the <span id="ITerm130">UMA protocol</span>. The interception script that we discuss here is called “Person Authentication”.</p><div class="Para" id="Par80">When you install the Gluu Server, password authentication is enabled by default. You can see this in the oxTrust admin interface, under the Configuration, Manage Authentication section, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig18">7-18</a></span>. You can specify the <span class="EmphasisFontCategoryNonProportional ">acr</span> for oxTrust, which is an easy way to test an authentication workflow, although it’s also an easy way to lock yourself out, in which case you may have to change it back to password. In case you forgot your LDAP from Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_2_Chapter.xhtml" class="totri-footnote"><span class="RefSource">2</span></a></span>, do something like Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#PC7">7-2</a></span> (replacing the <span class="EmphasisFontCategoryNonProportional ">inum</span> to match the entry under <span class="EmphasisFontCategoryNonProportional ">ou=appliances,o=gluu</span> for your instance).<figure class="Figure" id="Fig18"><div class="MediaObject" id="MO18"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig18_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig18_HTML.jpg" style="height:16.6em" width="1725" height="664" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig18_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-18</span><p class="SimplePara">Configuring the <span id="ITerm131">default authentication method</span> in the Gluu Server (oxTrust)</p></div></figcaption></figure></div><div class="Para" id="Par81">
            <div class="ProgramCode" id="PC7"><div class="LineGroup"><div class="FixedLine">dn: inum=@!7A1F!0002!02C3.DD97,ou=appliances,o=gluu</div><div class="FixedLine">changetype: modify</div><div class="FixedLine">replace: oxTrustAuthenticationMode</div><div class="FixedLine">oxTrustAuthenticationMode: auth_ldap_server</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 7-2</span><p class="SimplePara">Sample <span id="ITerm132">LDIF</span> to Revert to Password Authentication If You Lock Yourself Out</p></div></div></div>
          </div><div class="Para" id="Par82">You then load the <span class="EmphasisFontCategoryNonProportional ">ldif</span>, as shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#PC8">7-3</a></span> (setting the right values for <span class="EmphasisFontCategoryNonProportional ">-j</span> and <span class="EmphasisFontCategoryNonProportional ">-f</span> of course).<div class="ProgramCode" id="PC8"><div class="LineGroup"><div class="FixedLine">$ /opt/opendj/bin/ldapmodify -h localhost -p 1636 \</div><div class="FixedLine">-D "cn=directory manager" -j ~/.pw -Z -X -f fix-login.ldif</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 7-3</span><p class="SimplePara">Sample ldapmodify to Revert to Password <span id="ITerm133">Authentication</span></p></div></div></div></div><div class="Para" id="Par83">If your OpenID Connect script supports setting the <span class="EmphasisFontCategoryNonProportional ">acr_values</span> parameter<span id="ITerm134">
              
              
              
            </span>, that’s a great way to test. If you are using the <span class="EmphasisFontCategoryNonProportional ">oxd-server</span>, it allows this. In the <span id="ITerm135">Apache2 HTTP module</span>, <span class="EmphasisFontCategoryNonProportional ">mod_auth_openidc</span>, you can send extra parameters:<div class="ProgramCode" id="PC9"><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OIDCAuthRequestParams acr_values=u2f</div></div></div></div><p class="Para" id="Par84">Another way to test an authentication script is to set the “<span id="ITerm136">Default ACR</span>”—which is the authentication method used if the client fails to specify an <span class="EmphasisFontCategoryNonProportional ">acr</span>. The <span id="ITerm137">Default ACR</span> is also used for all SAML websites. Although in future versions of the Gluu Server, it may support the use of the <span class="EmphasisFontCategoryNonProportional ">AuthnContextClassRef</span> element in the SAML authentication request.</p><div class="Para" id="Par85">Although <span id="ITerm138">LDAP authentication</span> requires only the completion of the “Manage LDAP Authentication” form (<span class="EmphasisFontCategoryNonProportional ">acr = auth_ldap_server</span>), if you want to see the other types of authentication available or write your own custom authentication flow, you’ll need to look at the Person Authentication tab of the “Manage Custom Scripts” configuration section of oxTrust. You’ll notice immediately that the Gluu Server ships with several strong authentication mechanisms, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#Fig19">7-19</a></span>.<figure class="Figure" id="Fig19"><div class="MediaObject" id="MO19"><img alt="../images/425975_1_En_7_Chapter/425975_1_En_7_Fig19_HTML.jpg" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/425975_1_En_7_Fig19_HTML.jpg" style="height:30.42em" width="1725" height="1217" data-mfp-src="/library/view/securing-the-perimeter/9781484226018/images/425975_1_En_7_Chapter/425975_1_En_7_Fig19_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 7-19</span><p class="SimplePara"><span id="ITerm139">Custom authentication scripts</span> in the Gluu Server (oxTrust)</p></div></figcaption></figure></div><div class="Para" id="Par86">Each interception script has a different interface (i.e., what methods are available). For the Person Authentication script, the most interesting method is (not surprisingly) called <span class="EmphasisFontCategoryNonProportional ">authenticate</span>, which returns a Boolean depending on success or failure. Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#PC10">7-4</a></span> shows the authenticate method for the <span id="ITerm140">Duo Security script</span>. Duo is a SaaS authentication provider now owned by Cisco. This script has an interesting example of adaptive <span id="ITerm141">authentication</span>.<div class="ProgramCode" id="PC10"><div class="LineGroup"><div class="FixedLine">def authenticate(self, configurationAttributes, requestParameters, step):</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;duo_host = configurationAttributes.get("duo_host").getValue2()</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;authenticationService = CdiUtil.bean(AuthenticationService)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;identity = CdiUtil.bean(Identity)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;if (step == 1):</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print "Duo. Authenticate for step 1"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;credentials = identity.getCredentials()</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user_name = credentials.getUsername()</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user_password = credentials.getPassword()</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logged_in = False</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (StringHelper.isNotEmptyString(user_name) and</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringHelper.isNotEmptyString(user_password)):</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;userService = CdiUtil.bean(UserService)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logged_in =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;authenticationService.authenticate(user_name, user_password)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not logged_in):</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return False</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user = authenticationService.getAuthenticatedUser()</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (self.use_duo_group):</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print "Duo. Authenticate for step 1. Checking if user</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;belong to Duo group"<span id="ITerm142">
                    
                    
                    
                  </span></div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_member_duo_group = self.isUserMemberOfGroup(user,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.audit_attribute, self.duo_group)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (is_member_duo_group):</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print "Duo. Authenticate for step 1. User '" +</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user.getUserId() + "' member of Duo group"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;duo_count_login_steps = 2</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.processAuditGroup(user)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;duo_count_login_steps = 1</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identity.setWorkingParameter("duo_count_login_steps",</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;duo_count_login_steps)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return True</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;elif (step == 2):</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print "Duo. Authenticate for step 2"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user = authenticationService.getAuthenticatedUser()</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if user == None:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print "Duo Authn step 2. Failed to find user name"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return False</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user_name = user.getUserId()</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sig_response_array = requestParameters.get("sig_response")</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ArrayHelper.isEmpty(sig_response_array):</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print "Duo. Authn step 2. sig_response is empty"</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return False</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;duo_sig_response = sig_response_array[0]</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;authenticated_username = duo_web.verify_response(self.ikey,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.skey, self.akey, duo_sig_response)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print "Duo. Authn step 2. authenticated_username: " +</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;authenticated_username + ", expected user_name: " +</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user_name</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (not StringHelper.equals(user_name,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;authenticated_username)):</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return False</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return True</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;else:</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return False<span id="ITerm143">
                    
                    
                    
                  </span></div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 7-4</span><p class="SimplePara">Sample Authenticate Method of a Gluu Server Authentication Script</p></div></div></div></div><p class="Para" id="Par87">Two-factor is not the same as <span id="ITerm144">two-step authentication</span><span id="ITerm145">
              
              
            </span>. You could have a two-factor, one-step authentication. For example, many OTP tokens are two-factor, as they require a PIN number to unlock the token (something you know), and then the <span id="ITerm146">OTP code</span> is displayed (something you have). However, in this example, OTP authentication is processed in one step. A multi-step authentication workflow is more flexible because it enables you to look at the context in the first step and to decide if you need a second step. If you dynamically adjust the number of steps at runtime, this is called adaptive authentication.</p><p class="Para" id="Par88">The Gluu Server supports multi-step, adaptive authentication workflows. When the Gluu Server invokes the script, the step is sent to the <span class="EmphasisFontCategoryNonProportional ">authenticate</span> method as a parameter. In the script, you can switch on the step. That’s why there is a large block of code under <span class="EmphasisFontCategoryNonProportional ">if (step ==1):</span> and <span class="EmphasisFontCategoryNonProportional ">elif (step == 2)</span>.</p><p class="Para" id="Par89">The <span id="ITerm147">Duo authentication script</span> provides a nice example of adaptive authentication. The goal of this script was to allow for testing of two-factor authentication for a subset of accounts, before introducing it to the whole organization. After the password is validated, the script checks to see if the person is in a certain group—if so, the person is put through a two-step authentication. If not, the person can proceed with one step.</p><p class="Para" id="Par90">There are two other important methods that need to support adaptive authentication: <span class="EmphasisFontCategoryNonProportional ">getCountAuthenticationSteps</span><span id="ITerm148">
              
              
              
            </span> and <span id="ITerm149">
              <span class="EmphasisFontCategoryNonProportional ">getPageForStep</span>
              
              
              
            </span>. The former normally just returns 1 or 2. But for adaptive authentication, it checks a variable. The organization can also customize the two-factor authentication experience by using <span class="EmphasisFontCategoryNonProportional ">getPageForStep</span>. This determines which JSF page is returned for a given authentication workflow.</p><p class="Para" id="Par91">Using this approach, the Gluu Server supports a diverse range of authentication requirements. You can call the APIs of 2FA <span id="ITerm150">SaaS providers</span>, use custom Java or Python libraries, implement complex conditional logic, look at the security context of the authentication—if you can define an algorithm for authentication, you can implement it in the Gluu <span id="ITerm151">Server</span>.</p><section class="Section2 RenderAsSection2" id="Sec11"><h3 class="Heading">FIDO Support in the&nbsp;Gluu Server</h3><p class="Para" id="Par92">The Gluu Server has built-in FIDO authentication <span id="ITerm152">endpoints</span><span id="ITerm153">
                
                
              </span>. Current Gluu Servers publish a configuration document at <span class="EmphasisFontCategoryNonProportional ">.well-known/fido-configuration</span> (older Gluu Servers used <span class="EmphasisFontCategoryNonProportional ">/.well-known/fido-u2f-configuration</span>). Published here are the Gluu Server registration and authentication endpoints. Gluu also ships with built-in Person Interception scripts for FIDO U2F. FIDO 2 is supported in Gluu Server 3.1.5 and later.</p><p class="Para" id="Par93">When a FIDO credential is registered, the Gluu Server stores its metadata and public key in LDAP, under the person’s entry, in an organizational unit called <span class="EmphasisFontCategoryNonProportional ">ou=fido</span>. There is one entry for each FIDO device. Depending on the FIDO protocols used—U2F, FIDO 2, or UAF—the entry may contain a different amount of data. Gluu’s Super Gluu application also uses FIDO to authenticate devices and stores phone data in addition to FIDO data.</p><p class="Para" id="Par94">Storing the FIDO data in one attribute of the LDAP person entry would have made it difficult to index, as FIDO registration data also includes a public key. However, this design also required Gluu to add a FIDO SCIM profile (because it can’t be managed as simple user attribute). In Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_9_Chapter.xhtml" class="totri-footnote"><span class="RefSource">9</span></a></span>, we introduce a user-facing web credential management tool to enable people to add and remove FIDO credentials for their Gluu Server account.</p></section></section><section class="Section1 RenderAsSection1" id="Sec12"><h2 class="Heading">Other Ways to Strengthens Authentication with the&nbsp;Gluu Server</h2><p class="Para" id="Par95">Although some of the technologies are not commercially licensed, no 2FA technology is “free”. You always need to consider the cost of supporting people in your organization (who inevitably have questions), the productivity cost of failure, the cost of hardware, and the cost of deployment.</p><p class="Para" id="Par96">Remember that authentication is about <span id="ITerm154">risk mitigation</span>. Strengthening the credential itself is not always the best way to reduce risk. There is a ton of innovation in big data and artificial intelligence. Look for commercial providers of APIs that can help you identify risky transactions. There are various ways this is possible. For example, <span id="ITerm155">hackers</span> tend to re-use IP addresses for their attacks. Some security service providers can use the IP as input for a fraud score. You can also look at the credential itself. Sites like <span class="ExternalRef"><a href="https://haveibeenpwned.com/"><span class="RefSource">
                <span class="EmphasisFontCategoryNonProportional ">https://haveibeenpwned.com/</span>
              </span></a></span> will tell you if an email address was part of a breach. Other services, like Vericlouds, hash email address and password combinations purchased on the dark web, enabling you to detect if the credentials themselves have been exposed. With this kind of information, you can improve security by adding an authentication step and forcing the users to change their passwords.</p><p class="Para" id="Par97">The Gluu Server ships with several other 2FA authentication scripts, and many more are checked into GitHub: <span class="ExternalRef"><a href="https://github.com/GluuFederation/oxAuth/tree/master/Server/integrations"><span class="RefSource">
                <span class="EmphasisFontCategoryNonProportional ">https://github.com/GluuFederation/oxAuth/tree/master/Server/integrations</span>
              </span></a></span>. You should also check the latest docs for more information on how to write custom Person Authentication scripts if the ones available don’t exactly meet your needs.</p></section><section class="Section1 RenderAsSection1" id="Sec13"><h2 class="Heading">Conclusion</h2><p class="Para" id="Par98">People are analog. Computers are digital. For a computer to bridge this divide—to positively identify one person with a high degree of certainty—is incredibly difficult. As computers are getting more powerful, and as more hardware is becoming available to increase the sensory capabilities of computers in the analog world, they are getting better at it. But authentication is a moving target, because hackers are getting better at defeating the strategies. You need to think carefully about which authentication workflows to roll out in your organization. But doing nothing (i.e., just using passwords) is becoming less and less of an option. Crossing the digital-analog divide is a core capability for any sizable organization.</p></section><section class="Section1 RenderAsSection1" id="Sec14"><h2 class="Heading">References</h2><div class="Para" id="Par99">
            <div class="OrderedList"><ol><li class="ListItem"><span class="ItemNumber">1.</span><div class="ItemContent"><p class="Para" id="Par100">More information on best practices for deploying HOTP can be found in <span class="ExternalRef"><a href="https://www.yubico.com/wp-content/uploads/2016/02/YubicoBestPracticesOATH-HOTP.pdf"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://www.yubico.com/wp-content/uploads/2016/02/YubicoBestPracticesOATH-HOTP.pdf</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">2.</span><div class="ItemContent"><p class="Para" id="Par101">OATH is an industry-wide collaboration to develop an open reference architecture by leveraging existing open standards for the universal adoption of strong authentication. As of March 2018, members of this initiative include such companies as Symantec, Gemalto, Vasco, Yubico, among others.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">3.</span><div class="ItemContent"><p class="Para" id="Par102">RFC 4226: HOTP: An HMAC-Based One-Time Password Algorithm. Available at <span class="ExternalRef"><a href="https://tools.ietf.org/html/rfc4226"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/rfc4226</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">4.</span><div class="ItemContent"><p class="Para" id="Par103">RFC 6238: TOTP: Time-Based One-Time Password Algorithm.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">5.</span><div class="ItemContent"><p class="Para" id="Par104">Hickman, Kipp, “The SSL Protocol,” Netscape Communications Corp., February 9, 1995. Available at <span class="ExternalRef"><a href="https://tools.ietf.org/html/draft-hickman-netscape-ssl-00"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/draft-hickman-netscape-ssl-00</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">6.</span><div class="ItemContent"><p class="Para" id="Par105">In the text, we use the term SSL/TLS instead of focusing on any of these two protocols. In reality, we recommend using TLS only as all existing SSL versions have now been deprecated. Readers should use the latest version of TLS, which is 1.2, as specified in <span class="ExternalRef"><a href="https://tools.ietf.org/html/rfc5246"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/rfc5246</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">7.</span><div class="ItemContent"><p class="Para" id="Par106">RFC 5246: The Transport Layer Security (TLS) Protocol Version 1.2. Available at <span class="ExternalRef"><a href="https://tools.ietf.org/html/rfc5246"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://tools.ietf.org/html/rfc5246</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">8.</span><div class="ItemContent"><p class="Para" id="Par107">FIDO Alliance has been set up in 2013 to work on a standard for strong passwordless authentication and strong second factor. More information can be found at <span class="ExternalRef"><a href="https://fidoalliance.org/"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://fidoalliance.org/</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">9.</span><div class="ItemContent"><p class="Para" id="Par108">FIDO UAF specifications can be found at <span class="ExternalRef"><a href="https://fidoalliance.org/specs/fido-uaf-v1.1-ps-20170202/"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://fidoalliance.org/specs/fido-uaf-v1.1-ps-20170202/</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">10.</span><div class="ItemContent"><p class="Para" id="Par109">FIDO U2F specifications can be found at <span class="ExternalRef"><a href="https://fidoalliance.org/specs/fido-u2f-v1.2-ps-20170411/"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://fidoalliance.org/specs/fido-u2f-v1.2-ps-20170411/</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">11.</span><div class="ItemContent"><p class="Para" id="Par110">The private/public key pair is most typically generated within a secure hardware token (authenticator) that is designed to be tamper-proof, thereby preventing any leakage of the private key.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">12.</span><div class="ItemContent"><p class="Para" id="Par111">U2F Reference Implementations. Available at <span class="ExternalRef"><a href="https://github.com/google/u2f-ref-code"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://github.com/google/u2f-ref-code</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">13.</span><div class="ItemContent"><p class="Para" id="Par112">U2F Support Extension for Firefox. Available at <span class="ExternalRef"><a href="https://github.com/prefiks/u2f4moz"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://github.com/prefiks/u2f4moz</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">14.</span><div class="ItemContent"><p class="Para" id="Par113">W3C Web Authentication Specification. Available at <span class="ExternalRef"><a href="https://www.w3.org/TR/webauthn/"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://www.w3.org/TR/webauthn/</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">15.</span><div class="ItemContent"><p class="Para" id="Par114">FIDO Client to Authenticator Protocol. Available at <span class="ExternalRef"><a href="https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-client-to-authenticator-protocol-v2.0-ps-20170927.html"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-client-to-authenticator-protocol-v2.0-ps-20170927.html</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">16.</span><div class="ItemContent"><p class="Para" id="Par115">Anthony J. Nadalin. “New FIDO Specifications Overview - Strong Web Authentication,” December 8, 2016. Available at <span class="ExternalRef"><a href="https://www.slideshare.net/FIDOAlliance/new-fido-specifications-overview-fido-alliance-tokyo-seminar-nadalin"><span class="RefSource">
                        <span class="EmphasisFontCategoryNonProportional ">https://www.slideshare.net/FIDOAlliance/new-fido-specifications-overview-fido-alliance-tokyo-seminar-nadalin</span>
                      </span></a></span>.</p></div><div class="ClearBoth">&nbsp;</div></li></ol></div>
          </div></section></div><div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-0" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none;">
	<ul class="adders">
		
		<li class="copy"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#">Copy</a></li>
		
		<li class="add-highlight"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#">Add Highlight</a></li>
		<li class="add-note"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#">
			Add Note
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_6_Chapter.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">6.&nbsp;Proxy</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_8_Chapter.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">8.&nbsp;User-Managed Access</div>
        </a>
    
  
  </div>


        
    </section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    
      <div id="js-subscribe-nag" class="subscribe-nag clearfix trial-panel t-subscribe-nag collapsed slideUp">
        
        
          
          
            <p class="usage-data">Find answers on the fly, or master something new. Subscribe today. <a href="https://learning.oreilly.com/subscribe/" class="ga-active-trial-subscribe-nag">See pricing options.</a></p>
          

          
        
        

      </div>

    
    



        
      </div>
      
        


<footer class="pagefoot t-pagefoot" style="padding-bottom: 69px;">
  <a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" class="icon-up" onclick="window.Appcues.track(&#39;JumpTop_HeronBook&#39;)" style="display: none;"><div class="visuallyhidden">Back to top</div></a>
  <ul class="js-footer-nav">
  
    
    <li><a href="https://learning.oreilly.com/u/preferences/">Settings</a></li>
    
    <li><a href="https://learning.oreilly.com/public/support/">Support</a></li>
    
    <li><a href="https://learning.oreilly.com/accounts/logout/">Sign Out</a></li>
    
  
  
  </ul>
  <span class="copyright">© 2020 <a href="https://learning.oreilly.com/" target="_blank">O'Reilly Media, Inc</a>.</span>
  
    
    <a href="https://www.oreilly.com/terms/">Terms of Service</a> 
     / 
    
    <a href="https://learning.oreilly.com/privacy">Privacy Policy</a> 
    
    
  
</footer>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"agent":"","applicationID":"172641827,79672898,93931619","applicationTime":184,"transactionName":"YgdaZ0NSW0cEB0RdWltNfkZfUEFdCgofXFBHDVYdR1pQQxZeRl1QQj1aWkU=","errorBeacon":"bam.nr-data.net","licenseKey":"510f1a6865","queueTime":2,"beacon":"bam.nr-data.net"}</script>

      
    
    <script src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource" charset="utf-8"></script>
    <script src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource(1)" charset="utf-8"></script><script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1732687426968531");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1732687426968531&amp;ev=PageView&amp;noscript=1"></noscript><script type="text/javascript" id="">(function(){window.medalliaUserIdentifier=document.documentElement.dataset.userUuid;window.medalliaUserName=document.documentElement.dataset.username})();</script>
<script type="text/javascript" id="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/embed.js"></script>
<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","443792972845831");fbq("set","agent","tmgoogletagmanager","443792972845831");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=443792972845831&amp;ev=PageView&amp;noscript=1"></noscript>

<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","443792972845831");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=443792972845831&amp;ev=PageView&amp;noscript=1"></noscript>
<script type="text/javascript" id="">window._pp=window._pp||[];if("\/library\/view\/securing-the-perimeter\/9781484226018\/html\/425975_1_En_7_Chapter.xhtml"=="/confirmation/nnv/"&&"https:\/\/learning.oreilly.com\/library\/view\/securing-the-perimeter\/9781484226018\/html\/Cover.xhtml"=="https://learning.oreilly.com/register/")_pp.targetUrl="/confirm/trial";else if("\/library\/view\/securing-the-perimeter\/9781484226018\/html\/425975_1_En_7_Chapter.xhtml"=="/confirmation/nv/"&&"https:\/\/learning.oreilly.com\/library\/view\/securing-the-perimeter\/9781484226018\/html\/Cover.xhtml"=="https://learning.oreilly.com/subscribe/")_pp.targetUrl="/confirm/paid";else if("\/library\/view\/securing-the-perimeter\/9781484226018\/html\/425975_1_En_7_Chapter.xhtml"=="/confirmation/nnv/"&&"https:\/\/learning.oreilly.com\/library\/view\/securing-the-perimeter\/9781484226018\/html\/Cover.xhtml"=="https://learning.oreilly.com/signup/")_pp.targetUrl="/confirm/paid";_pp.siteId="2508";
_pp.siteUId="39a88cd5-54f5-4d61-aec6-7884d06dfba1";_pp.orderValue="undefined";_pp.orderId="undefined";(function(){var ppjs=document.createElement("script");ppjs.type="text/javascript";ppjs.async=true;ppjs.src=("https:"==document.location.protocol?"https:":"http:")+"//cdn.pbbl.co/r/"+_pp.siteId+".js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ppjs,s)})();</script>
  

<div></div><div></div><iframe id="nr-ext-rsicon" style="position: absolute; display: none; width: 50px; height: 50px; z-index: 2147483647; border-style: none; background: transparent;" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/saved_resource(5).html"></iframe><div class="annotator-notice"></div><div class="font-flyout" style="top: 151.004px; left: 1583px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="https://learning.oreilly.com/library/view/securing-the-perimeter/9781484226018/html/425975_1_En_7_Chapter.xhtml#">Reset</a>
</div>
</div><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.7843105926346203"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.725444032915123" width="0" height="0" alt="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/0"></div><iframe height="0" width="0" frameborder="0" style="display: none;" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/pp.html"></iframe><script type="text/javascript" async="" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/generic1585109433606.js" charset="UTF-8"></script><span></span><div style="display: none; visibility: hidden;"><script>(function(){if(null!==document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]')&&void 0!==document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]')){var a=!1;window.addEventListener("blur",function(){a&&dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"facebook",eventVal:0,nonInteraction:0})});document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]').addEventListener("mouseover",function(){window.focus();
a=!0});document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]').addEventListener("mouseout",function(){a=!1})}if(null!==document.querySelector("iframe.twitter-share-button")&&void 0!==document.querySelector("iframe.twitter-share-button")){var b=!1;window.addEventListener("blur",function(){b&&dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"twitter",eventVal:0,nonInteraction:0})});document.querySelector("iframe.twitter-share-button").addEventListener("mouseover",
function(){window.focus();b=!0});document.querySelector("iframe.twitter-share-button").addEventListener("mouseout",function(){b=!1})}try{window.twttr=function(a,b,d){var c,e=a.getElementsByTagName(b)[0];if(!a.getElementById(d))return a=a.createElement(b),a.id=d,a.src="//platform.twitter.com/widgets.js",e.parentNode.insertBefore(a,e),window.twttr||(c={_e:[],ready:function(a){c._e.push(a)}})}(document,"script","twitter-wjs"),twttr.ready(function(a){a.events.bind("tweet",trackTwitter)})}catch(c){}})();
null!==document.querySelector(".IN-widget")&&void 0!==document.querySelector(".IN-widget")&&document.querySelector(".IN-widget").addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"linkedin",eventVal:0,nonInteraction:0})});
function trackTwitter(a){a&&(a.target&&"IFRAME"==a.target.nodeName&&(opt_target=extractParamFromUri(a.target.src,"url")),dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"twitter",eventVal:0,nonInteraction:0}))}function extractParamFromUri(a,b){if(a&&(b=new RegExp("[\\?\x26#]"+b+"\x3d([^\x26#]*)"),a=b.exec(a),null!=a))return unescape(a[1])};</script></div><script type="text/javascript" id="">function forceInputUppercase(a){var b=a.target.selectionStart,c=a.target.selectionEnd;a.target.value=a.target.value.toUpperCase();a.target.setSelectionRange(b,c)}void 0!=document.getElementById("id_promotion")&&null!=document.getElementById("id_promotion")&&document.getElementById("id_promotion").addEventListener("keyup",forceInputUppercase,!1);
void 0!=document.getElementsByName("promotionCode")[0]&&null!=document.getElementsByName("promotionCode")[0]&&document.getElementsByName("promotionCode")[0].addEventListener("keyup",forceInputUppercase,!1);</script><script type="text/javascript" id="">var nonwExpandable=document.querySelectorAll(".orm-ff-NavigationSubnav-headerListItem a, .orm-ff-NavigationView-headerListItem a");nonwExpandable.forEach(function(a,b){b+1!=nonwExpandable.length?a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.childNodes[1].textContent})}):b+1==nonwExpandable.length&&a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"user login",eventAct:"logout",eventLbl:"global nav | unified"})})});
var nonwExpandableFo=document.querySelectorAll(".drop-content li:not(.flyout-parent) a");
nonwExpandableFo.forEach(function(a,b){"drop-content"==a.parentNode.parentNode.parentNode.className&&b+1!=nonwExpandableFo.length?a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.childNodes[1].textContent})}):"drop-content"==a.parentNode.parentNode.parentNode.className&&b+1==nonwExpandableFo.length&&a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"user login",eventAct:"logout",eventLbl:"global nav | unified"})})});
var expandable=document.querySelectorAll(".orm-ff-NavigationSubnav-toggleControls a, .orm-ff-NavigationView-toggleControls a");expandable.forEach(function(a){a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.parentNode.parentNode.parentNode.querySelectorAll(".orm-Button-btnContentWrap span")[0].childNodes[1].textContent+" | "+a.textContent})})});var flyoutLinks=document.querySelectorAll(".flyout a");
flyoutLinks.forEach(function(a){a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.closest("li.flyout-parent").getElementsByTagName("a")[0].textContent+" | "+a.textContent})})});</script><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./7. Strong Authentication - Securing the Perimeter_ Deploying Identity and Access Management with Free Open Source Software_files/widget_iframe.d0f13be8321eb432fba28cfc1c3351b1.html" title="Twitter settings iframe" style="display: none;"></iframe><div id="eJOY__extension_root" style="all: unset;"></div></body><div class="XTranslate"></div></html>